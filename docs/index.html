<!DOCTYPE html>

<html lang="en">
<head><script>window.STATIC_VPC_DATA = {"nodes": [{"id": "hub-hub-7e97069b", "label": "Cloud Routing Hub (NAT Flows)", "type": "hub", "region": "global", "scenario": "12. Kubernetes Hybrid Network", "routes": [{"destination": "0.0.0.0/0", "next_hop": "vpc-2cb021a8", "next_hop_type": "nat_gateway"}, {"destination": "10.1.0.0/16", "next_hop": "vpc-9b91088f", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.2.0.0/16", "next_hop": "vpc-bb79475f", "next_hop_type": "cloud_routing_hub"}, {"destination": "100.64.0.0/16", "next_hop": "vpc-9b91088f", "next_hop_type": "cloud_routing_hub"}, {"destination": "100.65.0.0/16", "next_hop": "vpc-bb79475f", "next_hop_type": "cloud_routing_hub"}]}, {"id": "hub-hub-47f511ae", "label": "Cloud Routing Hub (Non-NAT Flows)", "type": "hub", "region": "global", "scenario": "12. Kubernetes Hybrid Network", "routes": [{"destination": "10.1.0.0/16", "next_hop": "vpc-9b91088f", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.2.0.0/16", "next_hop": "vpc-bb79475f", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.100.0.0/24", "next_hop": "vpc-2cb021a8", "next_hop_type": "cloud_routing_hub"}, {"destination": "100.64.0.0/16", "next_hop": "vpc-9b91088f", "next_hop_type": "cloud_routing_hub"}, {"destination": "100.65.0.0/16", "next_hop": "vpc-bb79475f", "next_hop_type": "cloud_routing_hub"}]}, {"id": "hub-hub-52545c7e", "label": "Enterprise Policy Hub", "type": "hub", "region": "global", "scenario": "17. Enterprise Hub-and-Spoke", "routes": [{"destination": "10.240.0.0/12", "next_hop": "vpc-064d934b", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.240.0.0/12", "next_hop": "vpc-1836b9f4", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.240.0.0/12", "next_hop": "vpc-61572828", "next_hop_type": "cloud_routing_hub"}, {"destination": "10.240.0.0/12", "next_hop": "vpc-c498e154", "next_hop_type": "cloud_routing_hub"}]}, {"id": "hub-hub-ba803b25", "label": "Transit Backbone Hub", "type": "hub", "region": "global", "scenario": "18. Virtual Appliance Routing", "routes": []}, {"id": "hub-hub-840705c9", "label": "Central Hybrid Hub", "type": "hub", "region": "global", "scenario": "19. Hub Gateway Transit", "routes": [{"destination": "192.168.10.0/24", "next_hop": "dc-502aec89", "next_hop_type": "vpn_gateway"}, {"destination": "10.201.0.0/16", "next_hop": "vpc-f30e89ce", "next_hop_type": "cloud_routing_hub"}]}, {"id": "hub-hub-279ede7f", "label": "Service Mesh Hub", "type": "hub", "region": "global", "scenario": "23. Cloud-Native Service Hub", "routes": [{"destination": "svc.vpc-2bac8a5d.local", "next_hop": "vpc-2bac8a5d", "next_hop_type": "service_mesh"}, {"destination": "svc.vpc-260b8348.local", "next_hop": "vpc-260b8348", "next_hop_type": "service_mesh"}, {"destination": "svc.vpc-d4cb48dd.local", "next_hop": "vpc-d4cb48dd", "next_hop_type": "service_mesh"}]}, {"id": "hub-hub-335a2e47", "label": "Regional Hub A", "type": "hub", "region": "us-east", "scenario": "26. Global Transit: Multi-Region Hubs with GRE Support", "routes": [{"destination": "10.170.0.0/16", "next_hop": "vpc-46b384a2", "next_hop_type": "cloud_routing_hub"}, {"destination": "0.0.0.0/0", "next_hop": "hub-1b9ee5a8", "next_hop_type": "hub_peer"}]}, {"id": "hub-hub-1b9ee5a8", "label": "Regional Hub B", "type": "hub", "region": "us-west", "scenario": "26. Global Transit: Multi-Region Hubs with GRE Support", "routes": [{"destination": "10.170.0.0/16", "next_hop": "vpc-46b384a2", "next_hop_type": "cloud_routing_hub"}]}, {"id": "leaf-1", "label": "Site Switch (CDC-1)", "type": "leaf"}, {"id": "leaf-2", "label": "Site Switch (CDC-2)", "type": "leaf"}, {"id": "leaf-3", "label": "Site Switch (CDC-3)", "type": "leaf"}, {"id": "leaf-11", "label": "Site Switch (CDC-11)", "type": "leaf"}, {"id": "leaf-12", "label": "Site Switch (CDC-12)", "type": "leaf"}, {"id": "leaf-13", "label": "Site Switch (CDC-13)", "type": "leaf"}, {"id": "leaf-1", "label": "Site Switch (ODC-1)", "type": "leaf"}, {"id": "leaf-north", "label": "Site Switch (DC-NORTH)", "type": "leaf"}, {"id": "leaf-south", "label": "Site Switch (DC-SOUTH)", "type": "leaf"}, {"id": "vpc-vpc-2a46f066", "label": "Web VPC", "type": "vpc", "cidr": "10.0.0.0/16", "scenario": "1. Single VPC"}, {"id": "vpc-vpc-2a46f066-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-2a46f066"}, {"id": "subnet-subnet-9e3e5042", "label": "Public Subnet (10.0.1.0/24)", "type": "subnet", "cidr": "10.0.1.0/24", "parent": "vpc-vpc-2a46f066-dc-CDC-1"}, {"id": "igw-igw-1418cf18", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-2a46f066"}, {"id": "vpc-vpc-1fbfdf7d", "label": "Production VPC", "type": "vpc", "cidr": "10.10.0.0/16", "scenario": "2. Multi-tier VPC"}, {"id": "vpc-vpc-1fbfdf7d-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-1fbfdf7d"}, {"id": "subnet-subnet-cf47da7f", "label": "Public Subnet (10.10.1.0/24)", "type": "subnet", "cidr": "10.10.1.0/24", "parent": "vpc-vpc-1fbfdf7d-dc-CDC-1"}, {"id": "subnet-subnet-a781c7e1", "label": "Private Subnet (10.10.2.0/24)", "type": "subnet", "cidr": "10.10.2.0/24", "parent": "vpc-vpc-1fbfdf7d-dc-CDC-1"}, {"id": "subnet-subnet-6f0d4908", "label": "Web Server (10.10.1.10)", "type": "server", "cidr": "10.10.1.10", "parent": "vpc-vpc-1fbfdf7d-dc-CDC-1"}, {"id": "subnet-subnet-1cd862dc", "label": "Database Server (10.10.2.50)", "type": "server", "cidr": "10.10.2.50", "parent": "vpc-vpc-1fbfdf7d-dc-CDC-1"}, {"id": "igw-igw-ee3f4537", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-1fbfdf7d"}, {"id": "vpc-vpc-3a5caeeb", "label": "Production Environment", "type": "vpc", "cidr": "10.20.0.0/16", "scenario": "3. Secure Database Tier"}, {"id": "vpc-vpc-3a5caeeb-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-3a5caeeb"}, {"id": "subnet-subnet-ca4f53c4", "label": "Web DMZ (10.20.1.0/24)", "type": "subnet", "cidr": "10.20.1.0/24", "parent": "vpc-vpc-3a5caeeb-dc-CDC-1"}, {"id": "subnet-subnet-51a315be", "label": "Web Server (10.20.1.10)", "type": "server", "cidr": "10.20.1.10", "parent": "vpc-vpc-3a5caeeb-dc-CDC-1"}, {"id": "subnet-subnet-0ba7af63", "label": "Secure DB Tier (10.20.2.0/24)", "type": "subnet", "cidr": "10.20.2.0/24", "parent": "vpc-vpc-3a5caeeb-dc-CDC-1"}, {"id": "subnet-subnet-20a18c39", "label": "Database Server (10.20.2.50)", "type": "server", "cidr": "10.20.2.50", "parent": "vpc-vpc-3a5caeeb-dc-CDC-1"}, {"id": "igw-igw-eed72722", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-3a5caeeb"}, {"id": "vpc-vpc-29a53757", "label": "Application Service", "type": "vpc", "cidr": "10.30.0.0/16", "scenario": "4. Public Load Balancer & Private Backend"}, {"id": "vpc-vpc-29a53757-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-29a53757"}, {"id": "subnet-subnet-9065711c", "label": "Frontend Entry (10.30.1.0/24)", "type": "subnet", "cidr": "10.30.1.0/24", "parent": "vpc-vpc-29a53757-dc-CDC-1"}, {"id": "subnet-subnet-812b59eb", "label": "Load Balancer Server (10.30.1.5)", "type": "server", "cidr": "10.30.1.5", "parent": "vpc-vpc-29a53757-dc-CDC-1"}, {"id": "subnet-subnet-b743f2b5", "label": "Backend Pool (10.30.2.0/24)", "type": "subnet", "cidr": "10.30.2.0/24", "parent": "vpc-vpc-29a53757-dc-CDC-1"}, {"id": "subnet-subnet-0a838e36", "label": "App Server 1 (10.30.2.11)", "type": "server", "cidr": "10.30.2.11", "parent": "vpc-vpc-29a53757-dc-CDC-1"}, {"id": "subnet-subnet-af34e3e0", "label": "App Server 2 (10.30.2.12)", "type": "server", "cidr": "10.30.2.12", "parent": "vpc-vpc-29a53757-dc-CDC-1"}, {"id": "igw-igw-373a1f0c", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-29a53757"}, {"id": "vpc-vpc-0cabeae4", "label": "Egress Gateway VPC", "type": "vpc", "cidr": "10.40.0.0/16", "scenario": "5. NAT Router for Private Subnets"}, {"id": "vpc-vpc-0cabeae4-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-0cabeae4"}, {"id": "subnet-subnet-edabe4ec", "label": "Public Gateway (10.40.1.0/24)", "type": "subnet", "cidr": "10.40.1.0/24", "parent": "vpc-vpc-0cabeae4-dc-CDC-1"}, {"id": "subnet-subnet-62792f9d", "label": "NAT Router Server (10.40.1.100)", "type": "server", "cidr": "10.40.1.100", "parent": "vpc-vpc-0cabeae4-dc-CDC-1"}, {"id": "subnet-subnet-4bbfd0fc", "label": "Isolated Compute (10.40.2.0/24)", "type": "subnet", "cidr": "10.40.2.0/24", "parent": "vpc-vpc-0cabeae4-dc-CDC-1"}, {"id": "subnet-subnet-144f799a", "label": "Worker Node Server (10.40.2.10)", "type": "server", "cidr": "10.40.2.10", "parent": "vpc-vpc-0cabeae4-dc-CDC-1"}, {"id": "igw-igw-bbd48d5d", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-0cabeae4"}, {"id": "vpc-vpc-4158c420", "label": "Platform VPC", "type": "vpc", "cidr": "10.50.0.0/16", "scenario": "6. Secure Microservices Mesh"}, {"id": "vpc-vpc-4158c420-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-4158c420"}, {"id": "subnet-subnet-30cd48df", "label": "Identity Service (10.50.1.0/24)", "type": "subnet", "cidr": "10.50.1.0/24", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "subnet-subnet-99c71f0d", "label": "Identity Server (10.50.1.5)", "type": "server", "cidr": "10.50.1.5", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "subnet-subnet-a20238df", "label": "Catalog Service (10.50.2.0/24)", "type": "subnet", "cidr": "10.50.2.0/24", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "subnet-subnet-cd1ec552", "label": "Catalog Server (10.50.2.10)", "type": "server", "cidr": "10.50.2.10", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "subnet-subnet-06138028", "label": "Order Service (10.50.3.0/24)", "type": "subnet", "cidr": "10.50.3.0/24", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "subnet-subnet-c3c757c5", "label": "Order Server (10.50.3.15)", "type": "server", "cidr": "10.50.3.15", "parent": "vpc-vpc-4158c420-dc-CDC-1"}, {"id": "vpc-vpc-d07adf88", "label": "us-west-vpc", "type": "vpc", "cidr": "172.16.2.0/24", "scenario": "7. Managed VPN"}, {"id": "vpc-vpc-d07adf88-dc-CDC-11", "label": "Cloud Data Center: CDC-11", "type": "dc", "parent": "vpc-vpc-d07adf88"}, {"id": "subnet-subnet-0bb44dc5", "label": "Primary (172.16.2.0/24)", "type": "subnet", "cidr": "172.16.2.0/24", "parent": "vpc-vpc-d07adf88-dc-CDC-11"}, {"id": "vpn-gateway-vpn-159db727", "label": "VPN Gateway\n192.0.2.1:51820", "type": "vpn_gateway", "parent": "vpc-vpc-d07adf88"}, {"id": "vpc-vpc-b5793cf8", "label": "us-east-vpc", "type": "vpc", "cidr": "172.16.1.0/24", "scenario": "7. Managed VPN"}, {"id": "vpc-vpc-b5793cf8-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-b5793cf8"}, {"id": "subnet-subnet-a6e0b24b", "label": "Primary (172.16.1.0/24)", "type": "subnet", "cidr": "172.16.1.0/24", "parent": "vpc-vpc-b5793cf8-dc-CDC-1"}, {"id": "vpn-gateway-vpn-bde85e22", "label": "VPN Gateway\n192.0.2.2:51820", "type": "vpn_gateway", "parent": "vpc-vpc-b5793cf8"}, {"id": "vpc-vpc-573aa9a6", "label": "Mesh Node West", "type": "vpc", "cidr": "192.168.200.0/24", "scenario": "8. Private Mesh Overlay"}, {"id": "vpc-vpc-573aa9a6-dc-CDC-11", "label": "Cloud Data Center: CDC-11", "type": "dc", "parent": "vpc-vpc-573aa9a6"}, {"id": "subnet-subnet-a11c3ebb", "label": "Main (192.168.200.0/24)", "type": "subnet", "cidr": "192.168.200.0/24", "parent": "vpc-vpc-573aa9a6-dc-CDC-11"}, {"id": "mesh-node-mesh-c4db340c", "label": "Mesh Node\nmkey:wes...", "type": "mesh_node", "parent": "vpc-vpc-573aa9a6"}, {"id": "vpc-vpc-a9c4e8e4", "label": "Mesh Node East", "type": "vpc", "cidr": "192.168.100.0/24", "scenario": "8. Private Mesh Overlay"}, {"id": "vpc-vpc-a9c4e8e4-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-a9c4e8e4"}, {"id": "subnet-subnet-b84f056b", "label": "Main (192.168.100.0/24)", "type": "subnet", "cidr": "192.168.100.0/24", "parent": "vpc-vpc-a9c4e8e4-dc-CDC-1"}, {"id": "mesh-node-mesh-1f016a32", "label": "Mesh Node\nmkey:eas...", "type": "mesh_node", "parent": "vpc-vpc-a9c4e8e4"}, {"id": "vpc-vpc-8a3e0476", "label": "Frontend VPC", "type": "vpc", "cidr": "10.50.0.0/16", "scenario": "9. VPC Peering"}, {"id": "vpc-vpc-8a3e0476-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-8a3e0476"}, {"id": "subnet-subnet-a4b83f57", "label": "Web Subnet (10.50.1.0/24)", "type": "subnet", "cidr": "10.50.1.0/24", "parent": "vpc-vpc-8a3e0476-dc-CDC-1"}, {"id": "subnet-subnet-eae1cee3", "label": "Web Server (10.50.1.10)", "type": "server", "cidr": "10.50.1.10", "parent": "vpc-vpc-8a3e0476-dc-CDC-1"}, {"id": "vpc-vpc-ab85e053", "label": "Backend VPC", "type": "vpc", "cidr": "10.51.0.0/16", "scenario": "9. VPC Peering"}, {"id": "vpc-vpc-ab85e053-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-ab85e053"}, {"id": "subnet-subnet-7c31dfd2", "label": "App Subnet (10.51.1.0/24)", "type": "subnet", "cidr": "10.51.1.0/24", "parent": "vpc-vpc-ab85e053-dc-CDC-1"}, {"id": "subnet-subnet-d7283dbc", "label": "App Server (10.51.1.20)", "type": "server", "cidr": "10.51.1.20", "parent": "vpc-vpc-ab85e053-dc-CDC-1"}, {"id": "vpc-vpc-697f367b", "label": "Consumer VPC", "type": "vpc", "cidr": "10.60.0.0/16", "scenario": "10. Private Service Connectivity"}, {"id": "vpc-vpc-697f367b-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-697f367b"}, {"id": "subnet-subnet-18cff4c1", "label": "App Subnet (10.60.1.0/24)", "type": "subnet", "cidr": "10.60.1.0/24", "parent": "vpc-vpc-697f367b-dc-CDC-1"}, {"id": "subnet-subnet-b319442a", "label": "App Client (10.60.1.10/32)", "type": "subnet", "cidr": "10.60.1.10/32", "parent": "vpc-vpc-697f367b-dc-CDC-1"}, {"id": "vpc-vpc-b59f51ba", "label": "Provider VPC", "type": "vpc", "cidr": "10.70.0.0/16", "scenario": "10. Private Service Connectivity"}, {"id": "vpc-vpc-b59f51ba-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-b59f51ba"}, {"id": "subnet-subnet-eb20d7d6", "label": "Service Subnet (10.70.1.0/24)", "type": "subnet", "cidr": "10.70.1.0/24", "parent": "vpc-vpc-b59f51ba-dc-CDC-1"}, {"id": "subnet-subnet-2acc8437", "label": "Service Backend (10.70.1.50/32)", "type": "subnet", "cidr": "10.70.1.50/32", "parent": "vpc-vpc-b59f51ba-dc-CDC-1"}, {"id": "vpc-vpc-51bd6139", "label": "Shared Network VPC", "type": "vpc", "cidr": "11.80.0.0/16", "scenario": "11. Collaborative Shared Network"}, {"id": "vpc-vpc-51bd6139-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-51bd6139"}, {"id": "subnet-subnet-a2b20ca4", "label": "Human Resources Subnet (11.80.1.0/24)", "type": "subnet", "cidr": "11.80.1.0/24", "parent": "vpc-vpc-51bd6139-dc-CDC-1"}, {"id": "subnet-subnet-2ed313d5", "label": "HR Server (11.80.1.10)", "type": "server", "cidr": "11.80.1.10", "parent": "vpc-vpc-51bd6139-dc-CDC-1"}, {"id": "vpc-vpc-51bd6139-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-51bd6139"}, {"id": "subnet-subnet-2f5aac2f", "label": "Finance Department Subnet (11.80.2.0/24)", "type": "subnet", "cidr": "11.80.2.0/24", "parent": "vpc-vpc-51bd6139-dc-CDC-2"}, {"id": "subnet-subnet-b0a11220", "label": "Finance Server (11.80.2.20)", "type": "server", "cidr": "11.80.2.20", "parent": "vpc-vpc-51bd6139-dc-CDC-2"}, {"id": "subnet-subnet-d5559951", "label": "Central IT Admin Subnet (11.80.3.0/24)", "type": "subnet", "cidr": "11.80.3.0/24", "parent": "vpc-vpc-51bd6139-dc-CDC-1"}, {"id": "subnet-subnet-a5e8e8b6", "label": "IT Controller (11.80.3.5/32)", "type": "subnet", "cidr": "11.80.3.5/32", "parent": "vpc-vpc-51bd6139-dc-CDC-1"}, {"id": "vpc-vpc-9b91088f", "label": "Kubernetes Cluster 1", "type": "vpc", "cidr": "10.1.0.0/16 & 100.64.0.0/16", "scenario": "12. Kubernetes Hybrid Network"}, {"id": "vpc-vpc-9b91088f-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-9b91088f"}, {"id": "subnet-subnet-1c0812b7", "label": "Public Subnet (10.1.1.0/24)", "type": "subnet", "cidr": "10.1.1.0/24", "parent": "vpc-vpc-9b91088f-dc-CDC-1"}, {"id": "subnet-subnet-8e66a150", "label": "Private Subnet (10.1.3.0/24)", "type": "subnet", "cidr": "10.1.3.0/24", "parent": "vpc-vpc-9b91088f-dc-CDC-1"}, {"id": "subnet-subnet-b8ec8254", "label": "CGNAT Subnet (100.64.0.0/19)", "type": "subnet", "cidr": "100.64.0.0/19", "parent": "vpc-vpc-9b91088f-dc-CDC-1"}, {"id": "vpc-vpc-9b91088f-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-9b91088f"}, {"id": "subnet-subnet-d7352c78", "label": "Public Subnet (10.1.2.0/24)", "type": "subnet", "cidr": "10.1.2.0/24", "parent": "vpc-vpc-9b91088f-dc-CDC-2"}, {"id": "subnet-subnet-c6e8671d", "label": "Private Subnet (10.1.4.0/24)", "type": "subnet", "cidr": "10.1.4.0/24", "parent": "vpc-vpc-9b91088f-dc-CDC-2"}, {"id": "subnet-subnet-84eb842a", "label": "CGNAT Subnet (100.64.32.0/19)", "type": "subnet", "cidr": "100.64.32.0/19", "parent": "vpc-vpc-9b91088f-dc-CDC-2"}, {"id": "vpc-vpc-bb79475f", "label": "Kubernetes Cluster 2", "type": "vpc", "cidr": "10.2.0.0/16 & 100.65.0.0/16", "scenario": "12. Kubernetes Hybrid Network"}, {"id": "vpc-vpc-bb79475f-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-bb79475f"}, {"id": "subnet-subnet-cbac8335", "label": "Public Subnet (10.2.1.0/24)", "type": "subnet", "cidr": "10.2.1.0/24", "parent": "vpc-vpc-bb79475f-dc-CDC-1"}, {"id": "subnet-subnet-888bb9e8", "label": "Private Subnet (10.2.3.0/24)", "type": "subnet", "cidr": "10.2.3.0/24", "parent": "vpc-vpc-bb79475f-dc-CDC-1"}, {"id": "subnet-subnet-d4c0e4a6", "label": "CGNAT Subnet (100.65.0.0/19)", "type": "subnet", "cidr": "100.65.0.0/19", "parent": "vpc-vpc-bb79475f-dc-CDC-1"}, {"id": "vpc-vpc-bb79475f-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-bb79475f"}, {"id": "subnet-subnet-17287506", "label": "Public Subnet (10.2.2.0/24)", "type": "subnet", "cidr": "10.2.2.0/24", "parent": "vpc-vpc-bb79475f-dc-CDC-2"}, {"id": "subnet-subnet-1459a5ca", "label": "Private Subnet (10.2.4.0/24)", "type": "subnet", "cidr": "10.2.4.0/24", "parent": "vpc-vpc-bb79475f-dc-CDC-2"}, {"id": "subnet-subnet-d61c3e3b", "label": "CGNAT Subnet (100.65.32.0/19)", "type": "subnet", "cidr": "100.65.32.0/19", "parent": "vpc-vpc-bb79475f-dc-CDC-2"}, {"id": "vpc-vpc-2cb021a8", "label": "Shared Services", "type": "vpc", "cidr": "10.100.0.0/24", "scenario": "12. Kubernetes Hybrid Network"}, {"id": "vpc-vpc-2cb021a8-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-2cb021a8"}, {"id": "subnet-subnet-a45e3c4b", "label": "Public Subnet (10.100.0.64/27)", "type": "subnet", "cidr": "10.100.0.64/27", "parent": "vpc-vpc-2cb021a8-dc-CDC-1"}, {"id": "subnet-subnet-ad552c0c", "label": "NGW-DC Subnet (10.100.0.32/27)", "type": "subnet", "cidr": "10.100.0.32/27", "parent": "vpc-vpc-2cb021a8-dc-CDC-1"}, {"id": "subnet-subnet-1fd4017d", "label": "Private Subnet (10.100.0.128/26)", "type": "subnet", "cidr": "10.100.0.128/26", "parent": "vpc-vpc-2cb021a8-dc-CDC-1"}, {"id": "vpc-vpc-2cb021a8-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-2cb021a8"}, {"id": "subnet-subnet-7d7cc298", "label": "Public Subnet (10.100.0.96/27)", "type": "subnet", "cidr": "10.100.0.96/27", "parent": "vpc-vpc-2cb021a8-dc-CDC-2"}, {"id": "subnet-subnet-6bf1c27e", "label": "NGW-DC Subnet (10.100.0.0/27)", "type": "subnet", "cidr": "10.100.0.0/27", "parent": "vpc-vpc-2cb021a8-dc-CDC-2"}, {"id": "subnet-subnet-2617f9fb", "label": "Private Subnet (10.100.0.192/26)", "type": "subnet", "cidr": "10.100.0.192/26", "parent": "vpc-vpc-2cb021a8-dc-CDC-2"}, {"id": "vpc-vpc-9ef51fdf", "label": "Frontend Mesh VPC", "type": "vpc", "cidr": "10.110.0.0/16", "scenario": "13. Secure Application Service Mesh"}, {"id": "vpc-vpc-9ef51fdf-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-9ef51fdf"}, {"id": "subnet-subnet-531dad09", "label": "Mesh Ingress (10.110.1.0/24)", "type": "subnet", "cidr": "10.110.1.0/24", "parent": "vpc-vpc-9ef51fdf-dc-CDC-1"}, {"id": "vpc-vpc-90acd9f1", "label": "Backend Mesh VPC", "type": "vpc", "cidr": "10.120.0.0/16", "scenario": "13. Secure Application Service Mesh"}, {"id": "vpc-vpc-90acd9f1-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-90acd9f1"}, {"id": "subnet-subnet-efa574b8", "label": "Service Tier (10.120.1.0/24)", "type": "subnet", "cidr": "10.120.1.0/24", "parent": "vpc-vpc-90acd9f1-dc-CDC-1"}, {"id": "vpc-vpc-2514fd65", "label": "Data Mesh VPC", "type": "vpc", "cidr": "10.130.0.0/16", "scenario": "13. Secure Application Service Mesh"}, {"id": "vpc-vpc-2514fd65-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-2514fd65"}, {"id": "subnet-subnet-6a8a1b0c", "label": "Storage Tier (10.130.1.0/24)", "type": "subnet", "cidr": "10.130.1.0/24", "parent": "vpc-vpc-2514fd65-dc-CDC-1"}, {"id": "vpc-vpc-bc723cf8", "label": "Automated Regional VPC", "type": "vpc", "cidr": "10.128.0.0/9", "scenario": "14. Network Lifecycle: Automated vs Manual"}, {"id": "vpc-vpc-bc723cf8-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-bc723cf8"}, {"id": "subnet-subnet-dcfb5670", "label": "Auto Subnet us-east1 (10.128.0.0/20)", "type": "subnet", "cidr": "10.128.0.0/20", "parent": "vpc-vpc-bc723cf8-dc-CDC-1"}, {"id": "vpc-vpc-bc723cf8-dc-CDC-11", "label": "Cloud Data Center: CDC-11", "type": "dc", "parent": "vpc-vpc-bc723cf8"}, {"id": "subnet-subnet-8dc1e21c", "label": "Auto Subnet us-west1 (10.136.0.0/20)", "type": "subnet", "cidr": "10.136.0.0/20", "parent": "vpc-vpc-bc723cf8-dc-CDC-11"}, {"id": "vpc-vpc-bc723cf8-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-bc723cf8"}, {"id": "subnet-subnet-8f3058ea", "label": "Auto Subnet europe-west1 (10.144.0.0/20)", "type": "subnet", "cidr": "10.144.0.0/20", "parent": "vpc-vpc-bc723cf8-dc-CDC-2"}, {"id": "vpc-vpc-a7fbc296", "label": "Manual Controlled VPC", "type": "vpc", "cidr": "10.13.0.0/16", "scenario": "14. Network Lifecycle: Automated vs Manual"}, {"id": "vpc-vpc-a7fbc296-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-a7fbc296"}, {"id": "subnet-subnet-0c9fe895", "label": "Manual Subnet A (10.13.1.0/24)", "type": "subnet", "cidr": "10.13.1.0/24", "parent": "vpc-vpc-a7fbc296-dc-CDC-1"}, {"id": "subnet-subnet-c3b6dd88", "label": "Manual Subnet B (10.13.2.0/24)", "type": "subnet", "cidr": "10.13.2.0/24", "parent": "vpc-vpc-a7fbc296-dc-CDC-1"}, {"id": "vpc-vpc-a2d18b69", "label": "Restricted VPC", "type": "vpc", "cidr": "10.140.0.0/16", "scenario": "15. Policy Enforcement"}, {"id": "vpc-vpc-a2d18b69-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-a2d18b69"}, {"id": "subnet-subnet-cc730528", "label": "Compliant Subnet (10.140.1.0/24)", "type": "subnet", "cidr": "10.140.1.0/24", "parent": "vpc-vpc-a2d18b69-dc-CDC-1"}, {"id": "subnet-subnet-4095e055", "label": "Policy: No External IPv6 (10.140.2.0/24)", "type": "subnet", "cidr": "10.140.2.0/24", "parent": "vpc-vpc-a2d18b69-dc-CDC-1"}, {"id": "vpc-vpc-31c0c665", "label": "Corporate Hub VPC", "type": "vpc", "cidr": "10.150.0.0/16", "scenario": "16. Hybrid Connectivity: Dedicated & Redundant VPN"}, {"id": "vpc-vpc-31c0c665-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-31c0c665"}, {"id": "subnet-subnet-b2b3ab00", "label": "Hybrid Gateway (10.150.1.0/24)", "type": "subnet", "cidr": "10.150.1.0/24", "parent": "vpc-vpc-31c0c665-dc-CDC-1"}, {"id": "vpc-vpc-064d934b", "label": "Engineering Spoke", "type": "vpc", "cidr": "10.240.0.0/16", "scenario": "17. Enterprise Hub-and-Spoke"}, {"id": "vpc-vpc-064d934b-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-064d934b"}, {"id": "subnet-subnet-0c35531b", "label": "Dev Cluster (10.240.1.0/24)", "type": "subnet", "cidr": "10.240.1.0/24", "parent": "vpc-vpc-064d934b-dc-CDC-1"}, {"id": "vpc-vpc-1836b9f4", "label": "Finance Spoke", "type": "vpc", "cidr": "10.255.0.0/16", "scenario": "17. Enterprise Hub-and-Spoke"}, {"id": "vpc-vpc-1836b9f4-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-1836b9f4"}, {"id": "subnet-subnet-3d2766f0", "label": "Billing App (10.250.1.0/24)", "type": "subnet", "cidr": "10.250.1.0/24", "parent": "vpc-vpc-1836b9f4-dc-CDC-1"}, {"id": "vpc-vpc-61572828", "label": "HR Spoke", "type": "vpc", "cidr": "10.251.0.0/16", "scenario": "17. Enterprise Hub-and-Spoke"}, {"id": "vpc-vpc-61572828-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-61572828"}, {"id": "subnet-subnet-a61093e3", "label": "Employee Portal (10.251.1.0/24)", "type": "subnet", "cidr": "10.251.1.0/24", "parent": "vpc-vpc-61572828-dc-CDC-1"}, {"id": "vpc-vpc-c498e154", "label": "Security Services VPC", "type": "vpc", "cidr": "10.252.0.0/16", "scenario": "17. Enterprise Hub-and-Spoke"}, {"id": "vpc-vpc-c498e154-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-c498e154"}, {"id": "subnet-subnet-05f3aa74", "label": "Security Scanner (10.252.1.0/24)", "type": "subnet", "cidr": "10.252.1.0/24", "parent": "vpc-vpc-c498e154-dc-CDC-1"}, {"id": "vpc-vpc-cc3df9da", "label": "Spoke Application VPC", "type": "vpc", "cidr": "10.181.0.0/16", "scenario": "18. Virtual Appliance Routing"}, {"id": "vpc-vpc-cc3df9da-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-cc3df9da"}, {"id": "subnet-subnet-f817736e", "label": "App Server (10.181.1.10)", "type": "server", "cidr": "10.181.1.10", "parent": "vpc-vpc-cc3df9da-dc-CDC-1"}, {"id": "vpc-vpc-cb9fd2e8", "label": "Transit Security VPC", "type": "vpc", "cidr": "10.191.0.0/16", "scenario": "18. Virtual Appliance Routing"}, {"id": "vpc-vpc-cb9fd2e8-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-cb9fd2e8"}, {"id": "subnet-subnet-1c2b24a2", "label": "Firewall Appliance (10.191.1.100/32)", "type": "subnet", "cidr": "10.191.1.100/32", "parent": "vpc-vpc-cb9fd2e8-dc-CDC-1"}, {"id": "vpc-vpc-f30e89ce", "label": "Remote Spoke VPC", "type": "vpc", "cidr": "10.201.0.0/16", "scenario": "19. Hub Gateway Transit"}, {"id": "vpc-vpc-f30e89ce-dc-CDC-11", "label": "Cloud Data Center: CDC-11", "type": "dc", "parent": "vpc-vpc-f30e89ce"}, {"id": "subnet-subnet-736a504f", "label": "Cloud App Server (10.201.1.10)", "type": "server", "cidr": "10.201.1.10", "parent": "vpc-vpc-f30e89ce-dc-CDC-11"}, {"id": "vpc-vpc-57852d41", "label": "High-Density Cluster VPC", "type": "vpc", "cidr": "10.22.0.0/16 & 100.64.0.0/10", "scenario": "20. Data-Scale Network: Secondary CIDR Expansion & Pre-initialized Instances"}, {"id": "vpc-vpc-57852d41-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-57852d41"}, {"id": "subnet-subnet-6c4be1a0", "label": "Management Subnet (10.22.1.0/24)", "type": "subnet", "cidr": "10.22.1.0/24", "parent": "vpc-vpc-57852d41-dc-CDC-1"}, {"id": "subnet-subnet-0693521c", "label": "Compute Pool 1 (Dense) (100.64.0.0/18)", "type": "subnet", "cidr": "100.64.0.0/18", "parent": "vpc-vpc-57852d41-dc-CDC-1"}, {"id": "vpc-vpc-57852d41-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-57852d41"}, {"id": "subnet-subnet-6abeb9be", "label": "Compute Pool 2 (Dense) (100.64.64.0/18)", "type": "subnet", "cidr": "100.64.64.0/18", "parent": "vpc-vpc-57852d41-dc-CDC-2"}, {"id": "subnet-subnet-66cddd80", "label": "Dense Resource 1 (100.64.1.10/32)", "type": "subnet", "cidr": "100.64.1.10/32", "parent": "vpc-vpc-57852d41-dc-CDC-1"}, {"id": "subnet-subnet-7abe6eee", "label": "Dense Resource 2 (100.64.65.20/32)", "type": "subnet", "cidr": "100.64.65.20/32", "parent": "vpc-vpc-57852d41-dc-CDC-2"}, {"id": "vpc-vpc-cfbb2581", "label": "Producer Service VPC", "type": "vpc", "cidr": "10.221.0.0/16", "scenario": "21. Subnet-Level Peering"}, {"id": "vpc-vpc-cfbb2581-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-cfbb2581"}, {"id": "subnet-subnet-233aa8fc", "label": "Exposed API Subnet (10.221.1.0/24)", "type": "subnet", "cidr": "10.221.1.0/24", "parent": "vpc-vpc-cfbb2581-dc-CDC-1"}, {"id": "subnet-subnet-eed85aec", "label": "Internal Data Subnet (10.221.2.0/24)", "type": "subnet", "cidr": "10.221.2.0/24", "parent": "vpc-vpc-cfbb2581-dc-CDC-1"}, {"id": "vpc-vpc-c758cebb", "label": "Consumer Client VPC", "type": "vpc", "cidr": "10.231.0.0/16", "scenario": "21. Subnet-Level Peering"}, {"id": "vpc-vpc-c758cebb-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-c758cebb"}, {"id": "subnet-subnet-149ab8b0", "label": "Client App Subnet (10.231.1.0/24)", "type": "subnet", "cidr": "10.231.1.0/24", "parent": "vpc-vpc-c758cebb-dc-CDC-1"}, {"id": "vpc-vpc-74a4f24f", "label": "Enterprise Shared VPC", "type": "vpc", "cidr": "10.90.0.0/16", "scenario": "22. Shared Cluster Infrastructure"}, {"id": "vpc-vpc-74a4f24f-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-74a4f24f"}, {"id": "subnet-subnet-2cdb7a8a", "label": "Control Plane (Shared) (10.90.1.0/24)", "type": "subnet", "cidr": "10.90.1.0/24", "parent": "vpc-vpc-74a4f24f-dc-CDC-1"}, {"id": "subnet-subnet-9df2ea75", "label": "Team Alpha Pool (10.90.2.0/24)", "type": "subnet", "cidr": "10.90.2.0/24", "parent": "vpc-vpc-74a4f24f-dc-CDC-1"}, {"id": "vpc-vpc-74a4f24f-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-74a4f24f"}, {"id": "subnet-subnet-9d95367b", "label": "Team Beta Pool (10.90.3.0/24)", "type": "subnet", "cidr": "10.90.3.0/24", "parent": "vpc-vpc-74a4f24f-dc-CDC-2"}, {"id": "subnet-subnet-7b7ddd6d", "label": "Shared LB Tier (10.90.4.0/24)", "type": "subnet", "cidr": "10.90.4.0/24", "parent": "vpc-vpc-74a4f24f-dc-CDC-1"}, {"id": "subnet-subnet-2ea2d599", "label": "Alpha App Server (10.90.2.10)", "type": "server", "cidr": "10.90.2.10", "parent": "vpc-vpc-74a4f24f-dc-CDC-1"}, {"id": "subnet-subnet-bb60dbd1", "label": "Beta App Server (10.90.3.50)", "type": "server", "cidr": "10.90.3.50", "parent": "vpc-vpc-74a4f24f-dc-CDC-2"}, {"id": "vpc-vpc-2bac8a5d", "label": "Checkout VPC", "type": "vpc", "cidr": "10.25.1.0/24", "scenario": "23. Cloud-Native Service Hub"}, {"id": "vpc-vpc-2bac8a5d-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-2bac8a5d"}, {"id": "subnet-subnet-b97e6536", "label": "Checkout Backend (10.25.1.5/32)", "type": "subnet", "cidr": "10.25.1.5/32", "parent": "vpc-vpc-2bac8a5d-dc-CDC-1"}, {"id": "vpc-vpc-260b8348", "label": "Inventory VPC", "type": "vpc", "cidr": "10.25.2.0/24", "scenario": "23. Cloud-Native Service Hub"}, {"id": "vpc-vpc-260b8348-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-260b8348"}, {"id": "subnet-subnet-b010c5d0", "label": "Inventory Backend (10.25.2.10/32)", "type": "subnet", "cidr": "10.25.2.10/32", "parent": "vpc-vpc-260b8348-dc-CDC-1"}, {"id": "vpc-vpc-d4cb48dd", "label": "Client VPC", "type": "vpc", "cidr": "10.26.0.0/16", "scenario": "23. Cloud-Native Service Hub"}, {"id": "vpc-vpc-d4cb48dd-dc-CDC-11", "label": "Cloud Data Center: CDC-11", "type": "dc", "parent": "vpc-vpc-d4cb48dd"}, {"id": "subnet-subnet-3a989a91", "label": "Web App Client (10.26.1.100/32)", "type": "subnet", "cidr": "10.26.1.100/32", "parent": "vpc-vpc-d4cb48dd-dc-CDC-11"}, {"id": "vpc-vpc-b161faa4", "label": "Provider Network (Managed)", "type": "vpc", "cidr": "10.241.0.0/16", "scenario": "24. Hybrid Appliance Bridge"}, {"id": "vpc-vpc-b161faa4-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-b161faa4"}, {"id": "subnet-subnet-05125d6f", "label": "Cloud Services (10.241.1.0/24)", "type": "subnet", "cidr": "10.241.1.0/24", "parent": "vpc-vpc-b161faa4-dc-CDC-1"}, {"id": "vpc-vpc-a06466b9", "label": "Consumer Network (Software Appliance)", "type": "vpc", "cidr": "10.242.0.0/16", "scenario": "24. Hybrid Appliance Bridge"}, {"id": "vpc-vpc-a06466b9-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-a06466b9"}, {"id": "subnet-subnet-bd07154b", "label": "Appliance Subnet (10.242.1.0/24)", "type": "subnet", "cidr": "10.242.1.0/24", "parent": "vpc-vpc-a06466b9-dc-CDC-1"}, {"id": "subnet-subnet-331d64d6", "label": "Software Gateway Server (10.242.1.10)", "type": "server", "cidr": "10.242.1.10", "parent": "vpc-vpc-a06466b9-dc-CDC-1"}, {"id": "vpc-vpc-85bbfb87", "label": "AI Training VPC", "type": "vpc", "cidr": "10.160.0.0/16", "scenario": "25. AI Infrastructure: Accelerated RDMA Network"}, {"id": "vpc-vpc-85bbfb87-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-85bbfb87"}, {"id": "subnet-subnet-0e4560eb", "label": "GPU Cluster Subnet (RDMA) (10.160.1.0/24)", "type": "subnet", "cidr": "10.160.1.0/24", "parent": "vpc-vpc-85bbfb87-dc-CDC-1"}, {"id": "subnet-subnet-74e0ea6a", "label": "Accelerator Node 1 (10.160.1.10/32)", "type": "subnet", "cidr": "10.160.1.10/32", "parent": "vpc-vpc-85bbfb87-dc-CDC-1"}, {"id": "subnet-subnet-46cdbbbd", "label": "Accelerator Node 2 (10.160.1.11/32)", "type": "subnet", "cidr": "10.160.1.11/32", "parent": "vpc-vpc-85bbfb87-dc-CDC-1"}, {"id": "subnet-subnet-141d5aca", "label": "Parameter Server (10.160.1.100)", "type": "server", "cidr": "10.160.1.100", "parent": "vpc-vpc-85bbfb87-dc-CDC-1"}, {"id": "vpc-vpc-46b384a2", "label": "Security Appliance VPC", "type": "vpc", "cidr": "10.170.0.0/16", "scenario": "26. Global Transit: Multi-Region Hubs with GRE Support"}, {"id": "vpc-vpc-46b384a2-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-46b384a2"}, {"id": "subnet-subnet-32e72c8b", "label": "GRE Termination (10.170.1.0/24)", "type": "subnet", "cidr": "10.170.1.0/24", "parent": "vpc-vpc-46b384a2-dc-CDC-1"}, {"id": "vpc-vpc-9728991d", "label": "Dual-Stack VPC", "type": "vpc", "cidr": "10.180.0.0/16 & 2001:db8::1/64", "scenario": "27. Dual-Stack Infrastructure: IPv4 & IPv6 Coexistence"}, {"id": "vpc-vpc-9728991d-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-9728991d"}, {"id": "subnet-subnet-d543aada", "label": "Dual-Stack Subnet (10.180.1.0/24)", "type": "subnet", "cidr": "10.180.1.0/24", "parent": "vpc-vpc-9728991d-dc-CDC-1"}, {"id": "subnet-subnet-1e61b253", "label": "IPv6 Resource (2001:db8:1::10/128)", "type": "subnet", "cidr": "2001:db8:1::10/128", "parent": "vpc-vpc-9728991d-dc-CDC-1"}, {"id": "vpc-vpc-815cb68c", "label": "NAT Router VPC", "type": "vpc", "cidr": "10.49.96.0/20", "scenario": "28. Cloud Native NAT Router"}, {"id": "vpc-vpc-815cb68c-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-815cb68c"}, {"id": "subnet-subnet-0907973f", "label": "Host 1 (NAT Router/DNS) (10.49.96.3/32)", "type": "subnet", "cidr": "10.49.96.3/32", "parent": "vpc-vpc-815cb68c-dc-CDC-1"}, {"id": "subnet-subnet-2db44b67", "label": "Host 2 (FTP Server) (10.49.96.4)", "type": "server", "cidr": "10.49.96.4", "parent": "vpc-vpc-815cb68c-dc-CDC-1"}, {"id": "subnet-subnet-3a3aa0f4", "label": "Host 3 (Web Server) (10.49.96.5)", "type": "server", "cidr": "10.49.96.5", "parent": "vpc-vpc-815cb68c-dc-CDC-1"}, {"id": "subnet-subnet-9b8de68b", "label": "Host 4 (Windows Server) (10.49.96.6)", "type": "server", "cidr": "10.49.96.6", "parent": "vpc-vpc-815cb68c-dc-CDC-1"}, {"id": "vpc-vpc-fcbf3c3a", "label": "Load Balanced VPC", "type": "vpc", "cidr": "10.49.144.0/20", "scenario": "29. Heterogeneous Load Balancing"}, {"id": "vpc-vpc-fcbf3c3a-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-fcbf3c3a"}, {"id": "subnet-subnet-de43fb65", "label": "Load Balancer (10.49.144.3/32)", "type": "subnet", "cidr": "10.49.144.3/32", "parent": "vpc-vpc-fcbf3c3a-dc-CDC-1"}, {"id": "subnet-subnet-2d035374", "label": "Host 1 (Nginx/Ubuntu) (10.49.144.4/32)", "type": "subnet", "cidr": "10.49.144.4/32", "parent": "vpc-vpc-fcbf3c3a-dc-CDC-1"}, {"id": "vpc-vpc-fcbf3c3a-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-fcbf3c3a"}, {"id": "subnet-subnet-7637ebcf", "label": "Host 2 (Apache/Rocky) (10.49.144.5/32)", "type": "subnet", "cidr": "10.49.144.5/32", "parent": "vpc-vpc-fcbf3c3a-dc-CDC-2"}, {"id": "subnet-subnet-0d0ab5d5", "label": "Host 3 (Nginx/Debian) (10.49.144.6/32)", "type": "subnet", "cidr": "10.49.144.6/32", "parent": "vpc-vpc-fcbf3c3a-dc-CDC-1"}, {"id": "subnet-subnet-9a0ca88e", "label": "Host 4 (Management) (10.49.144.7/32)", "type": "subnet", "cidr": "10.49.144.7/32", "parent": "vpc-vpc-fcbf3c3a-dc-CDC-1"}, {"id": "vpc-vpc-48044aa5", "label": "Cloud VPC", "type": "vpc", "cidr": "203.0.113.0/24", "scenario": "30. Standard IPsec VPN (Site-to-Site)"}, {"id": "vpc-vpc-48044aa5-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-48044aa5"}, {"id": "subnet-subnet-3276e749", "label": "VPC VPN Gateway (203.0.113.2/32)", "type": "subnet", "cidr": "203.0.113.2/32", "parent": "vpc-vpc-48044aa5-dc-CDC-1"}, {"id": "subnet-subnet-c287b118", "label": "App Server (Debian) (203.0.113.3)", "type": "server", "cidr": "203.0.113.3", "parent": "vpc-vpc-48044aa5-dc-CDC-1"}, {"id": "vpc-vpc-73b9fbc5", "label": "Remote Access Hub VPC", "type": "vpc", "cidr": "10.200.0.0/16", "scenario": "31. Remote Access VPN"}, {"id": "vpc-vpc-73b9fbc5-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-73b9fbc5"}, {"id": "subnet-subnet-3daaa233", "label": "VPN Endpoints Pool (192.5.2.0/24)", "type": "subnet", "cidr": "192.5.2.0/24", "parent": "vpc-vpc-73b9fbc5-dc-CDC-1"}, {"id": "subnet-subnet-f69e0f84", "label": "Internal Services (10.200.1.0/24)", "type": "subnet", "cidr": "10.200.1.0/24", "parent": "vpc-vpc-73b9fbc5-dc-CDC-1"}, {"id": "subnet-subnet-cf971813", "label": "Identity Server (10.200.1.5)", "type": "server", "cidr": "10.200.1.5", "parent": "vpc-vpc-73b9fbc5-dc-CDC-1"}, {"id": "vpc-vpc-5bbacca8", "label": "DNS Managed VPC", "type": "vpc", "cidr": "10.49.144.0/24", "scenario": "32. Private DNS Discovery"}, {"id": "vpc-vpc-5bbacca8-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-5bbacca8"}, {"id": "subnet-subnet-27dc31bf", "label": "DNS Server (Bind9) (10.49.144.3)", "type": "server", "cidr": "10.49.144.3", "parent": "vpc-vpc-5bbacca8-dc-CDC-1"}, {"id": "subnet-subnet-308e3fe2", "label": "ftp.example.com (10.49.144.4/32)", "type": "subnet", "cidr": "10.49.144.4/32", "parent": "vpc-vpc-5bbacca8-dc-CDC-1"}, {"id": "subnet-subnet-80ea8061", "label": "web.example.com (10.49.144.5/32)", "type": "subnet", "cidr": "10.49.144.5/32", "parent": "vpc-vpc-5bbacca8-dc-CDC-1"}, {"id": "vpc-vpc-1cc3917a", "label": "Legacy Windows VPC", "type": "vpc", "cidr": "10.49.96.0/24", "scenario": "33. Legacy Windows Integration"}, {"id": "vpc-vpc-1cc3917a-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-1cc3917a"}, {"id": "subnet-subnet-274eb795", "label": "Public Mgmt (10.49.96.0/28)", "type": "subnet", "cidr": "10.49.96.0/28", "parent": "vpc-vpc-1cc3917a-dc-CDC-1"}, {"id": "subnet-subnet-7d6a2222", "label": "Private Data (10.49.96.16/28)", "type": "subnet", "cidr": "10.49.96.16/28", "parent": "vpc-vpc-1cc3917a-dc-CDC-1"}, {"id": "subnet-subnet-5899acf4", "label": "Windows AD DC (10.49.96.4/32)", "type": "subnet", "cidr": "10.49.96.4/32", "parent": "vpc-vpc-1cc3917a-dc-CDC-1"}, {"id": "subnet-subnet-6bb4df64", "label": "Windows SQL (10.49.96.20/32)", "type": "subnet", "cidr": "10.49.96.20/32", "parent": "vpc-vpc-1cc3917a-dc-CDC-1"}, {"id": "igw-igw-fa7fdbf6", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-1cc3917a"}, {"id": "vpc-vpc-139a0f6d", "label": "Brownfield VPC", "type": "vpc", "cidr": "10.1.0.0/16", "scenario": "34. Brownfield Endpoint Adoption"}, {"id": "vpc-vpc-139a0f6d-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-139a0f6d"}, {"id": "subnet-subnet-10a0c193", "label": "Adopted Subnet A (10.1.1.0/24)", "type": "subnet", "cidr": "10.1.1.0/24", "parent": "vpc-vpc-139a0f6d-dc-CDC-1"}, {"id": "subnet-subnet-23287fad", "label": "Adopted Subnet B (10.1.2.0/24)", "type": "subnet", "cidr": "10.1.2.0/24", "parent": "vpc-vpc-139a0f6d-dc-CDC-1"}, {"id": "igw-igw-262b7a22", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-139a0f6d"}, {"id": "vpc-vpc-3853748e", "label": "Partial Brownfield VPC", "type": "vpc", "cidr": "10.2.0.0/16", "scenario": "35. Partial Brownfield Adoption"}, {"id": "vpc-vpc-3853748e-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-3853748e"}, {"id": "subnet-subnet-16e48d00", "label": "Adoptable Subnet (10.2.1.0/24)", "type": "subnet", "cidr": "10.2.1.0/24", "parent": "vpc-vpc-3853748e-dc-CDC-1"}, {"id": "vpc-vpc-3853748e-dc-CDC-2", "label": "Cloud Data Center: CDC-2", "type": "dc", "parent": "vpc-vpc-3853748e"}, {"id": "subnet-subnet-79c375f8", "label": "Conflicting Subnet (10.2.2.0/24)", "type": "subnet", "cidr": "10.2.2.0/24", "parent": "vpc-vpc-3853748e-dc-CDC-2"}, {"id": "igw-igw-66894007", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-3853748e"}, {"id": "vpc-vpc-cbad2f08", "label": "Churn Resilient Brownfield VPC", "type": "vpc", "cidr": "10.2.0.0/16", "scenario": "36. Brownfield Adoption Under Churn"}, {"id": "vpc-vpc-cbad2f08-dc-CDC-1", "label": "Cloud Data Center: CDC-1", "type": "dc", "parent": "vpc-vpc-cbad2f08"}, {"id": "subnet-subnet-adaf1786", "label": "Adopted Subnet A (10.2.2.0/24)", "type": "subnet", "cidr": "10.2.2.0/24", "parent": "vpc-vpc-cbad2f08-dc-CDC-1"}, {"id": "subnet-subnet-a37f8771", "label": "Adopted Subnet B (10.2.3.0/24)", "type": "subnet", "cidr": "10.2.3.0/24", "parent": "vpc-vpc-cbad2f08-dc-CDC-1"}, {"id": "igw-igw-529d02eb", "label": "Internet GW", "type": "igw", "parent": "vpc-vpc-cbad2f08"}, {"id": "standalone-dc-dc-91e97540", "label": "On-Premise Data Center", "type": "standalone_dc", "cidr": "10.250.0.0/16", "region": "on-prem", "scenario": "12. Kubernetes Hybrid Network"}, {"id": "dc-subnet-dc-subnet-9587d963", "label": "Test Server (10.0.1.117)", "type": "server", "cidr": "10.0.1.117", "parent": "standalone-dc-dc-91e97540"}, {"id": "standalone-dc-dc-a400639e", "label": "MegaCorp DC", "type": "standalone_dc", "cidr": "192.168.0.0/16", "region": "on-prem", "scenario": "16. Hybrid Connectivity: Dedicated & Redundant VPN"}, {"id": "dc-subnet-dc-subnet-b485890f", "label": "On-Prem Core (192.168.1.0/24)", "type": "subnet", "cidr": "192.168.1.0/24", "parent": "standalone-dc-dc-a400639e"}, {"id": "standalone-dc-dc-502aec89", "label": "On-Premises Data Center", "type": "standalone_dc", "cidr": "192.168.10.0/24", "region": "on-prem", "scenario": "19. Hub Gateway Transit"}, {"id": "dc-subnet-dc-subnet-7de5266f", "label": "Mainframe Link (192.168.10.50/32)", "type": "subnet", "cidr": "192.168.10.50/32", "parent": "standalone-dc-dc-502aec89"}, {"id": "standalone-dc-dc-f1150cbf", "label": "On-Premises Network", "type": "standalone_dc", "cidr": "192.168.1.0/24", "region": "on-prem", "scenario": "30. Standard IPsec VPN (Site-to-Site)"}, {"id": "dc-subnet-dc-subnet-d343dd6c", "label": "On-Prem VPN Gateway (192.168.1.1/32)", "type": "subnet", "cidr": "192.168.1.1/32", "parent": "standalone-dc-dc-f1150cbf"}, {"id": "dc-subnet-dc-subnet-996fccd9", "label": "Windows Client (192.168.1.2/32)", "type": "subnet", "cidr": "192.168.1.2/32", "parent": "standalone-dc-dc-f1150cbf"}], "edges": [{"source": "leaf-1", "target": "vpc-vpc-2a46f066", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-2a46f066", "target": "igw-1418cf18", "type": "internet", "label": "Internet", "destination": "1.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-1fbfdf7d", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-1fbfdf7d", "target": "igw-ee3f4537", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-3a5caeeb", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-3a5caeeb", "target": "igw-eed72722", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-29a53757", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-29a53757", "target": "igw-373a1f0c", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-0cabeae4", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-0cabeae4", "target": "igw-bbd48d5d", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-4158c420", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-11", "target": "vpc-vpc-d07adf88", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-d07adf88", "target": "vpc-vpc-b5793cf8", "type": "vpn", "label": "VPN Gateway", "destination": "172.16.1.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-b5793cf8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-11", "target": "vpc-vpc-573aa9a6", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-573aa9a6", "target": "vpc-vpc-a9c4e8e4", "type": "mesh", "label": "Mesh VPN", "destination": "192.168.100.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-a9c4e8e4", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-a9c4e8e4", "target": "vpc-vpc-573aa9a6", "type": "mesh", "label": "Mesh VPN", "destination": "192.168.200.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-8a3e0476", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-8a3e0476", "target": "vpc-vpc-ab85e053", "type": "peering", "label": "VPC Peering", "destination": "10.51.0.0/16"}, {"source": "leaf-1", "target": "vpc-vpc-ab85e053", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-ab85e053", "target": "vpc-vpc-8a3e0476", "type": "peering", "label": "VPC Peering", "destination": "10.50.0.0/16"}, {"source": "leaf-1", "target": "vpc-vpc-697f367b", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-b59f51ba", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-2", "target": "vpc-vpc-51bd6139", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-51bd6139", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-2", "target": "vpc-vpc-9b91088f", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-9b91088f", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-9b91088f", "target": "hub-hub-7e97069b", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "0.0.0.0/0"}, {"source": "vpc-vpc-9b91088f", "target": "hub-hub-47f511ae", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.0.0.0/8"}, {"source": "leaf-2", "target": "vpc-vpc-bb79475f", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-bb79475f", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-bb79475f", "target": "hub-hub-7e97069b", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "0.0.0.0/0"}, {"source": "vpc-vpc-bb79475f", "target": "hub-hub-47f511ae", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.0.0.0/8"}, {"source": "leaf-2", "target": "vpc-vpc-2cb021a8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-2cb021a8", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-2cb021a8", "target": "hub-hub-7e97069b", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "0.0.0.0/0"}, {"source": "vpc-vpc-2cb021a8", "target": "hub-hub-47f511ae", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.0.0.0/8"}, {"source": "leaf-1", "target": "vpc-vpc-9ef51fdf", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-90acd9f1", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-2514fd65", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-2", "target": "vpc-vpc-bc723cf8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-11", "target": "vpc-vpc-bc723cf8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-bc723cf8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-a7fbc296", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-a2d18b69", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-31c0c665", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-31c0c665", "target": "standalone-dc-dc-a400639e", "type": "vpn", "label": "VPN Gateway", "destination": "192.168.0.0/16"}, {"source": "leaf-1", "target": "vpc-vpc-064d934b", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-064d934b", "target": "hub-hub-52545c7e", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.240.0.0/12"}, {"source": "leaf-1", "target": "vpc-vpc-1836b9f4", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-1836b9f4", "target": "hub-hub-52545c7e", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.240.0.0/12"}, {"source": "leaf-1", "target": "vpc-vpc-61572828", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-61572828", "target": "hub-hub-52545c7e", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.240.0.0/12"}, {"source": "leaf-1", "target": "vpc-vpc-c498e154", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-c498e154", "target": "hub-hub-52545c7e", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "10.240.0.0/12"}, {"source": "leaf-1", "target": "vpc-vpc-cc3df9da", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-cb9fd2e8", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-cb9fd2e8", "target": "hub-hub-ba803b25", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "0.0.0.0/0"}, {"source": "leaf-11", "target": "vpc-vpc-f30e89ce", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-f30e89ce", "target": "hub-hub-840705c9", "type": "cloud_routing_hub", "label": "Cloud Routing Hub", "destination": "192.168.10.0/24"}, {"source": "leaf-2", "target": "vpc-vpc-57852d41", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-57852d41", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-cfbb2581", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-cfbb2581", "target": "vpc-vpc-c758cebb", "type": "peering", "label": "VPC Peering", "destination": "10.231.1.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-c758cebb", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-c758cebb", "target": "vpc-vpc-cfbb2581", "type": "peering", "label": "VPC Peering", "destination": "10.221.1.0/24"}, {"source": "leaf-2", "target": "vpc-vpc-74a4f24f", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-74a4f24f", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-2bac8a5d", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-260b8348", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-11", "target": "vpc-vpc-d4cb48dd", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-b161faa4", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-b161faa4", "target": "vpc-vpc-a06466b9", "type": "vpn", "label": "VPN Gateway", "destination": "10.242.0.0/16"}, {"source": "leaf-1", "target": "vpc-vpc-a06466b9", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-a06466b9", "target": "vpc-vpc-b161faa4", "type": "vpn", "label": "VPN Gateway", "destination": "10.241.0.0/16"}, {"source": "leaf-1", "target": "vpc-vpc-85bbfb87", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-46b384a2", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-9728991d", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-815cb68c", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-2", "target": "vpc-vpc-fcbf3c3a", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-fcbf3c3a", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-fcbf3c3a", "target": "10.49.144.3", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-48044aa5", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-48044aa5", "target": "standalone-dc-dc-f1150cbf", "type": "vpn", "label": "VPN Gateway", "destination": "192.168.1.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-73b9fbc5", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-73b9fbc5", "target": "vpc-vpn-auto", "type": "vpn", "label": "VPN Gateway", "destination": "192.5.2.0/24"}, {"source": "leaf-1", "target": "vpc-vpc-5bbacca8", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-1cc3917a", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-1cc3917a", "target": "igw-fa7fdbf6", "type": "internet", "label": "Internet", "destination": "10.49.96.0/28"}, {"source": "vpc-vpc-1cc3917a", "target": "vpc-vpn-auto", "type": "vpn", "label": "VPN Gateway", "destination": "10.0.0.0/8"}, {"source": "leaf-1", "target": "vpc-vpc-139a0f6d", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-139a0f6d", "target": "igw-262b7a22", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-2", "target": "vpc-vpc-3853748e", "type": "overlay", "label": "Logical Membership"}, {"source": "leaf-1", "target": "vpc-vpc-3853748e", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-3853748e", "target": "igw-66894007", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "leaf-1", "target": "vpc-vpc-cbad2f08", "type": "overlay", "label": "Logical Membership"}, {"source": "vpc-vpc-cbad2f08", "target": "igw-529d02eb", "type": "internet", "label": "Internet", "destination": "0.0.0.0/0"}, {"source": "standalone-dc-dc-91e97540", "target": "hub-hub-47f511ae", "type": "vpn", "label": "VPN Gateway", "destination": "10.1.0.0/16"}, {"source": "standalone-dc-dc-91e97540", "target": "hub-hub-47f511ae", "type": "vpn", "label": "VPN Gateway", "destination": "10.2.0.0/16"}, {"source": "standalone-dc-dc-502aec89", "target": "hub-hub-840705c9", "type": "vpn", "label": "VPN Gateway", "destination": "10.0.0.0/8"}, {"source": "standalone-dc-dc-f1150cbf", "target": "vpc-vpc-48044aa5", "type": "vpn", "label": "VPN Gateway", "destination": "203.0.113.0/24"}], "scenarios": [{"title": "1. Single VPC", "description": "Simplest cloud network with one public subnet.", "resources": [{"type": "vpc", "label": "Web VPC"}]}, {"title": "2. Multi-tier VPC", "description": "Professional VPC with public/private segmentation.", "resources": [{"type": "vpc", "label": "Production VPC"}]}, {"title": "3. Secure Database Tier", "description": "Isolation of sensitive data between web DMZ and secure backend.", "resources": [{"type": "vpc", "label": "Production Environment"}]}, {"title": "4. Public Load Balancer & Private Backend", "description": "Ingress traffic management with a public listener and private workers.", "resources": [{"type": "vpc", "label": "Application Service"}]}, {"title": "5. NAT Router for Private Subnets", "description": "Controlled internet access for isolated instances.", "resources": [{"type": "vpc", "label": "Egress Gateway VPC"}]}, {"title": "6. Secure Microservices Mesh", "description": "Secure service-to-service communication.", "resources": [{"type": "vpc", "label": "Platform VPC"}]}, {"title": "7. Managed VPN", "description": "Secure cloud-to-on-prem or region-to-region connectivity.", "resources": [{"type": "vpc", "label": "us-east-vpc"}, {"type": "vpc", "label": "us-west-vpc"}]}, {"title": "8. Private Mesh Overlay", "description": "Zero-trust mesh overlay networking.", "resources": [{"type": "vpc", "label": "Mesh Node West"}, {"type": "vpc", "label": "Mesh Node East"}]}, {"title": "9. VPC Peering", "description": "Simple VPC-to-VPC connectivity within the same region.", "resources": [{"type": "vpc", "label": "Frontend VPC"}, {"type": "vpc", "label": "Backend VPC"}]}, {"title": "10. Private Service Connectivity", "description": "Private service connectivity without full network peering.", "resources": [{"type": "vpc", "label": "Consumer VPC"}, {"type": "vpc", "label": "Provider VPC"}]}, {"title": "11. Collaborative Shared Network", "description": "Centralized network management with departmental isolation.", "resources": [{"type": "vpc", "label": "Shared Network VPC"}]}, {"title": "12. Kubernetes Hybrid Network", "description": "Complex enterprise connectivity with secondary addressing.", "resources": [{"type": "vpc", "label": "Kubernetes Cluster 1"}, {"type": "vpc", "label": "Kubernetes Cluster 2"}, {"type": "hub", "label": "Cloud Routing Hub (NAT Flows)"}, {"type": "hub", "label": "Cloud Routing Hub (Non-NAT Flows)"}, {"type": "vpc", "label": "Shared Services"}, {"type": "standalone_dc", "label": "On-Premise Data Center"}]}, {"title": "13. Secure Application Service Mesh", "description": "High-level application-layer mesh across multiple tiers.", "resources": [{"type": "vpc", "label": "Frontend Mesh VPC"}, {"type": "vpc", "label": "Backend Mesh VPC"}, {"type": "vpc", "label": "Data Mesh VPC"}]}, {"title": "14. Network Lifecycle: Automated vs Manual", "description": "Contrast automated regional coverage with manual precision.", "resources": [{"type": "vpc", "label": "Automated Regional VPC"}, {"type": "vpc", "label": "Manual Controlled VPC"}]}, {"title": "15. Policy Enforcement", "description": "Demonstrate network restriction and security baseline enforcement.", "resources": [{"type": "vpc", "label": "Restricted VPC"}]}, {"title": "16. Hybrid Connectivity: Dedicated & Redundant VPN", "description": "High-speed dedicated cloud connectivity with encrypted fallback.", "resources": [{"type": "vpc", "label": "Corporate Hub VPC"}, {"type": "standalone_dc", "label": "MegaCorp DC"}]}, {"title": "17. Enterprise Hub-and-Spoke", "description": "Large-scale topology with central policy management.", "resources": [{"type": "hub", "label": "Enterprise Policy Hub"}, {"type": "vpc", "label": "Engineering Spoke"}, {"type": "vpc", "label": "Finance Spoke"}, {"type": "vpc", "label": "HR Spoke"}, {"type": "vpc", "label": "Security Services VPC"}]}, {"title": "18. Virtual Appliance Routing", "description": "Route traffic through a security appliance in a hub VPC.", "resources": [{"type": "vpc", "label": "Spoke Application VPC"}, {"type": "vpc", "label": "Transit Security VPC"}, {"type": "hub", "label": "Transit Backbone Hub"}]}, {"title": "19. Hub Gateway Transit", "description": "Spokes use a central hub's VPN gateway.", "resources": [{"type": "standalone_dc", "label": "On-Premises Data Center"}, {"type": "hub", "label": "Central Hybrid Hub"}, {"type": "vpc", "label": "Remote Spoke VPC"}]}, {"title": "20. Data-Scale Network: Secondary CIDR Expansion & Pre-initialized Instances", "description": "High-density networking with secondary CIDR ranges to provide ready-state instance pools", "resources": [{"type": "vpc", "label": "High-Density Cluster VPC"}]}, {"title": "21. Subnet-Level Peering", "description": "Restrict peering connectivity to specific subnets.", "resources": [{"type": "vpc", "label": "Producer Service VPC"}, {"type": "vpc", "label": "Consumer Client VPC"}]}, {"title": "22. Shared Cluster Infrastructure", "description": "Shared VPC for multiple teams with governance.", "resources": [{"type": "vpc", "label": "Enterprise Shared VPC"}]}, {"title": "23. Cloud-Native Service Hub", "description": "Identity-based service connectivity layer.", "resources": [{"type": "hub", "label": "Service Mesh Hub"}, {"type": "vpc", "label": "Checkout VPC"}, {"type": "vpc", "label": "Inventory VPC"}, {"type": "vpc", "label": "Client VPC"}]}, {"title": "24. Hybrid Appliance Bridge", "description": "Managed cloud VPN connecting to a custom software appliance.", "resources": [{"type": "vpc", "label": "Provider Network (Managed)"}, {"type": "vpc", "label": "Consumer Network (Software Appliance)"}]}, {"title": "25. AI Infrastructure: Accelerated RDMA Network", "description": "Specialized high-performance networking for AI/ML training workloads", "resources": [{"type": "vpc", "label": "AI Training VPC"}]}, {"title": "26. Global Transit: Multi-Region Hubs with GRE Support", "description": "Integration of SASE and SD-WAN using GRE tunneling over global transit hubs", "resources": [{"type": "hub", "label": "Regional Hub A"}, {"type": "hub", "label": "Regional Hub B"}, {"type": "vpc", "label": "Security Appliance VPC"}]}, {"title": "27. Dual-Stack Infrastructure: IPv4 & IPv6 Coexistence", "description": "Modern network design supporting concurrent IPv4 and IPv6 traffic flows", "resources": [{"type": "vpc", "label": "Dual-Stack VPC"}]}, {"title": "28. Cloud Native NAT Router", "description": "Linux-based NAT router managing ingress and egress.", "resources": [{"type": "vpc", "label": "NAT Router VPC"}]}, {"title": "29. Heterogeneous Load Balancing", "description": "Load Balancer distributing traffic across mixed-os backends.", "resources": [{"type": "vpc", "label": "Load Balanced VPC"}]}, {"title": "30. Standard IPsec VPN (Site-to-Site)", "description": "Secure IPsec tunnel between a VPC and on-prem.", "resources": [{"type": "vpc", "label": "Cloud VPC"}, {"type": "standalone_dc", "label": "On-Premises Network"}]}, {"title": "31. Remote Access VPN", "description": "Road Warrior connectivity via IKEv2/IPsec.", "resources": [{"type": "vpc", "label": "Remote Access Hub VPC"}]}, {"title": "32. Private DNS Discovery", "description": "Internal zone management with private resolution.", "resources": [{"type": "vpc", "label": "DNS Managed VPC"}]}, {"title": "33. Legacy Windows Integration", "description": "Legacy workloads with multiple interfaces.", "resources": [{"type": "vpc", "label": "Legacy Windows VPC"}]}, {"title": "34. Brownfield Endpoint Adoption", "description": "Adopt existing workloads into a new VPC without redeployment, ensuring accurate VPC View mapping.", "resources": [{"type": "vpc", "label": "Brownfield VPC"}]}, {"title": "35. Partial Brownfield Adoption", "description": "Adopt a subset of existing workloads while rejecting conflicting endpoints, with VPC View reflecting accurate endpoint placement.", "resources": [{"type": "vpc", "label": "Partial Brownfield VPC"}]}, {"title": "36. Brownfield Adoption Under Churn", "description": "Adopt existing workloads into a new VPC while maintaining accurate VPC View display during control plane churn.", "resources": [{"type": "vpc", "label": "Churn Resilient Brownfield VPC"}]}]};
window.STATIC_SCENARIOS = ["Single VPC", "Multi-tier VPC", "Secure Database Tier", "Public Load Balancer & Private Backend", "NAT Router for Private Subnets", "Secure Microservices Mesh", "Managed VPN", "Private Mesh Overlay", "VPC Peering", "Private Service Connectivity", "Collaborative Shared Network", "Kubernetes Hybrid Network", "Secure Application Service Mesh", "Network Lifecycle: Automated vs Manual", "Policy Enforcement", "Hybrid Connectivity: Dedicated & Redundant VPN", "Enterprise Hub-and-Spoke", "Virtual Appliance Routing", "Hub Gateway Transit", "Data-Scale Network: Secondary CIDR Expansion & Pre-initialized Instances", "Subnet-Level Peering", "Shared Cluster Infrastructure", "Cloud-Native Service Hub", "Hybrid Appliance Bridge", "AI Infrastructure: Accelerated RDMA Network", "Global Transit: Multi-Region Hubs with GRE Support", "Dual-Stack Infrastructure: IPv4 & IPv6 Coexistence", "Cloud Native NAT Router", "Heterogeneous Load Balancing", "Standard IPsec VPN (Site-to-Site)", "Remote Access VPN", "Private DNS Discovery", "Legacy Windows Integration", "Brownfield Endpoint Adoption", "Partial Brownfield Adoption", "Brownfield Adoption Under Churn"];</script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cloud Networking Control Plane Simulator</title>
<style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #fafafa;
            min-height: 100vh;
        }

        header {
            background: #232f3e;
            color: white;
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        header h1 {
            font-size: 1.2rem;
            font-weight: 400;
        }

        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            height: 40px;
            width: auto;
        }

        .btn {
            background: #00897b;
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
        }

        .btn:hover {
            background: #00796b;
        }

        .btn-secondary {
            background: #545b64;
            color: white;
        }

        .btn-secondary:hover {
            background: #6b7280;
        }

        .btn-secondary.active {
            background: #0073bb;
        }

        .toggle-group {
            display: flex;
            gap: 4px;
        }

        .main-container {
            padding: 20px;
            position: relative;
        }

        /* SVG Overlay for connections */
        .svg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }

        .architecture-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: flex-start;
            align-items: flex-start;
            position: relative;
        }

        /* VPC Box */
        .vpc {
            background: linear-gradient(135deg, #fffde7 0%, #fff9c4 100%);
            border: 3px solid #827717;
            border-radius: 8px;
            padding: 20px;
            min-width: 300px;
            max-width: 550px;
            position: relative;
        }

        .vpc-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #c0ca33;
        }

        .vpc-icon {
            width: 28px;
            height: 28px;
            background: #827717;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 10px;
        }

        .vpc-title {
            font-weight: bold;
            font-size: 13px;
            color: #33691e;
        }

        .vpc-cidr {
            font-size: 10px;
            color: #689f38;
            margin-left: auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 8px;
            border-radius: 10px;
            font-family: monospace;
        }

        /* Internet Gateway at VPC level */
        .vpc-gateways {
            position: absolute;
            top: -15px;
            right: 20px;
            display: flex;
            gap: 8px;
        }

        .igw-icon {
            background: #e0f2f1;
            border: 2px solid #00897b;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: #004d40;
        }

        /* Data Center Box */
        .dc-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .dc {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #1565c0;
            border-radius: 6px;
            padding: 12px;
            flex: 1;
            min-width: 120px;
        }

        .dc-header {
            font-size: 10px;
            font-weight: bold;
            color: #0d47a1;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dc-icon {
            width: 16px;
            height: 16px;
            background: #1565c0;
            border-radius: 2px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
        }

        /* Hub Resource Box (Standalone) */
        .hub {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 3px solid #c62828;
            border-radius: 12px;
            padding: 20px;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .hub-icon {
            width: 40px;
            height: 40px;
            background: white;
            border: 2px solid #c62828;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #c62828;
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .hub-title {
            font-weight: bold;
            font-size: 14px;
            color: #b71c1c;
            margin-bottom: 5px;
        }

        .hub-region {
            display: none;
        }

        /* Subnet Box */
        .subnets {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .subnet {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #2e7d32;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 9px;
        }

        .subnet.private {
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            border-color: #3949ab;
        }

        .subnet.cgnat {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border-color: #7b1fa2;
        }

        .subnet.ngw-dc {
            background: linear-gradient(135deg, #ede7f6 0%, #d1c4e9 100%);
            border-color: #512da8;
        }

        .subnet.server {
            background: linear-gradient(135deg, #eceff1 0%, #cfd8dc 100%);
            border-color: #455a64;
        }

        .subnet-name {
            font-weight: bold;
            color: #1b5e20;
        }

        .subnet.private .subnet-name {
            color: #1a237e;
        }

        .subnet.cgnat .subnet-name {
            color: #4a148c;
        }

        .subnet.ngw-dc .subnet-name {
            color: #311b92;
        }

        .subnet.server .subnet-name {
            color: #263238;
        }

        .subnet-cidr {
            color: #666;
            font-family: monospace;
            font-size: 8px;
        }

        /* Gateway inside DC */
        .gateway {
            background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
            border: 2px solid #00897b;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 8px;
            font-weight: bold;
            color: #00695c;
            margin-top: 6px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .gateway-icon {
            width: 12px;
            height: 12px;
            background: #00897b;
            border-radius: 2px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6px;
        }

        /* Route Tables (Detailed View) */
        .route-tables {
            margin-top: 15px;
            /* Always visible now */
            display: block;
        }

        .route-table {
            border: 1px solid #00897b;
            border-radius: 4px;
            overflow: hidden;
            font-size: 8px;
            margin-bottom: 8px;
        }

        .route-table-header {
            background: #00897b;
            color: white;
            padding: 4px 8px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }

        .route-table-body {
            background: white;
        }

        .route-row {
            display: flex;
            border-bottom: 1px solid #eee;
        }

        .route-row:last-child {
            border-bottom: none;
        }

        .route-cell {
            padding: 3px 6px;
            flex: 1;
            font-family: monospace;
        }

        .route-cell:first-child {
            border-right: 1px solid #eee;
        }

        /* Connections Section - Multiple Types */
        .connections-section {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
        }

        .connections-section.peering {
            background: #f3e5f5;
            border: 2px dashed #7b1fa2;
        }

        .connections-section.vpn {
            background: #e8eaf6;
            border: 2px solid #3949ab;
        }

        .connections-section.mesh {
            background: #e8f5e9;
            border: 2px dotted #2e7d32;
        }

        .connections-section.cloud_routing_hub {
            background: #ffebee;
            border: 2px solid #c62828;
        }

        .connections-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .connections-title.peering {
            color: #4a148c;
        }

        .connections-title.vpn {
            color: #283593;
        }

        .connections-title.mesh {
            color: #1b5e20;
        }

        .connections-title.cloud_routing_hub {
            color: #c62828;
        }

        .connections-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .connection-item {
            background: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .connection-item.peering {
            border: 1px solid #ce93d8;
        }

        .connection-item.vpn {
            border: 1px solid #9fa8da;
        }

        .connection-item.mesh {
            border: 1px solid #a5d6a7;
        }

        .connection-item.cloud-routing-hub {
            border: 1px solid #90caf9;
            color: #c62828 !important;
        }

        /* Cloud Routing Hub */
        .routing-hub-section {
            margin-top: 20px;
        }

        .routing-hub-section.visible {
            display: block;
        }

        .network-hub {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 3px solid #1976d2;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .hub-icon {
            width: 50px;
            height: 50px;
            background: #1976d2;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 10px;
        }

        .hub-title {
            font-weight: bold;
            color: #0d47a1;
            font-size: 12px;
        }

        .hub-subtitle {
            font-size: 10px;
            color: #666;
        }

        .connection-arrow {
            font-weight: bold;
            font-size: 16px;
        }

        .connection-arrow.peering {
            color: #7b1fa2;
        }

        .connection-arrow.vpn {
            color: #3949ab;
        }

        .connection-arrow.mesh {
            color: #2e7d32;
        }

        .connection-arrow.cloud_routing_hub {
            color: #c62828;
        }

        .connection-type-icon {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
            color: white;
        }

        .connection-type-icon.peering {
            background: #7b1fa2;
        }

        .connection-type-icon.vpn {
            background: #3949ab;
        }

        .connection-type-icon.mesh {
            background: #2e7d32;
        }

        .connection-type-icon.cloud_routing_hub {
            background: #c62828 !important;
            font-size: 8px !important;
            font-weight: bold !important;
            color: white !important;
            width: 24px !important;
            height: 24px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 3px !important;
        }

        .connections-title.cloud_routing_hub .connection-type-icon.cloud_routing_hub {
            background: #c62828 !important;
            color: white !important;
        }

        .connection-destination {
            font-family: monospace;
            font-size: 9px;
            color: #666;
            margin-left: auto;
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
        }



        .cloud-routing-hub-section.visible {
            display: block;
        }

        .cloud-routing-hub {
            background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
            border: 3px solid #00897b;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .crh-icon {
            width: 50px;
            height: 50px;
            background: #00897b;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 10px;
        }

        .crh-title {
            font-weight: bold;
            color: #00695c;
            font-size: 12px;
        }

        .node-group {
            border: 1px dashed #1976d2;
            background: #e3f2fd;
            padding: 8px;
            margin-top: 8px;
            border-radius: 4px;
            /* Always visible */
            display: block;
        }

        .node-group.visible {
            display: block;
        }

        .node-group-title {
            font-size: 10px;
            font-weight: bold;
            color: #1565c0;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Status bar */
        .status {
            padding: 10px 24px;
            font-size: 11px;
            color: #666;
            background: #f5f5f5;
            border-top: 1px solid #ddd;
            border-top: 1px solid #ddd;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
        }

        /* Legend */
        .legend {
            position: fixed;
            bottom: 50px;
            right: 20px;
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 9px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .legend-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #232f3e;
            font-size: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 4px;
        }

        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 2px;
        }

        .gateway-icon.vpn {
            background: #ef6c00;
            border-color: #e65100;
        }

        .gateway-icon.mesh {
            background: #2e7d32;
            border-color: #1b5e20;
        }

        /* Scenario Grouping */
        .scenario-group {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            width: 100%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .scenario-title {
            font-size: 16px;
            font-weight: bold;
            color: #232f3e;
            margin-bottom: 5px;
            border-bottom: 2px solid #00897b;
            padding-bottom: 10px;
            display: inline-block;
        }

        .scenario-desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 20px;
            font-style: italic;
        }

        .scenario-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .vpc-secondary-cidrs {
            font-size: 9px;
            color: #666;
            margin-top: 2px;
            font-family: monospace;
            display: block;
        }

        /* High-Fidelity Grid Layout */
        .scenario-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 40px;
            width: 100%;
        }

        .scenario-column {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .propagation-arrow {
            fill: none;
            stroke: #3949ab;
            stroke-width: 2;
            stroke-dasharray: 5, 5;
            marker-end: url(#arrowhead);
        }

        .propagation-label {
            font-size: 9px;
            fill: #3949ab;
            font-weight: bold;
        }

        /* Standalone Data Center (no VPC wrapper) */
        .standalone-dc {
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border: 2px solid #757575;
            border-radius: 8px;
            padding: 15px;
            min-width: 280px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .standalone-dc-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #bdbdbd;
        }

        .standalone-dc-icon {
            width: 32px;
            height: 32px;
            background: #616161;
            color: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
        }

        .standalone-dc-title {
            font-weight: bold;
            color: #424242;
            font-size: 13px;
        }

        .standalone-dc-cidr {
            font-size: 10px;
            color: #757575;
            font-family: monospace;
            margin-left: auto;
        }

        .standalone-dc .dc-icon {
            background: #616161;
        }

        .standalone-dc .dc-container {
            margin-top: 10px;
        }
    </style>
</head>
<body>
<header>
<div class="logo-container">
<img alt="CNCPS Logo" class="logo" src="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0ic2t5R3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojRThGNEZGO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNCOEQ5RjU7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJjbG91ZENvcmFsR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNBOEQ1RjI7c3RvcC1vcGFjaXR5OjAuOSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojN0JCM0UwO3N0b3Atb3BhY2l0eTowLjg1IiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0ibWlzdEdyYWQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZGRkZGO3N0b3Atb3BhY2l0eTowLjciIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6I0Q0RTlGNztzdG9wLW9wYWNpdHk6MC41IiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0ibm9kZUdyYWQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNkVDOUUwO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM0QTkwRTI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGZpbHRlciBpZD0iY2xvdWRHbG93Ij4KICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIgcmVzdWx0PSJjb2xvcmVkQmx1ciIvPgogICAgICA8ZmVNZXJnZT4KICAgICAgICA8ZmVNZXJnZU5vZGUgaW49ImNvbG9yZWRCbHVyIi8+CiAgICAgICAgPGZlTWVyZ2VOb2RlIGluPSJTb3VyY2VHcmFwaGljIi8+CiAgICAgIDwvZmVNZXJnZT4KICAgIDwvZmlsdGVyPgogICAgPGZpbHRlciBpZD0ic29mdEdsb3ciPgogICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiIHJlc3VsdD0iY29sb3JlZEJsdXIiLz4KICAgICAgPGZlTWVyZ2U+CiAgICAgICAgPGZlTWVyZ2VOb2RlIGluPSJjb2xvcmVkQmx1ciIvPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iU291cmNlR3JhcGhpYyIvPgogICAgICA8L2ZlTWVyZ2U+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CiAgCiAgPCEtLSBTa3kgYmFja2dyb3VuZCAtLT4KICA8cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0idXJsKCNza3lHcmFkKSIvPgogIAogIDwhLS0gQmFja2dyb3VuZCBjbG91ZCB3aXNwcyAtLT4KICA8ZWxsaXBzZSBjeD0iNDUiIGN5PSI2MCIgcng9IjI1IiByeT0iMTIiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNCIgZmlsdGVyPSJ1cmwoI2Nsb3VkR2xvdykiLz4KICA8ZWxsaXBzZSBjeD0iMTU1IiBjeT0iNzAiIHJ4PSIyOCIgcnk9IjE0IiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjM1IiBmaWx0ZXI9InVybCgjY2xvdWRHbG93KSIvPgogIDxlbGxpcHNlIGN4PSI3MCIgY3k9IjEyMCIgcng9IjIwIiByeT0iMTAiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuMyIgZmlsdGVyPSJ1cmwoI2Nsb3VkR2xvdykiLz4KICA8ZWxsaXBzZSBjeD0iMTQwIiBjeT0iMTE1IiByeD0iMjIiIHJ5PSIxMSIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC4zIiBmaWx0ZXI9InVybCgjY2xvdWRHbG93KSIvPgogIAogIDwhLS0gRXRoZXJlYWwgdmFwb3IgYmFzZSAoZmxvYXRpbmcgY2xvdWQgZm91bmRhdGlvbikgLS0+CiAgPGVsbGlwc2UgY3g9IjEwMCIgY3k9IjEyNSIgcng9IjQ1IiByeT0iMTUiIGZpbGw9InVybCgjbWlzdEdyYWQpIiBvcGFjaXR5PSIwLjYiIGZpbHRlcj0idXJsKCNjbG91ZEdsb3cpIi8+CiAgPGVsbGlwc2UgY3g9Ijk1IiBjeT0iMTI4IiByeD0iMzUiIHJ5PSIxMCIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC40IiBmaWx0ZXI9InVybCgjY2xvdWRHbG93KSIvPgogIAogIDwhLS0gTWFpbiBjb3JhbCBicmFuY2ggc3RydWN0dXJlIC0gd2lzcHkgY2xvdWQgdGV4dHVyZSAtLT4KICA8cGF0aCBkPSJNIDEwMCAxMjUgUSA5OCAxMTAgMTAwIDk1IFEgMTAyIDgwIDEwMCA2NSIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI4IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjc1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICAKICA8IS0tIENsb3VkIGNvcmFsIHRleHR1cmUgb3ZlcmxheSBvbiBtYWluIGJyYW5jaCAtLT4KICA8ZWxsaXBzZSBjeD0iMTAwIiBjeT0iOTUiIHJ4PSI2IiByeT0iMTgiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuMyIgZmlsdGVyPSJ1cmwoI2Nsb3VkR2xvdykiLz4KICA8ZWxsaXBzZSBjeD0iMTAwIiBjeT0iNzUiIHJ4PSI1IiByeT0iMTUiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuMjUiIGZpbHRlcj0idXJsKCNjbG91ZEdsb3cpIi8+CiAgCiAgPCEtLSBMZWZ0IG1haW4gYnJhbmNoIHdpdGggbWlzdCAtLT4KICA8cGF0aCBkPSJNIDEwMCAxMDUgUSA4OCAxMDAgNzggODggUSA3MiA4MCA2OCA3MiIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI2IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjc1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICA8ZWxsaXBzZSBjeD0iNzgiIGN5PSI4OCIgcng9IjUiIHJ5PSIxMiIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC4yNSIgZmlsdGVyPSJ1cmwoI2Nsb3VkR2xvdykiLz4KICAKICA8IS0tIFJpZ2h0IG1haW4gYnJhbmNoIHdpdGggbWlzdCAtLT4KICA8cGF0aCBkPSJNIDEwMCAxMDUgUSAxMTIgMTAwIDEyMiA4OCBRIDEyOCA4MCAxMzIgNzIiIAogICAgICAgIHN0cm9rZT0idXJsKCNjbG91ZENvcmFsR3JhZCkiIHN0cm9rZS13aWR0aD0iNiIgZmlsbD0ibm9uZSIgCiAgICAgICAgb3BhY2l0eT0iMC43NSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPGVsbGlwc2UgY3g9IjEyMiIgY3k9Ijg4IiByeD0iNSIgcnk9IjEyIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjI1IiBmaWx0ZXI9InVybCgjY2xvdWRHbG93KSIvPgogIAogIDwhLS0gTGVmdCBzZWNvbmRhcnkgYnJhbmNoZXMgLS0+CiAgPHBhdGggZD0iTSA3OCA4OCBRIDcyIDg0IDY4IDc4IiAKICAgICAgICBzdHJva2U9InVybCgjY2xvdWRDb3JhbEdyYWQpIiBzdHJva2Utd2lkdGg9IjQiIGZpbGw9Im5vbmUiIAogICAgICAgIG9wYWNpdHk9IjAuNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPHBhdGggZD0iTSA3OCA4OCBRIDgyIDgyIDg0IDc1IiAKICAgICAgICBzdHJva2U9InVybCgjY2xvdWRDb3JhbEdyYWQpIiBzdHJva2Utd2lkdGg9IjQiIGZpbGw9Im5vbmUiIAogICAgICAgIG9wYWNpdHk9IjAuNjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIAogIDwhLS0gUmlnaHQgc2Vjb25kYXJ5IGJyYW5jaGVzIC0tPgogIDxwYXRoIGQ9Ik0gMTIyIDg4IFEgMTI4IDg0IDEzMiA3OCIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI0IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIDxwYXRoIGQ9Ik0gMTIyIDg4IFEgMTE4IDgyIDExNiA3NSIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI0IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjY1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICAKICA8IS0tIENlbnRlciB0b3AgYnJhbmNoZXMgLS0+CiAgPHBhdGggZD0iTSAxMDAgNjUgUSA5NCA2MCA5MCA1MyIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI0IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIDxwYXRoIGQ9Ik0gMTAwIDY1IFEgMTA2IDYwIDExMCA1MyIgCiAgICAgICAgc3Ryb2tlPSJ1cmwoI2Nsb3VkQ29yYWxHcmFkKSIgc3Ryb2tlLXdpZHRoPSI0IiBmaWxsPSJub25lIiAKICAgICAgICBvcGFjaXR5PSIwLjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIAogIDwhLS0gTmV0d29yayBub2RlIHBvbHlwcyAtIGdsb3dpbmcgaW4gdGhlIGFpciAtLT4KICA8Y2lyY2xlIGN4PSI5MCIgY3k9IjUzIiByPSI1IiBmaWxsPSJ1cmwoI25vZGVHcmFkKSIgb3BhY2l0eT0iMC45IiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPGNpcmNsZSBjeD0iOTAiIGN5PSI1MyIgcj0iMyIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC42Ii8+CiAgCiAgPGNpcmNsZSBjeD0iMTEwIiBjeT0iNTMiIHI9IjUiIGZpbGw9InVybCgjbm9kZUdyYWQpIiBvcGFjaXR5PSIwLjkiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICA8Y2lyY2xlIGN4PSIxMTAiIGN5PSI1MyIgcj0iMyIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC42Ii8+CiAgCiAgPGNpcmNsZSBjeD0iNjgiIGN5PSI3MiIgcj0iNSIgZmlsbD0idXJsKCNub2RlR3JhZCkiIG9wYWNpdHk9IjAuOSIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIDxjaXJjbGUgY3g9IjY4IiBjeT0iNzIiIHI9IjMiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNiIvPgogIAogIDxjaXJjbGUgY3g9IjEzMiIgY3k9IjcyIiByPSI1IiBmaWxsPSJ1cmwoI25vZGVHcmFkKSIgb3BhY2l0eT0iMC45IiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPGNpcmNsZSBjeD0iMTMyIiBjeT0iNzIiIHI9IjMiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNiIvPgogIAogIDxjaXJjbGUgY3g9Ijg0IiBjeT0iNzUiIHI9IjQuNSIgZmlsbD0idXJsKCNub2RlR3JhZCkiIG9wYWNpdHk9IjAuODUiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICA8Y2lyY2xlIGN4PSI4NCIgY3k9Ijc1IiByPSIyLjUiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNSIvPgogIAogIDxjaXJjbGUgY3g9IjExNiIgY3k9Ijc1IiByPSI0LjUiIGZpbGw9InVybCgjbm9kZUdyYWQpIiBvcGFjaXR5PSIwLjg1IiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPGNpcmNsZSBjeD0iMTE2IiBjeT0iNzUiIHI9IjIuNSIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC41Ii8+CiAgCiAgPGNpcmNsZSBjeD0iNjgiIGN5PSI3OCIgcj0iNCIgZmlsbD0idXJsKCNub2RlR3JhZCkiIG9wYWNpdHk9IjAuODUiIGZpbHRlcj0idXJsKCNzb2Z0R2xvdykiLz4KICA8Y2lyY2xlIGN4PSI2OCIgY3k9Ijc4IiByPSIyLjUiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNSIvPgogIAogIDxjaXJjbGUgY3g9IjEzMiIgY3k9Ijc4IiByPSI0IiBmaWxsPSJ1cmwoI25vZGVHcmFkKSIgb3BhY2l0eT0iMC44NSIgZmlsdGVyPSJ1cmwoI3NvZnRHbG93KSIvPgogIDxjaXJjbGUgY3g9IjEzMiIgY3k9Ijc4IiByPSIyLjUiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNSIvPgogIAogIDxjaXJjbGUgY3g9IjEwMCIgY3k9IjY1IiByPSI1IiBmaWxsPSJ1cmwoI25vZGVHcmFkKSIgb3BhY2l0eT0iMC45IiBmaWx0ZXI9InVybCgjc29mdEdsb3cpIi8+CiAgPGNpcmNsZSBjeD0iMTAwIiBjeT0iNjUiIHI9IjMiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNiIvPgogIAogIDwhLS0gRGF0YSBwYWNrZXRzIGZsb2F0aW5nIHRocm91Z2ggdGhlIHNreSAtLT4KICA8Y2lyY2xlIGN4PSI2MCIgY3k9IjcwIiByPSIyLjUiIGZpbGw9IiM2RUM5RTAiIG9wYWNpdHk9IjAuNyI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJjeSIgdmFsdWVzPSI3MDs1NTs3MCIgZHVyPSI0cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMC43OzAuMzswLjciIGR1cj0iNHMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSBjeD0iMTQwIiBjeT0iNjUiIHI9IjIuNSIgZmlsbD0iIzZFQzlFMCIgb3BhY2l0eT0iMC42Ij4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImN5IiB2YWx1ZXM9IjY1OzUwOzY1IiBkdXI9IjQuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjAuNjswLjI7MC42IiBkdXI9IjQuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSBjeD0iOTUiIGN5PSI2MCIgcj0iMiIgZmlsbD0iIzZFQzlFMCIgb3BhY2l0eT0iMC44Ij4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImN5IiB2YWx1ZXM9IjYwOzQ4OzYwIiBkdXI9IjMuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjAuODswLjM7MC44IiBkdXI9IjMuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSBjeD0iMTA4IiBjeT0iNjIiIHI9IjIiIGZpbGw9IiM2RUM5RTAiIG9wYWNpdHk9IjAuNjUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3kiIHZhbHVlcz0iNjI7NTA7NjIiIGR1cj0iMy44cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMC42NTswLjI1OzAuNjUiIGR1cj0iMy44cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4KICA8L2NpcmNsZT4KICAKICA8IS0tIFdpc3B5IGNsb3VkIHBhcnRpY2xlcyBkcmlmdGluZyAtLT4KICA8ZWxsaXBzZSBjeD0iNzUiIGN5PSI5NSIgcng9IjQiIHJ5PSIyIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iY3giIHZhbHVlcz0iNzU7NzI7NzUiIGR1cj0iNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgPC9lbGxpcHNlPgogIDxlbGxpcHNlIGN4PSIxMjUiIGN5PSI5MCIgcng9IjQiIHJ5PSIyIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjQ1Ij4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImN4IiB2YWx1ZXM9IjEyNTsxMjg7MTI1IiBkdXI9IjUuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgPC9lbGxpcHNlPgogIAogIDwhLS0gQ05DUFMgdGV4dCAtLT4KICA8dGV4dCB4PSIxMDAiIHk9IjE1NSIgZm9udC1mYW1pbHk9IidDb3VyaWVyIE5ldycsIG1vbm9zcGFjZSIgZm9udC1zaXplPSIyMiIgZm9udC13ZWlnaHQ9ImJvbGQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiMyQzNFNTAiIGxldHRlci1zcGFjaW5nPSIzIj4KICAgIENOQ1BTCiAgPC90ZXh0PgogIDx0ZXh0IHg9IjEwMCIgeT0iMTcwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iOSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzVBNkM3RCIgbGV0dGVyLXNwYWNpbmc9IjAuNSI+CiAgICBDbG91ZCBOZXR3b3JraW5nIENvbnRyb2wgUGxhbmUgU2ltdWxhdG9yCiAgPC90ZXh0Pgo8L3N2Zz4="/>
<h1>Cloud Networking Control Plane Simulator</h1>
</div>
<div class="controls">
<button class="btn btn-secondary" onclick="toggleApiGuide()"> Documentation Hub</button>
</div>
</header>
<div class="main-container">
<svg class="svg-overlay" id="svg-connections">
<defs>
<marker id="arrowhead" markerheight="7" markerwidth="10" orient="auto" refx="9" refy="3.5">
<polygon fill="#3949ab" points="0 0, 10 3.5, 0 7"></polygon>
</marker>
</defs>
</svg>
<div class="architecture-container" id="content">
<p>Loading...</p>
</div>
<div id="peering-container"></div>
</div>
<div class="legend">
<div class="legend-title">Resource Types</div>
<div class="legend-item">
<div class="legend-dot" style="background: #fffde7; border: 2px solid #827717;"></div> VPC
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #e3f2fd; border: 2px solid #1565c0;"></div> Cloud Data Center
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #f5f5f5; border: 2px solid #757575;"></div> On-Premise Data
            Center
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #e8f5e9; border: 2px solid #2e7d32;"></div> Public Subnet
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #e8eaf6; border: 2px solid #3949ab;"></div> Private Subnet
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #f3e5f5; border: 2px solid #7b1fa2;"></div> CGNAT Subnet
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #ede7f6; border: 2px solid #512da8;"></div> NGW-DC Subnet
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #eceff1; border: 2px solid #455a64;"></div> Server
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #fff; border: 2px solid #00897b;"></div> Routing Table
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #fff3e0; border: 2px solid #ef6c00;"></div> Gateway
        </div>
<div class="legend-item">
<div class="legend-dot" style="background: #ffebee; border: 2px solid #c62828;"></div> Cloud Routing Hub
        </div>
</div>
<div class="status" id="status">Initializing...</div>
<script>
        let currentView = 'detailed';
        let cachedData = null;

        // View toggle logic removed, default to detailed

        function getSubnetClass(name, type) {
            const lower = name.toLowerCase();
            if (type === 'server' || lower.includes('server')) return 'server';
            if (lower.includes('private') || lower.includes('data')) return 'private';
            if (lower.includes('cgnat') || lower.includes('reserved')) return 'cgnat';
            if (lower.includes('ngw-dc')) return 'ngw-dc';
            return '';
        }

        function generateRouteTable(vpcName, routes) {
            if (!routes || routes.length === 0) {
                // Generate sample routes based on VPC
                routes = [
                    { destination: 'local', target: 'local' },
                    { destination: '0.0.0.0/0', target: 'igw-xxx' }
                ];
            }

            let html = `
                <div class="route-table">
                    <div class="route-table-header">
                        <span>Destination</span>
                        <span>Target</span>
                    </div>
                    <div class="route-table-body">
            `;

            routes.forEach(r => {
                const targetDisplay = r.target || r.next_hop || 'undefined';
                html += `
                    <div class="route-row">
                        <div class="route-cell">${r.destination}</div>
                        <div class="route-cell">${targetDisplay}</div>
                    </div>
                `;
            });

            html += '</div></div>';
            return html;
        }

        async function loadData() {
            try {
                let data;
                if (window.STATIC_VPC_DATA) {
                    console.log("Using static VPC data");
                    data = window.STATIC_VPC_DATA;
                    // Disable auto-refresh in static mode
                    const statusEl = document.getElementById('status');
                    if (statusEl) statusEl.innerText = 'Static Reference Mode';
                } else {
                    const response = await fetch('/vpc');
                    if (!response.ok) throw new Error('API unstable or not responding');
                    data = await response.json();
                }
                cachedData = data;

                const vpcs = Array.from(new Map(data.nodes.filter(n => n.type === 'vpc').map(v => [v.label, v])).values());
                const hubs = Array.from(new Map(data.nodes.filter(n => n.type === 'hub').map(h => [h.label, h])).values());
                const standaloneDCs = Array.from(new Map(data.nodes.filter(n => n.type === 'standalone_dc').map(s => [s.label, s])).values());
                const dcs = data.nodes.filter(n => n.type === 'dc');
                const subnets = data.nodes.filter(n => n.type === 'subnet' || n.type === 'server');
                const gateways = data.nodes.filter(n => n.type === 'nat' || n.type === 'igw');
                const vpnGateways = data.nodes.filter(n => n.type === 'vpn_gateway');
                const meshNodes = data.nodes.filter(n => n.type === 'mesh_node');
                const peeringEdges = data.edges.filter(e => e.type === 'peering');

                let html = '';

                // Helper to strip "1.", "30." etc for matching and display
                const getCleanTitle = (t) => t ? t.replace(/^\d+[\.\s\-\:]+/, '').trim() : '';

                // Deduplicate scenarios based on clean title
                const rawScenarios = data.scenarios || [];
                const scenarios = [];
                const seenTitles = new Set();
                rawScenarios.forEach(s => {
                    const clean = getCleanTitle(s.title);
                    if (clean && !seenTitles.has(clean)) {
                         seenTitles.add(clean);
                         scenarios.push(s);
                    }
                });

                const formatVpcHtml = (vpc) => {
                    const vpcDcs = dcs.filter(d => d.parent === vpc.id);
                    const vpcIgws = gateways.filter(g => g.parent === vpc.id && g.type === 'igw');

                    let innerHtml = `
                        <div class="vpc" data-vpc-id="${vpc.id}">
                            <div class="vpc-gateways">
                                ${vpcIgws.length > 0 ? vpcIgws.map(igw => `<div class="igw-icon" title="${igw.label}">IGW</div>`).join('') : ''}
                                ${vpnGateways.filter(g => g.parent === vpc.id).map(g => `<div class="gateway-icon vpn" title="${g.label}">WG</div>`).join('')}
                                ${meshNodes.filter(m => m.parent === vpc.id).map(m => `<div class="gateway-icon mesh" title="${m.label}">HS</div>`).join('')}
                            </div>
                            <div class="vpc-header">
                                <div class="vpc-icon">VPC</div>
                                <span class="vpc-title">${vpc.label.replace(/\n/g, '<br>')}</span>
                                <span class="vpc-cidr">${vpc.cidr || ''}</span>
                                ${vpc.secondary_cidrs && vpc.secondary_cidrs.length > 0 ?
                            `<span class="vpc-secondary-cidrs">+ ${vpc.secondary_cidrs.join(', ')}</span>` : ''}
                            </div>
                            <div class="dc-container">
                                ${vpc.secondary_cidrs && vpc.secondary_cidrs.length > 0 ? `
                                    <div class="node-group visible">
                                        <div class="node-group-title">
                                            <span></span> Kubernetes Node Group
                                        </div>
                                        <div style="font-size: 9px; color: #666;">Pool: default-pool</div>
                                    </div>
                                ` : ''}
                    `;

                    if (vpcDcs.length === 0) {
                        const vpcSubnets = subnets.filter(s => s.parent === vpc.id || (data.nodes.find(n => n.id === s.parent && n.parent === vpc.id)));
                        innerHtml += '<div class="subnets">';
                        vpcSubnets.forEach(subnet => {
                            const subnetClass = getSubnetClass(subnet.label, subnet.type);
                            innerHtml += `
                                <div class="subnet ${subnetClass}">
                                    <span class="subnet-name">${subnet.label}</span>
                                    ${subnet.cidr ? `<div class="subnet-cidr">${subnet.cidr}</div>` : ''}
                                </div>
                            `;
                        });
                        innerHtml += '</div>';
                    } else {
                        vpcDcs.forEach(dc => {
                            const dcSubnets = subnets.filter(s => s.parent === dc.id);
                            const dcGateways = gateways.filter(g => g.parent === dc.id);

                            innerHtml += `
                                <div class="dc">
                                    <div class="dc-header">
                                        <div class="dc-icon">CDC</div>
                                        ${dc.label.replace('Cloud Data Center: ', '').replace('Data Center: ', '')}
                                    </div>
                                    <div class="subnets">
                            `;

                            dcSubnets.forEach(subnet => {
                                const subnetClass = getSubnetClass(subnet.label, subnet.type);
                                innerHtml += `
                                    <div class="subnet ${subnetClass}">
                                        <span class="subnet-name">${subnet.label.split(' (')[0]}</span>
                                        <div class="subnet-cidr">${subnet.cidr || ''}</div>
                                    </div>
                                `;
                            });

                            dcGateways.forEach(gw => {
                                innerHtml += `
                                    <div class="gateway">
                                        <div class="gateway-icon">${gw.type === 'nat' ? 'N' : 'I'}</div>
                                        ${gw.label}
                                    </div>
                                `;
                            });

                            innerHtml += '</div></div>';
                        });
                    }
                    innerHtml += '</div>'; // Close dc-container

                    // Route tables
                    const vpcRoutes = data.edges
                        .filter(e => e.source === vpc.id)
                        .map(e => {
                            const targetNode = data.nodes.find(n => n.id === e.target);
                            let targetDisplay = targetNode ? targetNode.label : e.target;
                            
                            // Add explanation for internal IDs
                            if (e.target.includes('igw-') && e.target !== 'igw-auto') {
                                targetDisplay = `Internet Gateway (${targetDisplay})`;
                            } else if (e.target.includes('vpc-dc-') || e.target.includes('standalone-dc-')) {
                                targetDisplay = `${targetDisplay} (On-Prem DC)`;
                            }
                            
                            return {
                                destination: e.destination || '0.0.0.0/0',
                                target: targetDisplay
                            };
                        });

                    innerHtml += `
                        <div class="route-tables ${currentView === 'detailed' ? 'visible' : ''}">
                            ${generateRouteTable(vpc.label, vpcRoutes)}
                        </div>
                    `;

                    innerHtml += '</div>'; // Close vpc div
                    return innerHtml;
                };

                const formatHubHtml = (hub) => {
                    const rawHubRoutes = hub.routes || [];
                    const hubRoutes = rawHubRoutes.map(r => {
                        // Attempt to find a human-readable label for the next_hop ID
                        const targetNode = data.nodes.find(n => n.id === r.next_hop || n.id === `vpc-${r.next_hop}` || n.id === `hub-${r.next_hop}`);
                        return {
                            ...r,
                            target: targetNode ? targetNode.label : r.next_hop
                        };
                    });

                    return `
                        <div class="hub" data-hub-id="${hub.id}">
                            <div class="hub-icon">H</div>
                            <div class="hub-title">${hub.label}</div>
                            <div class="subnets">
                                ${generateRouteTable(hub.label, hubRoutes)}
                            </div>
                        </div>
                    `;
                };

                const formatStandaloneDCHtml = (sdc) => {
                    const sdcDcs = dcs.filter(d => d.parent === sdc.id);

                    let innerHtml = `
                        <div class="standalone-dc" data-dc-id="${sdc.id}">
                            <div class="dc-header">
                                <div class="dc-icon">ODC</div>
                                <span class="standalone-dc-title">${sdc.label}</span>
                                <span class="standalone-dc-cidr">${sdc.cidr || ''}</span>
                            </div>
                            <div class="dc-container">
                                <div class="subnets">
                        `;

                    const dcSubnets = subnets.filter(s => s.parent === sdc.id || (data.nodes.filter(d => d.parent === sdc.id).some(d => d.id === s.parent)));
                    dcSubnets.forEach(subnet => {
                        const subnetClass = getSubnetClass(subnet.label, subnet.type);
                        innerHtml += `
                                <div class="subnet ${subnetClass}">
                                    <span class="subnet-name">${subnet.label.split(' (')[0]}</span>
                                    <div class="subnet-cidr">${subnet.cidr || ''}</div>
                                </div>
                            `;
                    });
                    innerHtml += '</div>';

                    innerHtml += '</div></div>'; // Close dc-container and standalone-dc
                    return innerHtml;
                };

                const formatConnectionsHtml = (resourceIds) => {
                    const scenarioEdges = data.edges.filter(e => resourceIds.includes(e.source) || resourceIds.includes(e.target));

                    if (scenarioEdges.length === 0) return '';

                    const connectionTypes = {
                        peering: { edges: [], title: 'VPC Peering Connections', icon: 'P', desc: 'Same-location, no gateway' },
                        vpn: { edges: [], title: 'VPN Gateway Connections', icon: 'V', desc: '' },
                        mesh: { edges: [], title: 'Mesh VPN Connections', icon: 'M', desc: '' },
                        cloud_routing_hub: { edges: [], title: 'Cloud Routing Hub Connections', icon: 'CRH', desc: '' }
                    };

                    scenarioEdges.forEach(edge => {
                        if (connectionTypes[edge.type]) {
                            connectionTypes[edge.type].edges.push(edge);
                        }
                    });

                    let connectionsHtml = '';
                    Object.keys(connectionTypes).forEach(type => {
                        const conn = connectionTypes[type];
                        if (conn.edges.length > 0) {
                            connectionsHtml += `
                                <div class="connections-section ${type}">
                                    <div class="connections-title ${type}">
                                        <div class="connection-type-icon ${type}">${conn.icon}</div>
                                        ${conn.title}
                                        ${conn.desc ? `<span style="font-weight: normal; font-size: 10px; color: #666;">(${conn.desc})</span>` : ''}
                                    </div>
                                    <div class="connections-list">
                            `;

                            conn.edges.forEach(edge => {
                                const sourceNode = data.nodes.find(n => n.id === edge.source);
                                const targetNode = data.nodes.find(n => n.id === edge.target);
                                const sourceName = sourceNode ? sourceNode.label : edge.source;
                                const targetName = targetNode ? targetNode.label : edge.target;

                                // Add explanation for internal IDs
                                let sourceExplanation = '';
                                let targetExplanation = '';
                                
                                if (edge.source.includes('vpc-dc-') || edge.source.includes('standalone-dc-')) {
                                    sourceExplanation = ' <span style="color: #666; font-size: 9px;">(ODC)</span>';
                                }
                                if (edge.target.includes('vpc-dc-') || edge.target.includes('standalone-dc-')) {
                                    targetExplanation = ' <span style="color: #666; font-size: 9px;">(ODC)</span>';
                                }

                                connectionsHtml += `
                                    <div class="connection-item ${type}">
                                        <span>${sourceName}${sourceExplanation}</span>
                                        <span class="connection-arrow ${type}"></span>
                                        <span>${targetName}${targetExplanation}</span>
                                        ${edge.destination ? `<span class="connection-destination">${edge.destination}</span>` : ''}
                                    </div>
                                `;
                            });
                            connectionsHtml += '</div></div>';
                        }
                    });
                    return connectionsHtml;
                };

                // Track global rendered IDs only to determine "Miscellaneous" content.
                // We use this to prevent nodes appearing in both Scenarios AND Miscellaneous.
                const globalRenderedIds = new Set();
                let displayCounter = 1;

                // Render Scenarios
                scenarios.forEach(scenario => {
                    const cleanScenarioTitle = getCleanTitle(scenario.title);
                    const scenarioNodes = [];

                    // 1. Find explicit resources from the scenario definition
                    if (scenario.resources) {
                        scenario.resources.forEach(res => {
                            let found = null;
                            if (res.type === 'vpc') {
                                found = vpcs.find(v => v.label === res.label);
                            } else if (res.type === 'hub') {
                                found = hubs.find(h => h.label === res.label);
                            } else if (res.type === 'standalone_dc') {
                                found = standaloneDCs.find(s => s.label === res.label);
                            }
                            // Strictly check renderedIds to prevent "count mismatch" / double rendering across scenarios
                            if (found && !globalRenderedIds.has(found.id)) {
                                scenarioNodes.push(found);
                            }
                        });
                    }

                    // 2. Find resources that claim belonging to this scenario via their 'scenario' property
                    [vpcs, hubs, standaloneDCs].forEach(collection => {
                        collection.forEach(node => {
                            if (node.scenario && getCleanTitle(node.scenario) === cleanScenarioTitle && !globalRenderedIds.has(node.id)) {
                                scenarioNodes.push(node);
                            }
                        });
                    });

                    // Deduplicate nodes for this specific scenario
                    const uniqueNodes = Array.from(new Set(scenarioNodes.map(n => n.id)))
                        .map(id => scenarioNodes.find(n => n.id === id));

                    if (uniqueNodes.length > 0) {
                        // Mark as seen globally to prevent re-rendering in later scenarios or miscellaneous
                        uniqueNodes.forEach(n => globalRenderedIds.add(n.id));
                        
                        const resourceIds = uniqueNodes.map(n => n.id);
                        
                        // Count VPCs in this scenario
                        const vpcCount = uniqueNodes.filter(n => n.type === 'vpc').length;
                        const hubCount = uniqueNodes.filter(n => n.type === 'hub').length;
                        const dcCount = uniqueNodes.filter(n => n.type === 'standalone_dc').length;
                        
                        // Update title for display to force sequential numbering
                        scenario.title = `${displayCounter}. ${cleanScenarioTitle}`;
                        
                        let scenarioHtml = '';

                        // Use automatic hub centering for all scenarios
                        const hubNodes = uniqueNodes.filter(n => n.type === 'hub');
                        const nonHubNodes = uniqueNodes.filter(n => n.type !== 'hub');
                        
                        // Auto-position hubs in the middle if there are multiple resources
                        let scenarioLayout = '';
                        if (hubNodes.length > 0 && nonHubNodes.length > 1) {
                            // Create a layout with hubs in the center
                            const leftColumn = nonHubNodes.slice(0, Math.ceil(nonHubNodes.length / 2));
                            const rightColumn = nonHubNodes.slice(Math.ceil(nonHubNodes.length / 2));
                            
                            scenarioLayout = `
                                <div class="scenario-content" style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 30px; align-items: start;">
                                    <div class="scenario-column">
                                        ${leftColumn.map(r => {
                                            if (r.type === 'vpc') return formatVpcHtml(r);
                                            if (r.type === 'standalone_dc') return formatStandaloneDCHtml(r);
                                            return '';
                                        }).join('')}
                                    </div>
                                    <div class="hub-column">
                                        ${hubNodes.map(h => formatHubHtml(h)).join('')}
                                    </div>
                                    <div class="scenario-column">
                                        ${rightColumn.map(r => {
                                            if (r.type === 'vpc') return formatVpcHtml(r);
                                            if (r.type === 'standalone_dc') return formatStandaloneDCHtml(r);
                                            return '';
                                        }).join('')}
                                    </div>
                                </div>
                            `;
                        } else {
                            // Standard linear layout
                            scenarioLayout = `
                                <div class="scenario-content">
                                    ${uniqueNodes.map(r => {
                                        if (r.type === 'vpc') return formatVpcHtml(r);
                                        if (r.type === 'hub') return formatHubHtml(r);
                                        if (r.type === 'standalone_dc') return formatStandaloneDCHtml(r);
                                        return '';
                                    }).join('')}
                                </div>
                            `;
                        }
                        
                        scenarioHtml = `
                            <div class="scenario-group">
                                <div class="scenario-title">${scenario.title} <span style="font-size: 11px; color: #666; font-weight: normal;">(${vpcCount} VPC${vpcCount !== 1 ? 's' : ''}${hubCount > 0 ? `, ${hubCount} CRH${hubCount !== 1 ? 's' : ''}` : ''}${dcCount > 0 ? `, ${dcCount} ODC${dcCount !== 1 ? 's' : ''}` : ''})</span></div>
                                <div class="scenario-desc">${scenario.description}</div>
                                <div class="scenario-connections">
                                    ${formatConnectionsHtml(resourceIds)}
                                </div>
                                ${scenarioLayout}
                            </div>
                        `;
                        
                        if (scenarioHtml) {
                            html += scenarioHtml;
                            displayCounter++;
                        }
                    }
                });

                // Render Unassigned VPCs/Hubs (not in any scenario)
                const unassignedVpcs = vpcs.filter(v => !globalRenderedIds.has(v.id));
                const unassignedHubs = hubs.filter(h => !globalRenderedIds.has(h.id));
                const unassignedDCs = standaloneDCs.filter(d => !globalRenderedIds.has(d.id));

                if (unassignedVpcs.length > 0 || unassignedHubs.length > 0 || unassignedDCs.length > 0) {
                    const unassignedIds = [...unassignedVpcs.map(v => v.id), ...unassignedHubs.map(h => h.id), ...unassignedDCs.map(d => d.id)];
                    const vpcCount = unassignedVpcs.length;
                    const hubCount = unassignedHubs.length;
                    const dcCount = unassignedDCs.length;
                    
                    html += `
                        <div class="scenario-group">
                            <div class="scenario-title">Miscellaneous <span style="font-size: 11px; color: #666; font-weight: normal;">(${vpcCount} VPC${vpcCount !== 1 ? 's' : ''}${hubCount > 0 ? `, ${hubCount} CRH${hubCount !== 1 ? 's' : ''}` : ''}${dcCount > 0 ? `, ${dcCount} ODC${dcCount !== 1 ? 's' : ''}` : ''})</span></div>
                            <div class="scenario-connections">
                                    ${formatConnectionsHtml(unassignedIds)}
                            </div>
                             <div class="scenario-content">
                                ${unassignedHubs.map(h => formatHubHtml(h)).join('')}
                                ${unassignedVpcs.map(v => formatVpcHtml(v)).join('')}
                                ${unassignedDCs.map(d => formatStandaloneDCHtml(d)).join('')}
                            </div>
                        </div>
                    `;
                }

                document.getElementById('content').innerHTML = html;


                const statusLabel = window.STATIC_VPC_DATA ? 'Static Reference Mode | ' : 'Last updated: ' + new Date().toLocaleTimeString() + ' | ';
                document.getElementById('status').innerText = statusLabel + 'VPCs: ' + vpcs.length + ' | Subnets: ' + subnets.length;

                // Draw arrows after DOM is updated
                setTimeout(() => drawPropagationArrows(vpcs, standaloneDCs, hubs), 500);

            } catch (err) {
                console.error(err);
                document.getElementById('content').innerHTML = '<p style="color: #c62828;">Error loading data: ' + err.message + '</p>';
                document.getElementById('status').innerText = 'Error: ' + err.message;
            }
        }

        function drawPropagationArrows(vpcs, standaloneDCs, hubs) {
            const svg = document.getElementById('svg-connections');
            // Ensure the SVG covers the full scrollable area, not just the viewport
            const mainContainer = document.querySelector('.main-container');
            if (mainContainer) {
                 svg.style.height = mainContainer.scrollHeight + 'px';
            }

            // Clear existing propagation arrows
            const existingExtras = svg.querySelectorAll('.propagation-arrow, .propagation-label');
            existingExtras.forEach(e => e.remove());

            const hubNat = hubs.find(h => h.label.includes('NAT Flows'));
            const hubInternal = hubs.find(h => h.label.includes('Non-NAT Flows'));
            if (!hubNat || !hubInternal) return;

            const draw = (entityId, hubId, offsetIndex, side, isStandaloneDC = false) => {
                const selector = isStandaloneDC ? `[data-dc-id="${entityId}"]` : `[data-vpc-id="${entityId}"]`;
                const entity = document.querySelector(selector);
                const hub = document.querySelector(`[data-hub-id="${hubId}"]`);
                if (!entity || !hub) return;

                const eRect = entity.getBoundingClientRect();
                const hRect = hub.getBoundingClientRect();
                const sRect = svg.getBoundingClientRect();

                // Vertical offset to prevent overlapping paths
                const verticalOffset = (offsetIndex - 1.5) * 12;

                let x1, y1, x2, y2;
                if (side === 'left') {
                    x1 = eRect.right - sRect.left;
                    // Adjust Y based on scroll because bounding client rect is viewport relative
                    // But our SVG is absolute positioned at top:0
                    y1 = eRect.top + eRect.height / 2 - sRect.top + verticalOffset; 
                    x2 = hRect.left - sRect.left;
                    y2 = hRect.top + hRect.height / 2 - sRect.top + verticalOffset;
                } else {
                    x1 = eRect.left - sRect.left;
                    y1 = eRect.top + eRect.height / 2 - sRect.top + verticalOffset;
                    x2 = hRect.right - sRect.left;
                    y2 = hRect.top + hRect.height / 2 - sRect.top + verticalOffset;
                }

                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                // Use a slight curve for better visual separation
                const midX = (x1 + x2) / 2;
                path.setAttribute("d", `M ${x1} ${y1} Q ${midX} ${y1} ${x2} ${y2}`);
                path.setAttribute("class", "propagation-arrow");
                svg.appendChild(path);
            };

            const addHubLabel = (hubId, side) => {
                const hub = document.querySelector(`[data-hub-id="${hubId}"]`);
                if (!hub) return;

                const hRect = hub.getBoundingClientRect();
                const sRect = svg.getBoundingClientRect();

                const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                const labelX = side === 'left' ? hRect.left - sRect.left - 60 : hRect.right - sRect.left + 60;
                const labelY = hRect.top + hRect.height / 2 - sRect.top;
                text.setAttribute("x", labelX);
                text.setAttribute("y", labelY);
                text.setAttribute("class", "propagation-label");
                text.setAttribute("text-anchor", "middle");
                text.textContent = "Propagations";
                svg.appendChild(text);
            };

            // Identify VPCs by column/role
            const col1Vpcs = vpcs.filter(v => v.label.includes('Cluster 1') || v.label.includes('Cluster 2'));
            const col3Vpcs = vpcs.filter(v => v.label.includes('Shared Services'));
            const col3StandaloneDCs = standaloneDCs.filter(s => s.label.includes('On-Premise Data Center'));

            // Draw from Column 1 (Left)
            col1Vpcs.forEach((vpc, idx) => {
                draw(vpc.id, hubNat.id, idx, 'left', false);
                draw(vpc.id, hubInternal.id, idx + 2, 'left', false);
            });

            // Draw from Column 3 (Right) - VPCs
            col3Vpcs.forEach((vpc, idx) => {
                draw(vpc.id, hubNat.id, idx, 'right', false);
                draw(vpc.id, hubInternal.id, idx + 2, 'right', false);
            });

            // Draw from Column 3 (Right) - Standalone DCs
            col3StandaloneDCs.forEach((sdc, idx) => {
                const offset = col3Vpcs.length + idx; // Offset after VPCs
                draw(sdc.id, hubNat.id, offset, 'right', true);
                draw(sdc.id, hubInternal.id, offset + 2, 'right', true);
            });

            // Add single label per hub
            if (col1Vpcs.length > 0) {
                addHubLabel(hubNat.id, 'left');
                addHubLabel(hubInternal.id, 'left');
            }
            if (col3Vpcs.length > 0 || col3StandaloneDCs.length > 0) {
                addHubLabel(hubNat.id, 'right');
                addHubLabel(hubInternal.id, 'right');
            }
        }

        // Load on start
        loadData();
        // Auto-refresh every 15 seconds
        setInterval(loadData, 15000);

        // API Guide functionality
        function toggleApiGuide() {
            const modal = document.getElementById('api-guide-modal');
            if (modal.style.display === 'block') {
                modal.style.display = 'none';
            } else {
                modal.style.display = 'block';
            }
        }

        // Tab switching functionality
        function showTab(tabName) {
            // Hide all content divs
            const contents = ['api-guide', 'architecture', 'vpc-details', 'examples', 'testing', 'api-examples'];
            contents.forEach(content => {
                const contentDiv = document.getElementById(`content-${content}`);
                if (contentDiv) {
                    contentDiv.style.display = 'none';
                }
            });
            
            // Remove active state from all tabs
            contents.forEach(content => {
                const tabButton = document.getElementById(`tab-${content}`);
                if (tabButton) {
                    tabButton.style.borderBottom = 'none';
                }
            });
            
            // Show selected content and activate tab
            const selectedContent = document.getElementById(`content-${tabName}`);
            const selectedTab = document.getElementById(`tab-${tabName}`);
            if (selectedContent) {
                selectedContent.style.display = 'block';
            }
            if (selectedTab) {
                selectedTab.style.borderBottom = '2px solid #00897b';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('api-guide-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
<!-- API Guide Modal -->
<div id="api-guide-modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
<div style="background-color: white; margin: 5% auto; padding: 20px; border-radius: 8px; width: 90%; max-width: 1200px; max-height: 80vh; overflow-y: auto;">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
<h2> Documentation Hub</h2>
<button onclick="toggleApiGuide()" style="background: none; border: none; font-size: 24px; cursor: pointer;"></button>
</div>
<!-- Navigation Tabs -->
<div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #f0f0f0;">
<button id="tab-api-guide" onclick="showTab('api-guide')" style="background: none; border: none; padding: 10px; cursor: pointer; border-bottom: 2px solid #00897b;"> API Guide</button>
<button id="tab-architecture" onclick="showTab('architecture')" style="background: none; border: none; padding: 10px; cursor: pointer;"> Architecture</button>
<button id="tab-vpc-details" onclick="showTab('vpc-details')" style="background: none; border: none; padding: 10px; cursor: pointer;"> VPC Details</button>
<button id="tab-examples" onclick="showTab('examples')" style="background: none; border: none; padding: 10px; cursor: pointer;"> Examples</button>
<button id="tab-testing" onclick="showTab('testing')" style="background: none; border: none; padding: 10px; cursor: pointer;"> Testing</button>
<button onclick="window.open('https://cloud-networking-control-plane-simulator.vercel.app/redoc', '_blank')" style="background: none; border: none; padding: 10px; cursor: pointer; text-decoration: none; color: inherit;"> ReDoc</button>
<button onclick="window.open('https://cloud-networking-control-plane-simulator.vercel.app/docs', '_blank')" style="background: none; border: none; padding: 10px; cursor: pointer; text-decoration: none; color: inherit;"> Docs</button>
<button id="tab-api-examples" onclick="showTab('api-examples')" style="background: none; border: none; padding: 10px; cursor: pointer;"> API Examples</button><button id="tab-ideas" onclick="showTab('ideas')" style="background: none; border: none; padding: 10px; cursor: pointer;"> Ideas</button><button id="tab-implementation" onclick="showTab('implementation')" style="background: none; border: none; padding: 10px; cursor: pointer;"> Implementation</button></div>
<!-- API Guide Tab -->
<div id="content-api-guide" style="display: block;">
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
<!-- REST API Section -->
<div>
<h3> REST API (v1)</h3>
<p>All endpoints return JSON responses. Use <code>Content-Type: application/json</code> for all POST requests.</p>
<h4>Interface Overview</h4>
<table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
<tr style="background: #f5f5f5;">
<th style="border: 1px solid #ddd; padding: 8px;">Interface</th>
<th style="border: 1px solid #ddd; padding: 8px;">Port</th>
<th style="border: 1px solid #ddd; padding: 8px;">Purpose</th>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">REST</td>
<td style="border: 1px solid #ddd; padding: 8px;">8000</td>
<td style="border: 1px solid #ddd; padding: 8px;">CRUD Operations</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">gRPC</td>
<td style="border: 1px solid #ddd; padding: 8px;">50051</td>
<td style="border: 1px solid #ddd; padding: 8px;">Performance &amp; Telemetry</td>
</tr>
</table>
<h4>Common Operations</h4>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
<strong>List VPCs:</strong><br/>
<code>curl -X GET /vpcs</code>
</div>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
<strong>Create VPC:</strong><br/>
<code>curl -X POST /vpcs -d '{"name": "my-vpc", "cidr": "10.0.0.0/16"}'</code>
</div>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
<strong>Delete VPC:</strong><br/>
<code>curl -X DELETE /vpcs/vpc-001</code>
</div>
</div>
<!-- gRPC Section -->
<div>
<h3> gRPC API</h3>
<p>High-performance access to network state with real-time streaming capabilities.</p>
<h4>Implementation Status</h4>
<table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
<tr style="background: #f5f5f5;">
<th style="border: 1px solid #ddd; padding: 8px;">Method</th>
<th style="border: 1px solid #ddd; padding: 8px;">Type</th>
<th style="border: 1px solid #ddd; padding: 8px;">Status</th>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">ListVPCs</td>
<td style="border: 1px solid #ddd; padding: 8px;">Unary</td>
<td style="border: 1px solid #ddd; padding: 8px;"> Implemented</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">CreateVPC</td>
<td style="border: 1px solid #ddd; padding: 8px;">Unary</td>
<td style="border: 1px solid #ddd; padding: 8px;"> Implemented</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">WatchNetworkEvents</td>
<td style="border: 1px solid #ddd; padding: 8px;">Stream</td>
<td style="border: 1px solid #ddd; padding: 8px;"> Read-Only</td>
</tr>
</table>
<h4>Example Usage</h4>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
<strong>List VPCs (grpcurl):</strong><br/>
<code>grpcurl -plaintext -d '{"limit": 10}' localhost:50051 network.NetworkService/ListVPCs</code>
</div>
</div>
</div>
<div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 4px;">
<h4> Interactive Documentation</h4>
<ul style="margin: 0; padding-left: 20px;">
<li><strong>Swagger UI:</strong> <a href="/docs" target="_blank">Interactive API explorer with "Try it out"</a></li>
<li><strong>ReDoc:</strong> <a href="/redoc" target="_blank">Clean, readable API reference</a></li>
<li><strong>Protocol Buffers:</strong> <a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/control-plane/proto/cloud_networking_control_plane_simulator.proto" target="_blank">gRPC service definition</a></li>
</ul>
</div>
<div style="margin-top: 20px; padding: 15px; background: #fff3e0; border-radius: 4px;">
<h4> Important Notes</h4>
<ul style="margin: 0; padding-left: 20px;">
<li>Resource IDs are dynamically generated - always GET list before DELETE</li>
<li>Use standard HTTP status codes for error handling</li>
<li>Ports configurable via REST_PORT and GRPC_PORT environment variables</li>
</ul>
</div>

<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<!-- Divider between original content and API.md -->
<div style="margin: 30px 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px; border-left: 4px solid #2196f3;">
<h3 style="margin: 0 0 10px 0; color: #1976d2;"> Complete API Documentation</h3>
<p style="margin: 0; color: #555;">Full API reference and documentation from docs/API.md</p>
</div>
<div class="markdown-content">
<div id="markdown-content-API-md" style="display: none;"># API Documentation

The control plane provides a dual-interface architecture for managing the Cloud Networking Control Plane Simulator. For example, it allows users to use standard REST for intent declaration and high-performance gRPC for state inspection and telemetry.

## Interface Overview

| Interface | Default Port | Primary Purpose | Interactive Docs |
|-----------|--------------|-----------------|------------------|
| **REST**  | `8000`       | Intent Declaration (CRUD) | http://localhost:8000/redoc (ReDoc) |
|||| http://localhost:8000/docs (OpenAPI / Swagger)
| **gRPC**  | `50051`      | Performance &amp; Telemetry | [cloud_networking_control_plane_simulator.proto](../control-plane/proto/cloud_networking_control_plane_simulator.proto) |

&gt; [!NOTE]
&gt; **Configurability**: Default ports are defined in `control-plane/main.py`. These can be overridden via environment variables `REST_PORT` and `GRPC_PORT` when starting the service.

## Resource Hierarchy

The simulator follows a standard cloud resource hierarchy:

```mermaid
graph TD
    VPC["VPC (Network Isolation)"] --&gt; Subnet["Subnet (L3 Segment)"]
    VPC --&gt; Route["Route (Traffic Flow)"]
    VPC --&gt; IGW["Internet Gateway (Public Access)"]
    VPC --&gt; NAT["NAT Gateway (Outbound Only)"]
    Subnet --&gt; SG["Security Group (Stateful Firewall)"]
```

---

## REST API (v1)

All endpoints return JSON responses. Use `Content-Type: application/json` for all `POST` requests.

### Identification &amp; Deletion
&gt; [!IMPORTANT]
&gt; Resource IDs (e.g., `vpc-001`, `subnet-001`) are dynamically generated. Always perform a `GET` list operation to retrieve the correct ID before attempting a `DELETE` or specific `GET` request.

### 1. VPCs (Virtual Private Clouds)

**List VPCs**
```bash
curl -s -X GET http://localhost:8000/vpcs | jq
```

**Create VPC**
```bash
curl -s -X POST http://localhost:8000/vpcs \
  -H "Content-Type: application/json" \
  -d '{
    "name": "production-vpc",
    "cidr": "10.100.0.0/16",
    "region": "us-east-1"
  }'
```

**Get VPC**
```bash
curl -s -X GET http://localhost:8000/vpcs/vpc-001
```

**Delete VPC**
```bash
curl -s -X DELETE http://localhost:8000/vpcs/vpc-001
```

### 2. Subnets

**List Subnets in VPC**
```bash
curl -s -X GET http://localhost:8000/vpcs/vpc-001/subnets
```

**Create Subnet**
```bash
curl -s -X POST http://localhost:8000/vpcs/vpc-001/subnets \
  -H "Content-Type: application/json" \
  -d '{
    "name": "public-subnet-1a",
    "cidr": "10.100.1.0/24",
    "availability_zone": "us-east-1a"
  }'
```

**Delete Subnet**
```bash
curl -s -X DELETE http://localhost:8000/subnets/subnet-001
```

### 3. Routes

**List Routes in VPC**
```bash
curl -s -X GET http://localhost:8000/vpcs/vpc-001/routes
```

**Create Route**
```bash
curl -s -X POST http://localhost:8000/vpcs/vpc-001/routes \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "0.0.0.0/0",
    "next_hop": "igw-001",
    "next_hop_type": "gateway"
  }'
```

**Delete Route**
```bash
curl -s -X DELETE http://localhost:8000/routes/rtb-001
```

### 4. Gateways

**Create Internet Gateway**
```bash
curl -s -X POST http://localhost:8000/vpcs/vpc-001/internet-gateways
```

**Create NAT Gateway**
```bash
curl -s -X POST http://localhost:8000/vpcs/vpc-001/nat-gateways \
  -H "Content-Type: application/json" \
  -d '{
    "subnet_id": "subnet-001"
  }'
```

### 5. Security Groups

**Create Security Group**
```bash
curl -s -X POST http://localhost:8000/security-groups \
  -H "Content-Type: application/json" \
  -d '{
    "name": "web-tier",
    "description": "Allow HTTP/HTTPS inbound",
    "rules": [
      {
        "direction": "ingress", 
        "protocol": "tcp", 
        "port_from": 80, 
        "port_to": 80, 
        "cidr": "0.0.0.0/0"
      },
      {
        "direction": "ingress", 
        "protocol": "tcp", 
        "port_from": 443, 
        "port_to": 443, 
        "cidr": "0.0.0.0/0"
      }
    ]
  }'
```

**Attach Security Group to Instance**
```bash
curl -s -X POST "http://localhost:8000/security-groups/sg-001/attach?instance_id=10.1.1.10"
```

---

## gRPC API

The gRPC interface provides high-performance access to the network state. The service definition is located at `control-plane/proto/cloud_networking_control_plane_simulator.proto`.

### Implementation Status

| Service Method | Type | Status | Note |
|----------------|------|--------|------|
| `ListVPCs` | Unary | **Implemented** | Optimized for bulk reads |
| `CreateVPC` | Unary | **Implemented** | Seamless background provisioning |
| `WatchNetworkEvents` | Stream | **Read-Only** | Real-time event subscription |
| `Full CRUD` | Unary | **Implemented** | Parity for Subnets, Routes, SGs, etc. |

### Example: List VPCs

**Request:** `ListVPCsRequest`
```json
{
  "limit": 100,
  "offset": 0
}
```

**Sample Usage (grpcurl):**
```bash
grpcurl -plaintext -d '{"limit": 10}' localhost:50051 network.NetworkService/ListVPCs
```

&gt; [!TIP]
&gt; Refer to the [cloud_networking_control_plane_simulator.proto](../control-plane/proto/cloud_networking_control_plane_simulator.proto) file for the full list of request/response messages and error codes.

---

## Error Handling

The API uses standard HTTP status codes for errors.

**Sample 404 Error (Resource Not Found):**
```json
{
  "detail": "VPC not found"
}
```

**Common Codes:**
- `200 OK`: Success (GET/LIST)
- `201 Created`: Success (POST)
- `400 Bad Request`: Validation failure
- `404 Not Found`: Resource ID does not exist
- `500 Internal Server Error`: Unexpected simulator failure

## Interactive Documentation

FastAPI automatically generates comprehensive interactive documentation. For a full list of schemas and to test endpoints within the browser, visit:

| UI | URL | Description |
|----|-----|-------------|
| **Swagger UI** | [http://localhost:8000/docs](http://localhost:8000/docs) | Interactive API explorer with "Try it out" functionality |
| **ReDoc** | [http://localhost:8000/redoc](http://localhost:8000/redoc) | Clean, readable API reference documentation |
</div>
<div id="rendered-content-API-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for API.md
                const markdownContentAPI-md = document.getElementById('markdown-content-API-md').textContent;
                const renderedContentAPI-md = marked.parse(markdownContentAPI-md);
                document.getElementById('rendered-content-API-md').innerHTML = renderedContentAPI-md;
            </script>
</div>
<!-- Architecture Tab -->
<div id="content-architecture" style="display: none;">
<h3> System Architecture</h3>
<p>The simulator provides a conceptual exploration of cloud networking internals using Linux networking primitives.</p>
<h4>Core Concepts</h4>
<div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Physical Fabric:</strong> Docker-based network providing basic reachability between Spines, Leafs, and Control Plane.<br/><br/>
<strong>Logical Overlay:</strong> VXLAN-EVPN overlay built on top using BGP EVPN for VPC isolation and routing.<br/><br/>
<strong>Cloud Routing Hub:</strong> Centralized routing aggregation point for hub-and-spoke architectures.
                </div>
<h4>Implementation Status</h4>
<table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
<tr style="background: #f5f5f5;">
<th style="border: 1px solid #ddd; padding: 8px;">Feature</th>
<th style="border: 1px solid #ddd; padding: 8px;">Control Plane</th>
<th style="border: 1px solid #ddd; padding: 8px;">Data Plane</th>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">EVPN-VXLAN</td>
<td style="border: 1px solid #ddd; padding: 8px;"> FRR</td>
<td style="border: 1px solid #ddd; padding: 8px;"> Linux Kernel</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">VRFs</td>
<td style="border: 1px solid #ddd; padding: 8px;"> Simulated</td>
<td style="border: 1px solid #ddd; padding: 8px;"> iptables Fallback</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">VTEPs</td>
<td style="border: 1px solid #ddd; padding: 8px;"> FRR</td>
<td style="border: 1px solid #ddd; padding: 8px;"> VXLAN Interfaces</td>
</tr>
</table>
<h4>Intent-Driven Orchestration</h4>
<div style="background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Reconciliation Loop:</strong><br/>
                    1. <strong>Fetch:</strong> Query SQLite database for desired state<br/>
                    2. <strong>Discover:</strong> Inspect leaf switches using <code>ip link</code><br/>
                    3. <strong>Diff:</strong> Compute differences between intended and actual<br/>
                    4. <strong>Action:</strong> Execute system commands to converge state
                </div>
<div style="margin-top: 20px; padding: 15px; background: #f0f4c3; border-radius: 4px;">
<h4> Related Documentation</h4>
<ul style="margin: 0; padding-left: 20px;">
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/ARCHITECTURE.md" target="_blank"> Full Architecture Details</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/NETWORKING_IMPLEMENTATION.md" target="_blank"> Networking Implementation</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/IDEAS.md" target="_blank"> Design Ideas &amp; Extensions</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/README.md" target="_blank"> Project README</a></li>
</ul>
</div>

<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<!-- Divider between original content and ARCHITECTURE.md -->
<div style="margin: 30px 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px; border-left: 4px solid #2196f3;">
<h3 style="margin: 0 0 10px 0; color: #1976d2;"> Detailed Architecture Documentation</h3>
<p style="margin: 0; color: #555;">Comprehensive architecture documentation from docs/ARCHITECTURE.md</p>
</div>
<div class="markdown-content">
<div id="markdown-content-ARCHITECTURE-md" style="display: none;"># Architecture Details: Cloud Networking Control Plane Simulator

This document provides a deep dive into the architectural components, data flows, and infrastructure mapping of the Cloud Networking Control Plane Simulator.

## Core Concepts &amp; Terminology

Before diving into the technical details, it is important to distinguish between the two primary networking layers. This simulator relies on **FRRouting (FRR) containers** for BGP EVPN functionality to achieve full overlay behavior.

*   **Physical Fabric (Fabric)**: The underlying Docker-based network that provides basic reachability between nodes (Spines, Leafs, and Control Plane). This mirrors a physical data center leaf-spine topology.
*   **Logical Overlay (VXLAN-EVPN Overlay Plane)**: The virtualized network built on top of the Fabric using **VXLAN** and **BGP EVPN**. These terms are synonymous in this documentation. This layer provides VPC isolation, Layer-2 extension across leafs, and Layer-3 routing between subnets.
*   **Cloud Routing Hub**: A centralized routing aggregation point that enables transitive routing between multiple VPCs (Hub-and-Spoke). It acts as the "glue" for complex enterprise topologies, facilitating secure east-west traffic inspection and global reachability.

## System Architecture

The following diagram illustrates the logical overlay and its relationship with the Physical Fabric and control plane.

&gt; [!NOTE]
&gt; Diagrams are simplified for clarity. This simulator focuses on **Control Plane correctness** and **Intent reconciliation**. High-throughput data plane behavior is secondary to functional correctness and protocol stability.
&gt;
&gt; **Platform Compatibility**: Native Linux VRFs are used where supported. On platforms without native VRF kernel modulessuch as **Apple Silicon (M1-M4) via Docker Desktop**the simulator automatically falls back to **`iptables`** for logical isolation.

```text
        
                               LOGICAL OVERLAY                         
            
              vpc-100          vpc-200           Internet        
          VNI: 100         VNI: 200         CIDR: 203.0.113.0/24 
          VRF: vpc-100     VRF: vpc-200     (Simulated WAN)      
          CIDR: 10.1/16    CIDR: 10.2/16    
                                  
        
                                                          
                       
              VXLAN-EVPN Overlay Plane            Internet-GW   
              - EVPN Type-2: MAC/IP               (NAT/Router)  
              - EVPN Type-5: L3 routes           
              - Synchronizes VRFs &amp;                      
                VNIs across leafs                
                         NAT-Gateway  
                                                    (SNAT/DNAT)  
                     
                                                         
                                                         
                                 
         Spine-1    Spine-2            
        (Fabric)                   (Fabric)            
                                 
                                                         
                                                         
                           
       Leaf-1                     Leaf-2               
       ASN: 65011                 ASN: 65012           
       VNI: 100/200               VNI: 100/200         
       VRF: vpc-100               VRF: vpc-100         
                           
                                                         
                                                         
                           
      Server-1                   Server-2              
      (VPC-100)                  (VPC-100)             
      10.1.1.10                  10.1.2.10             
                           
                                                          
                                           
      Load-Balancer &lt;
      (VPC-100)    
     
```

This diagram is describing a VXLAN EVPN based data center network and how multiple isolated virtual networks reach each other and the internet.

Here is the meaning, top to bottom, left to right.

At the top, Logical Overlay means this is not physical wiring. It is virtual networking built on top of the physical fabric.

vpc-100 and vpc-200 are separate virtual networks. Each one has:

A VNI, VXLAN Network Identifier. This is the VXLAN equivalent of a VLAN, but at much larger scale.

A VRF, Virtual Routing and Forwarding instance. This keeps routing tables isolated so vpc-100 and vpc-200 cannot see each other unless explicitly connected.

A CIDR block. 10.1.0.0/16 for vpc-100 and 10.2.0.0/16 for vpc-200. These are private IP ranges used inside each virtual network.

The Internet box with 203.0.113.0/24 represents an external network. 203.0.113.0/24 is a documentation-only prefix reserved for examples, not real internet space. That signals this is a simulated WAN, not production addressing. This prefix is defined in RFC 5737.

The VXLAN EVPN Overlay Plane is the control plane. It distributes reachability information between switches:

EVPN Type 2 routes advertise MAC and IP bindings. This lets hosts move and still be reachable.

EVPN Type 5 routes advertise pure Layer 3 prefixes. This is used for routing between VRFs or toward external networks.

Synchronizing VRFs and VNIs across leafs means every leaf switch learns the same virtual network state.

The Internet-GW and NAT-Gateway represent the exit point from the private overlays to the external network. NAT is doing SNAT and possibly DNAT so private 10.x addresses can communicate with public or simulated public addresses. NAT behavior is defined in RFC 3022.

Spine-1 and Spine-2 are the physical fabric core. They do not host endpoints. They provide high bandwidth IP forwarding between leaf switches. The bidirectional arrows mean ECMP and redundant paths.

Leaf-1 and Leaf-2 are where VXLAN encapsulation and decapsulation happen. Each leaf:

Participates in BGP EVPN.

Hosts VNIs 100 and 200.

Maintains VRFs for the virtual networks.

Has its own ASN, indicating eBGP is used inside the fabric, a common design for fast convergence.

Servers attach to the leaf switches. Server-1 and Server-2 are both in vpc-100 but on different subnets. Because EVPN distributes MAC and IP reachability, they can communicate as if they were on the same logical network even though they are on different physical switches.

The load balancer is also inside vpc-100. The arrow from the NAT-Gateway to the load balancer indicates inbound traffic from the external network can be translated and forwarded to services inside the VPC.

In short, this diagram means:

You have a spine leaf fabric.

VXLAN provides Layer 2 and Layer 3 overlays.

EVPN with BGP is the control plane.

VRFs isolate tenants or VPCs.

NAT provides controlled access to an external network.

All of this runs over a simple IP routed physical network.

Key standards behind this design include RFC 7348 for VXLAN, RFC 7432 and RFC 8365 for EVPN, RFC 4364 for VRFs, and RFC 3022 for NAT.

---

**Q:** Does it make sense?

**A:** Yes, it makes sense, but it is not perfect and a few things are either ambiguous or slightly misleading.

What is correct:

The overall architecture is coherent. A spine leaf fabric with VXLAN EVPN overlays, VRF based tenant isolation, and a centralized or shared NAT gateway for internet access is a standard and valid design. Using EVPN Type 2 for MAC and IP learning and Type 5 for Layer 3 prefixes is correct and aligns with RFC 7432 and RFC 8365. Using separate ASNs on leafs and running eBGP in the fabric is also a common and sound practice.

The use of 203.0.113.0/24 to represent the internet is correct for documentation and explicitly non routable, as defined in RFC 5737.

Where it becomes unclear or weak:

First, the placement of the Internet-GW and NAT-Gateway is ambiguous. In real VXLAN EVPN designs, NAT is usually implemented on a border leaf or service leaf, not as a floating logical box disconnected from the fabric. The diagram suggests the NAT gateway is outside the EVPN domain but still tightly integrated, which is not explained.

Second, the relationship between EVPN Type 5 routes and NAT is not shown clearly. Typically, the default route 0.0.0.0/0 is leaked into tenant VRFs via EVPN Type 5 from the border leaf. That mechanism is not depicted, so the control plane path to the internet is implied rather than shown.

Third, Leaf-1 and Leaf-2 list only VRF vpc-100, yet earlier the diagram claims both VNIs 100 and 200 are present on the leafs. If vpc-200 exists, its VRF should be explicitly shown on the leafs as well, or else it looks like a partial or inconsistent configuration.

Fourth, the load balancer arrow from the NAT-Gateway implies inbound connectivity, but no DNAT, VIP, or route advertisement mechanism is shown. Without EVPN Type 5 prefix injection or service chaining details, this part is conceptually correct but operationally underspecified.

Fifth, spines are shown as participating in bidirectional links with VXLAN semantics. In most designs, spines are pure IP transit and are unaware of VXLAN and EVPN beyond BGP underlay reachability. The diagram does not say this explicitly, which could confuse readers.

Bottom line:

Conceptually, yes, it makes sense and describes a valid VXLAN EVPN architecture. Technically, it is a high level logical diagram, not an implementation diagram. If this were documentation for engineers, it would need clarification around border leaf roles, default route propagation, NAT placement, and consistent VRF representation.

This aligns with standard data center designs described in RFC 8365 and common vendor reference architectures from Cisco, Arista, and Juniper.

## Data Flows

### Inbound Traffic Traversal (Internet to VPC)

This diagram shows how a request at `localhost:8080` traverses the simulated layers to reach a VPC server.

```text
[ User ]  [ Port 8080 ]  [ Load-Balancer ]  [ Fabric (VXLAN) ]  [ Server-1 ]
                                                                            
             Host IP            LB Container        (Decapsulation)         VPC Subnet
          (203.0.113.1)         (10.0.0.100)           (at Leaf)           (10.1.1.10)
```

### Outbound Traffic Traversal (VPC to Internet)

For outbound traffic, the server routes through the Leaf, which performs VTEP encapsulation or local routing, eventually passing through the NAT Gateway.

```text
[ Server-1 ]  [ Leaf-1 ]  [ NAT-Gateway ]  [ Internet-GW ]  [ Internet ]
                                                                       
  VPC Subnet     (Encap)        (SNAT Logic)          Public IP          External
 (10.1.1.10)   (VNI 100)      (NAT Container)      (203.0.113.50)        (WAN)
```

## Docker Infrastructure Map

This section maps the architectural concepts above to the physical Docker resources. Note that `Leaf-X` and `Spine-X` are single-instance containers for simulator purposes; high-availability redundancy is not modeled. Additionally, VRF/VNI mapping is logical and depends on the host kernel's capability.

### Container Naming Policy
Standard Docker Compose naming: `[project]-[service]-[replica]`
*   Example: `cloud-networking-control-plane-simulator-control-plane-1`

### Network Mesh Layout
Docker uses **Underscores** for network namespaces and **Hyphens** for container hostnames.

```text
                                NETWORK INFRASTRUCTURE (Docker)
        
                        EXTERNAL NETWORK: cloud-networking-control-plane-simulator_internet        
                                 (Docker Bridge: 203.0.113.0/24)                                   
        
                                        
        
                        FABRIC NETWORK: cloud-networking-control-plane-simulator_fabric            
                                 (Docker Bridge: 10.0.0.0/24)                                      
        
                                                                                      
                
     Spine-X    Leaf-X    Control    Firewall    NAT-GW    Internet-GW    Load-Balancer
                
                     
          
                VPC ACCESS NETWORKS       
          
           ..._vpc-100-leaf-1             
           ..._vpc-200-leaf-1             
          
                                    
              
                 Server-1      Server-4   
                 (VPC-100)     (VPC-200)  
              
```

## Control Plane Internals

The Control Plane manages the entire life cycle of the simulated network.

### Reconciliation Lifecycle (Closed Loop)

The Reconciliation Engine implements a periodic, "Closed Loop" orchestration cycle to ensure the system converges on the desired state. This cycle is **idempotent**, meaning it can safely re-run without side effects.

```text
               
    Intent Store  Diff Engine  
         (Desired)            (Comparison)    
                  
                                                
                                
                               Observation    Enforcement  
                (Heartbeat)  (Healing)    
                                 
```

#### Orchestration Steps
1. **Fetch**: Queries the SQLite `Intent Store` for the desired network state (VPCs, VNIs, Subnets).
2. **Discover**: Inspects the running environment (leaf switches) using `ip link`, `ip addr`, and `iptables-save` to determine the actual state.
3. **Diff**: Computes the specific delta between intended and actual resource states.
4. **Action**: Executes enforcement commands (`ip link add`, `iptables -A`, etc.) to reconcile the differences.

#### Core Principle: Idempotency
All reconciliation operations are designed to be **idempotent**. The system can safely re-run the same "Action" commands multiple times without side effects, ensuring that any transient failures or manual drifts are automatically corrected in the next cycle.

### Component Architecture

```text
                                        
                                           User / CI/CD   
                                        
                                                   (REST/gRPC)
                                                  

                          CONTROL PLANE (Python)                           
                                                                           
                
     API Server        Intent Store      Reconciler      
   (FastAPI / gRPC)        (SQLite / State)        (Diff Engine)     
                
                                                                          
           
                                                                         
                                                                         
                                     
   Netlink Manager                                   Config Generator  
   (pyroute2)                                        (Jinja2)          
                                     
                                                                         
            (Netlink/IP)                                       (SSH/ZTP) 
                                                                         
                                          
     Local Kernel                                     Remote Switch    
     (Namespaces)                                     (FRRouting)      
                                          

                                                               
      [ pyroute2 handles ]                              [ BGP Peering handled ]
      [ local netns/links]                              [ by FRR externally   ]
```

### Logical Isolation vs. Native Enforcement

A key architectural feature is the **Graceful Fallback** for VPC isolation:
*   **Target**: The reconciler attempts to use native Linux `vrf` devices for L3 isolation.
*   **Detection**: If the kernel returns `RTNETLINK answers: Not supported` (common on Apple Silicon hosts), the reconciler detects this missing capability.
*   **Fallback**: The system automatically switches to **`iptables`** based isolation. This ensures that even without native kernel VRFs, VPC boundaries are enforced within the simulator environment.

### Container Dependency
While the Control Plane logic and reconciliation can be tested in isolation, the **FRR containers are required** for full overlay behavior. They handle the BGP EVPN control plane (Type-2 and Type-5 route exchange) that enables cross-leaf communication. Note: While commercial distributions like SONiC often use FRR as their internal control plane, this simulator uses standalone FRR containers for simplicity. No SONiC-specific features or ConfigDB integrations are currently active.

### Codebase Structure

The control plane logic is organized to separate scenario definition from core reconciliation logic.

*   **`control-plane/scripts/create_demo_scenarios.py`**: The main entry point for generating the simulator. It orchestrates the setup and teardown of resources.
*   **`control-plane/scripts/demo_scenarios/`**: A package containing modularized scenario definitions.
    *   `basic.py`: Fundamental scenarios (1-10) like Single VPC, Multi-tier, etc.
    *   `intermediate.py`: More complex setups (11-20) including Hub-and-Spoke and Peering.
    *   `advanced.py`: Enterprise-grade scenarios (21-35) covering Global Transit, Shared VPCs, and Legacy integrations.
*   **`control-plane/api/rest_api_server.py`**: The API Server (`/vpc`) and SQLite Intent Store definitions.
*   **`control-plane/reconciler/reconciler.py`**: Contains the core `ReconciliationEngine` that enforces the desired state on the fabric.

## CI/CD Pipeline Flow

The CI/CD flow ensures that configuration changes are validated before being rolled out to the entire Fabric.

```text
User          Canary Script        Leaf-1 (Canary)      Leaf-2/3 (Prod)
                                                           
  make canary                                          
                   1. Validate                      
                                                           
                   2. Push Config                      
                                                           
                   3. Health Chk                      
                    (sleep 60s...)                         
                                                           
           [Success?]             
                                                          
                   4. Push Config  (Rollout)
                                                           
            [Failure?]             
                                                           
                   5. Rollback                      
                                                           
  (Exit Code)                                          
```

### Canary Verification Methods
The `canary.sh` script employs several verification techniques to ensure stability:
*   **Configuration Hash**: Compares the intended configuration state against a hash of the current active configuration on the leaf switch.
*   **Connectivity Probes**: Executes `ping` and `curl` commands from within VPC server namespaces to verify end-to-end reachability.
*   **BGP Session Status**: Queries the FRR API to ensure BGP EVPN peering is "Established" and routes are being exchanged.

## Logging, Telemetry &amp; Observation

As a simulator, observability is crucial for understanding the "closed-loop" behavior.

*   **Metrics**: The Control Plane exposes a Prometheus metric endpoint (`/metrics`). Key signals include `reconciliation_duration_ms`, `active_vpcs_count`, and `drift_detected_total`.
*   **Logging**: All containers output logs to `stdout/stderr`, which are aggregated by Docker. The reconciler provides detailed trace-level logging of every "Discover" and "Action" step.
*   **State Inspection**: The SQLite `Intent Store` can be queried directly to see the "Source of Truth" at any time.

## VPC View

The simulator includes a dedicated visual **VPC View** accessible via `make vpc` or `http://localhost:8000/vpc`.

### Design Philosophy:
The visual **VPC View** ignores the Docker host environment and renders only the resources defined in the Control Plane database (VPCs, Subnets, Gateways, Leaves).

### Persona: The Cloud Networking Architect
The VPC View is designed specifically for the **Cloud Networking Architect** persona. Since the physical infrastructure (Leaves) is static, the Architect needs to see the **Dynamics of Logical Intent**:
*   **VPC Lifecycle**: Visualizing 0, 1, or *N* VPCs as they are created and destroyed.
*   **Logical Mapping**: Real-time visualization of how these logical boundaries map onto the underlying Fabric.
*   **Resource Membership**: Seeing the relationship between Subnets and Gateways within the scope of their parent VPC boundary.

### Resource Model: Logical Boundaries
Aligned with the "VPC as an Isolated Network" principle, the UI uses a **Logical Boundary Model**:
*   **VPC Boundaries**: Rendered as transparent, dashed-border zones. These represent logical network isolation, not "Docker Containers" or physical hardware boxes. 
*   **Membership**: Resources like Subnets, NAT Gateways, and Internet Gateways are visually grouped within these boundaries to show logical ownership.
*   **EVPN Placement**: Blue dashed lines represent the EVPN "placement"showing which physical Leaf switches are currently hosting the VPC's control plane.

### Source of Truth vs. Configuration
To avoid confusion between static definitions and live state, the simulator distinguishes between three layers:

1.  **Static Blueprint (`configs/topology.json`)**: This is a design-time template. It is used by CI/CD scripts to validate schemas and defines the "golden state" of the underlay and initial VPC requirements.
2.  **Live State API (`/vpc`)**: This is the machine-readable "Source of Truth" from the running Control Plane. It queries the SQLite database in real-time to show what has actually been provisioned.
3.  **VPC View (`/vpc` - HTML)**: The human-readable view that consumes the Live State API. Accessible via `make vpc`.

### Data Flow
1.  **Backend**: The Control Plane exposes a `/vpc` endpoint that exports a curated JSON map of simulator nodes and edges when the `Accept` header is not `text/html`.
2.  **Frontend**: The Dashboard (`/vpc` HTML view) polls this endpoint every 15 seconds.
3.  **Rendering**: Renders a map of the intended and actual network state.

## Performance Caveats

This simulator is designed for functional validation and educational purposes, not for stress-testing or production traffic modeling.
*   **Docker Latency**: Packet traversal through multiple Docker bridges and the userspace-heavy VXLAN implementation will show significantly higher latency than ASIC-based hardware.
*   **Kernel Limitations**: As noted, the lack of `vrf` modules in Docker Desktop on MacOS using Apple Silicon hosts requires fallback to `iptables`, which has different scaling characteristics than native VRFs.
*   **Resource Contention**: Running multiple FRR instances and a Python-based reconciler on a single host may lead to CPU contention during heavy reconciliation cycles. Memory usage scales linearly with the number of VPCs and virtual switches.
*   **MTU Mismatches**: Docker network MTU mismatches (standard 1500 vs. VXLAN overhead) may affect packet fragmentation and throughput if not manually tuned.
*   **Simulated NAT**: NAT/SNAT logic is not hardware-accelerated and runs via Linux kernel `netns` transitions, further limiting throughput.
</div>
<div id="rendered-content-ARCHITECTURE-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for ARCHITECTURE.md
                const markdownContentARCHITECTURE-md = document.getElementById('markdown-content-ARCHITECTURE-md').textContent;
                const renderedContentARCHITECTURE-md = marked.parse(markdownContentARCHITECTURE-md);
                document.getElementById('rendered-content-ARCHITECTURE-md').innerHTML = renderedContentARCHITECTURE-md;
            </script>
</div>
<!-- VPC Details Tab -->
<div id="content-vpc-details" style="display: none;">
<h3> VPC Architecture &amp; Visualization</h3>
<p>The VPC visualization provides a real-time logical map of your cloud network with 33 demo scenarios.</p>
<h4>Connection Types</h4>
<table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
<tr style="background: #f5f5f5;">
<th style="border: 1px solid #ddd; padding: 8px;">Type</th>
<th style="border: 1px solid #ddd; padding: 8px;">Visual Style</th>
<th style="border: 1px solid #ddd; padding: 8px;">Use Case</th>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Peering</td>
<td style="border: 1px solid #ddd; padding: 8px;">Purple Solid</td>
<td style="border: 1px solid #ddd; padding: 8px;">VPC-to-VPC connection</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">VPN Gateway</td>
<td style="border: 1px solid #ddd; padding: 8px;">Orange Dashed</td>
<td style="border: 1px solid #ddd; padding: 8px;">Encrypted tunnels</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Mesh VPN</td>
<td style="border: 1px solid #ddd; padding: 8px;">Green Dotted</td>
<td style="border: 1px solid #ddd; padding: 8px;">Zero-trust mesh</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Routing Hub</td>
<td style="border: 1px solid #ddd; padding: 8px;">Blue Solid</td>
<td style="border: 1px solid #ddd; padding: 8px;">Hub-and-spoke routing</td>
</tr>
</table>
<h4>Key Scenarios</h4>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
<strong>1. Single VPC</strong><br/>
                        Simplest cloud network with public subnet
                    </div>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
<strong>2. Multi-tier VPC</strong><br/>
                        Public/private segmentation
                    </div>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
<strong>3. Secure Database Tier</strong><br/>
                        Isolated data between web and DB
                    </div>
<div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
<strong>12. Kubernetes Hybrid</strong><br/>
                        Cloud routing hubs with NAT flows
                    </div>
</div>
<div style="margin-top: 20px; padding: 15px; background: #f0f4c3; border-radius: 4px;">
<h4> Related Documentation</h4>
<ul style="margin: 0; padding-left: 20px;">
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/VPC.md" target="_blank"> Complete VPC Documentation</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/API_EXAMPLES.md" target="_blank"> VPC API Examples</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/ARCHITECTURE.md" target="_blank"> System Architecture</a></li>
</ul>
</div>

<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<!-- Divider between original content and VPC.md -->
<div style="margin: 30px 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px; border-left: 4px solid #2196f3;">
<h3 style="margin: 0 0 10px 0; color: #1976d2;"> VPC Implementation Details</h3>
<p style="margin: 0; color: #555;">Detailed VPC implementation and scenarios from docs/VPC.md</p>
</div>
<div class="markdown-content">
<div id="markdown-content-VPC-md" style="display: none;"># VPC Architecture &amp; Visualization

This document details VPC implementation, visualization features, and available demo scenarios based on the current static data in index.html.

## Visualization Features

The VPC visualization (`/vpc`) provides a real-time logical map of your cloud network.

### Visualization Details

The visualization provides a comprehensive view of your architecture, including:

* **Route Tables**: Per-VPC routing rules.
* **Kubernetes Node Groups**: Visual blocks for simulated container nodes (via `secondary_cidrs`).
* **Cloud Routing Hub**: Centralized hub connections.
* **Standalone Data Centers**: On-premises network integration.
* **VPN Gateways**: Secure tunnel connections.
* **WireGuard Gateways**: Modern VPN connectivity.
* **Headscale Nodes**: Mesh networking capabilities.

### Connection Types

| Type            | Visual Style       | Use Case                                                              |
| :-------------- | :----------------- | :-------------------------------------------------------------------- |
| **Peering**     | Purple Solid Line  | Simple VPC-to-VPC connection in same region.                      |
| **VPN Gateway** | Orange Dashed Line | Managed encrypted tunnels (e.g., On-Prem to Cloud).                   |
| **Mesh VPN**    | Green Dotted Line  | Zero-trust mesh overlays for secure service-to-service communication. |
| **Routing Hub** | Blue Solid Line    | Centralized routing via Cloud Routing Hub.                            |

## Demo Scenarios

The simulator includes 36 key scenarios, ordered from basic connectivity to complex enterprise architectures. All scenarios use generic, non-proprietary terminology.

### 1. Single VPC

* **Goal**: Simplest cloud network with one public subnet.
* **Architecture**: One VPC containing a single Cloud Data Center (CDC) and a Public Subnet with Internet Gateway access.

### 2. Multi-tier VPC

* **Goal**: Professional VPC with public/private segmentation.
* **Architecture**: A Production VPC with a Public Subnet (internet-accessible) and a Private Subnet for internal application tiers.

### 3. Secure Database Tier

* **Goal**: Isolation of sensitive data between web DMZ and secure backend.
* **Architecture**: A Production Environment VPC with a Web DMZ subnet and a separate Secure DB Tier for database isolation.

### 4. Public Load Balancer &amp; Private Backend

* **Goal**: Ingress traffic management with a public listener and private workers.
* **Architecture**: An Application Service VPC with a Frontend Entry subnet containing a Load Balancer and a Backend Pool with application servers.

### 5. NAT Router for Private Subnets

* **Goal**: Controlled internet access for isolated instances.
* **Architecture**: Private subnets route outbound traffic through a centralized NAT Router, preventing direct inbound internet exposure.

### 6. Secure Microservices Mesh

* **Goal**: Secure service-to-service communication.
* **Architecture**: A microservices-oriented network with dedicated subnets for individual services and mesh-based routing.

### 7. Managed VPN

* **Goal**: Secure cloud-to-on-prem or region-to-region connectivity.
* **Architecture**: Encrypted tunnels between distinct environments using generic VPN gateways.

### 8. Private Mesh Overlay

* **Goal**: Zero-trust mesh overlay networking.
* **Architecture**: A coordination server facilitates flat, encrypted mesh connectivity between nodes across arbitrary network boundaries.

### 9. VPC Peering

* **Goal**: Simple VPC-to-VPC connectivity within same region.
* **Architecture**: Two VPCs (Frontend and Backend) connected via bidirectional peering routes, enabling direct communication between resources in different VPCs.

### 10. Private Service Connectivity

* **Goal**: Private service connectivity without full network peering.
* **Architecture**: A "Consumer VPC" connects to a specific "Provider VPC" service via a logical private service endpoint link, maintaining isolation for all other traffic.

### 11. Collaborative Shared Network

* **Goal**: Centralized network management with departmental isolation.
* **Architecture**: A single "Shared Network VPC" divided into isolated subnets for HR, Finance, and IT groups.

### 12. Kubernetes Hybrid Network

* **Goal**: Cloud Routing Hub and spoke design with secondary addressing.
* **Architecture**: Complex enterprise connectivity with Kubernetes clusters, secondary CIDR blocks, and centralized routing through Cloud Routing Hubs.

### 13. Secure Application Service Mesh

* **Goal**: Advanced service mesh with secure communication patterns.
* **Architecture**: Multi-tier service architecture with mesh ingress, service tiers, and storage layers.

### 14. Network Lifecycle: Automated vs Manual

* **Goal**: Demonstrate automated vs manual network management.
* **Architecture**: Comparison between automated subnet provisioning across regions and manual subnet configuration.

### 15. Policy Enforcement

* **Goal**: Network policy compliance and enforcement.
* **Architecture**: Policy-driven network with compliant subnets and security controls.

### 16. Hybrid Connectivity: Dedicated &amp; Redundant VPN

* **Goal**: High-availability hybrid connectivity.
* **Architecture**: Redundant VPN connections between cloud and on-premises environments.

### 17. Enterprise Hub-and-Spoke

* **Goal**: Centralized enterprise network management.
* **Architecture**: Central hub connecting multiple spoke networks (Dev, Billing, Employee Portal, Security Scanner).

### 18. Virtual Appliance Routing

* **Goal**: Integration with virtual network appliances.
* **Architecture**: Network traffic routing through virtual appliances like firewalls.

### 19. Hub Gateway Transit

* **Goal**: Centralized traffic routing through hub gateways.
* **Architecture**: Hub-based transit architecture for traffic management.

### 20. Data-Scale Network: Secondary CIDR Expansion &amp; Pre-initialized Instances

* **Goal**: Large-scale network with expanded addressing.
* **Architecture**: Enterprise-scale network with secondary CIDR blocks and pre-configured instances.

### 21. Subnet-Level Peering

* **Goal**: Granular network connectivity at subnet level.
* **Architecture**: Direct peering between specific subnets across VPCs.

### 22. Shared Cluster Infrastructure

* **Goal**: Multi-tenant cluster sharing.
* **Architecture**: Shared infrastructure with isolated pools for different teams.

### 23. Cloud-Native Service Hub

* **Goal**: Centralized service management hub.
* **Architecture**: Service-oriented architecture with checkout, inventory, and web client components.

### 24. Hybrid Appliance Bridge

* **Goal**: Bridge between cloud and on-prem appliances.
* **Architecture**: Hybrid connectivity with software gateway integration.

### 25. AI Infrastructure: Accelerated RDMA Network

* **Goal**: High-performance AI workloads.
* **Architecture**: GPU cluster with RDMA networking for AI/ML workloads.

### 26. Global Transit: Multi-Region Hubs with GRE Support

* **Goal**: Global multi-region connectivity.
* **Architecture**: Multi-region hub architecture with GRE tunnel support.

### 27. Dual-Stack Infrastructure: IPv4 &amp; IPv6 Coexistence

* **Goal**: IPv4/IPv6 dual-stack networking.
* **Architecture**: Dual-stack network supporting both IPv4 and IPv6 addressing.

### 28. Cloud Native NAT Router

* **Goal**: Software-based NAT routing.
* **Architecture**: Host-based NAT routing with multiple services.

### 29. Heterogeneous Load Balancing

* **Goal**: Multi-platform load balancing.
* **Architecture**: Load balancer supporting heterogeneous server environments.

### 30. Standard IPsec VPN (Site-to-Site)

* **Goal**: Traditional IPsec VPN connectivity.
* **Architecture**: Standard site-to-site IPsec VPN tunnel.

### 31. Remote Access VPN

* **Goal**: Remote user access to private networks.
* **Architecture**: VPN endpoints for remote user connectivity.

### 32. Private DNS Discovery

* **Goal**: Internal DNS resolution and service discovery.
* **Architecture**: Private DNS server with internal service resolution.

### 33. Legacy Windows Integration

* **Goal**: Integration with Windows-based infrastructure.
* **Architecture**: Windows AD and SQL server integration with proper subnet isolation.

### 34. Brownfield Endpoint Adoption

* **Goal**: Integration with existing network infrastructure.
* **Architecture**: Adoption of existing subnets into cloud network management.

### 35. Partial Brownfield Adoption

* **Goal**: Gradual migration of existing networks.
* **Architecture**: Selective adoption of existing network components.

### 36. Brownfield Adoption Under Churn

* **Goal**: Network management during dynamic changes.
* **Architecture**: Handling network topology changes during ongoing operations.

## Scenario Selection

The visualization interface allows you to:
1. **Browse scenarios** using the dropdown menu
2. **Load specific scenarios** to see their network topology
3. **Examine connections** between different network components
4. **Understand relationships** between VPCs, hubs, and standalone data centers

Each scenario demonstrates specific networking concepts and can be used as a reference for designing similar architectures in real cloud environments.

## API Usage

### Create a Kubernetes VPC

```json
POST /vpcs
{
  "name": "k8s-prod",
  "cidr": "10.0.0.0/16",
  "secondary_cidrs": ["100.64.0.0/16"]
}
```

### Create a VPN Gateway

```json
POST /vpn-gateways
{
  "vpc_id": "vpc-xxx",
  "endpoint": "1.2.3.4:51820",
  "public_key": "abc...",
  "allowed_ips": ["10.0.0.0/16"]
}
```
</div>
<div id="rendered-content-VPC-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for VPC.md
                const markdownContentVPC-md = document.getElementById('markdown-content-VPC-md').textContent;
                const renderedContentVPC-md = marked.parse(markdownContentVPC-md);
                document.getElementById('rendered-content-VPC-md').innerHTML = renderedContentVPC-md;
            </script>
</div>
<!-- Examples Tab -->
<div id="content-examples" style="display: none;">
<h3> API Examples &amp; Use Cases</h3>
<p>Comprehensive examples for managing VPC resources using the REST API.</p>
<h4>VPC Management Examples</h4>
<div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Create Basic VPC:</strong><br/>
<code style="display: block; background: #fff; padding: 10px; border-radius: 4px; margin: 5px 0;">curl -X POST "/vpcs" \<br/>
  -H "Content-Type: application/json" \<br/>
  -d '{"name": "Production VPC", "cidr": "10.0.0.0/16", "region": "us-east-1"}'</code>
</div>
<div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Create VPC with Secondary CIDRs:</strong><br/>
<code style="display: block; background: #fff; padding: 10px; border-radius: 4px; margin: 5px 0;">curl -X POST "/vpcs" \<br/>
  -H "Content-Type: application/json" \<br/>
  -d '{"name": "Kubernetes VPC", "cidr": "10.1.0.0/16", "secondary_cidrs": ["100.64.0.0/16"]}'</code>
</div>
<div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Create Security Group:</strong><br/>
<code style="display: block; background: #fff; padding: 10px; border-radius: 4px; margin: 5px 0;">curl -X POST "/security-groups" \<br/>
  -H "Content-Type: application/json" \<br/>
  -d '{"name": "web-tier", "rules": [{"direction": "ingress", "protocol": "tcp", "port_from": 80, "port_to": 80, "cidr": "0.0.0.0/0"}]}'</code>
</div>
<h4>Future Extension Ideas</h4>
<div style="background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Potential Enhancements:</strong><br/>
                     Distributed Link Agent (Go-based host-level agent)<br/>
                     Unified gRPC Service Interface<br/>
                     IPv6-Based Fabric Underlay<br/>
                     Advanced Telemetry &amp; Observability
                </div>
<div style="margin-top: 20px; padding: 15px; background: #f0f4c3; border-radius: 4px;">
<h4> Related Documentation</h4>
<ul style="margin: 0; padding-left: 20px;">
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/API_EXAMPLES.md" target="_blank"> Complete API Examples</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/IDEAS.md" target="_blank"> Extension Ideas</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/API.md" target="_blank"> API Reference</a></li>
</ul>
</div>
</div>
<!-- Testing Tab -->
<div id="content-testing" style="display: none;">
<h3> Testing &amp; Performance</h3>
<p>Multi-layered testing approach ensuring control plane correctness and reliability.</p>
<h4>Test Suite Overview</h4>
<table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
<tr style="background: #f5f5f5;">
<th style="border: 1px solid #ddd; padding: 8px;">Layer</th>
<th style="border: 1px solid #ddd; padding: 8px;">Tool</th>
<th style="border: 1px solid #ddd; padding: 8px;">Purpose</th>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Unit Tests</td>
<td style="border: 1px solid #ddd; padding: 8px;">pytest</td>
<td style="border: 1px solid #ddd; padding: 8px;">Individual functions &amp; API endpoints</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Integration</td>
<td style="border: 1px solid #ddd; padding: 8px;">pytest + TestClient</td>
<td style="border: 1px solid #ddd; padding: 8px;">RESTgRPC interoperability</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Static Analysis</td>
<td style="border: 1px solid #ddd; padding: 8px;">mypy, flake8</td>
<td style="border: 1px solid #ddd; padding: 8px;">Type checking &amp; code quality</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">Security</td>
<td style="border: 1px solid #ddd; padding: 8px;">bandit</td>
<td style="border: 1px solid #ddd; padding: 8px;">Vulnerability detection</td>
</tr>
</table>
<h4>Running Tests</h4>
<div style="background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0;">
<code style="display: block; background: #fff; padding: 10px; border-radius: 4px; margin: 5px 0;"># Run all tests with coverage<br/>make test-cov<br/><br/># Run specific tests<br/>cd control-plane &amp;&amp; python -m pytest tests/test_rest_api.py -v<br/><br/># Run linting<br/>make lint-extreme<br/><br/># Security scan<br/>make security-scan</code>
</div>
<h4>Test Coverage</h4>
<div style="background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 10px 0;">
<strong>Current Coverage:</strong><br/>
                     models.py: 100%<br/>
                     shared_api_logic.py: 100%<br/>
                     rest_api_server.py: 96%<br/>
                     grpc_api_server.py: 94%<br/><br/>
<em>Uncovered: Database initialization and entry points</em>
</div>
<div style="margin-top: 20px; padding: 15px; background: #f0f4c3; border-radius: 4px;">
<h4> Related Documentation</h4>
<ul style="margin: 0; padding-left: 20px;">
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/docs/TESTING.md" target="_blank"> Complete Testing Guide</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/README.md" target="_blank"> Quick Start Guide</a></li>
<li><a href="https://github.com/lloydchang/cloud-networking-control-plane-simulator/blob/main/LICENSE" target="_blank"> License Information</a></li>
</ul>
</div>

<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<!-- Divider between original content and TESTING.md -->
<div style="margin: 30px 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 8px; border-left: 4px solid #2196f3;">
<h3 style="margin: 0 0 10px 0; color: #1976d2;"> Comprehensive Testing Guide</h3>
<p style="margin: 0; color: #555;">Complete testing documentation and coverage from docs/TESTING.md</p>
</div>
<div class="markdown-content">
<div id="markdown-content-TESTING-md" style="display: none;"># Testing &amp; Performance Guide

This document covers the testing infrastructure, coverage achievements, and performance considerations for the Cloud Networking Control Plane Simulator.

## Test Suite Overview

The project uses a multi-layered testing approach:

| Layer | Tool | Purpose |
|-------|------|---------|
| Unit Tests | pytest | Test individual functions and API endpoints |
| Integration Tests | pytest + TestClient | Verify RESTgRPC interoperability |
| Static Analysis | mypy, flake8 | Type checking and code quality |
| Security Scanning | bandit | Vulnerability detection |
| Load Testing | httpx + asyncio | Performance verification |

## Running Tests

```bash
# Run all tests with coverage
make test-cov

# Run specific test files
cd control-plane &amp;&amp; python -m pytest tests/test_rest_api.py -v

# Run linting and formatting
make lint-extreme

# Run security scan
make security-scan
```

## Test Coverage

Current coverage by component (as of latest commit 3c0c98f):

| Component | Coverage | Status |
|-----------|----------|--------|
| `models.py` | 100% |  All SQLAlchemy models |
| `grpc_api_server.py` | 77% |  gRPC API implementation (improved from 28%) |
| `rest_api_server.py` | 71% |  REST API endpoints (improved from 57%) |
| `shared_api_logic.py` | 45% |  Core business logic (improved from 12%) |
| `diagnostic_logger.py` | 25% |  Diagnostic logging (improved from 6%) |
| **Overall** | **56%** |  **Improved from 35%** |

**Recent Improvements** (Commit 596365e):
-  Fixed test environment issues (filesystem permissions)
-  Added missing API functions in shared_api_logic.py
-  Created diagnostic logger tests (25% coverage)
-  Added startup event handler tests
-  Fixed import and environment variable handling

**Uncovered areas**:
- Database initialization and entry points (startup code)
- Some gRPC service methods
- Diagnostic logging methods (partially covered)
- Main.py entry point functions

**Test Files Added**:
```
control-plane/tests/
 conftest.py                    # Updated with proper test isolation
 test_diagnostic_logger.py       # NEW: Diagnostic logging tests
 test_startup.py                # NEW: Startup event handler tests
 test_shared_api_logic.py       # Core business logic tests
 test_rest_api.py               # REST API endpoint tests
 test_grpc_api.py               # gRPC API tests
 test_integration_polyglot.py   # RESTgRPC interoperability tests
```

## Performance Findings

### Async/Sync SQLAlchemy Issue

&gt; [!IMPORTANT]
&gt; When using FastAPI with synchronous SQLAlchemy, endpoint functions should use `def`, not `async def`.

**Problem Identified**: During load testing (500 concurrent VPC creations), event loop starvation occurred.

**Root Cause**: 
- FastAPI runs `async def` functions directly on the event loop
- Synchronous SQLAlchemy operations block the event loop
- All other requests are blocked until the DB operation completes

**Solution Applied**:
```python
#  WRONG - Blocks event loop
@app.post("/vpcs")
async def create_vpc(db: Session = Depends(get_db)):
    return db.query(VPCModel).all()  # Blocking call!

#  CORRECT - Runs in threadpool
@app.post("/vpcs")
def create_vpc(db: Session = Depends(get_db)):
    return db.query(VPCModel).all()  # FastAPI runs this in a thread
```

**Result**: The control plane now handles 500+ concurrent requests without blocking.

### Database Concurrency Considerations

For production workloads with high write concurrency, consider:

1. **Async Database Drivers**: Use `databases` or `sqlalchemy[asyncio]` with async drivers
2. **Connection Pooling**: Configure appropriate pool sizes for SQLAlchemy
3. **NoSQL Alternatives**: For very high write throughput, consider:
   - Apache Cassandra
   - ScyllaDB

### Load Testing

The `scripts/load_simulation.py` script provides configurable load testing:

```bash
# Default: 500 VPCs, 50 concurrent
python control-plane/scripts/load_simulation.py

# Custom configuration
NUM_VPCS=1000 CONCURRENCY=100 python control-plane/scripts/load_simulation.py
```

## Writing New Tests

### REST API Tests

```python
from fastapi.testclient import TestClient
from api.rest_api_server import app

client = TestClient(app)

def test_create_vpc():
    response = client.post("/vpcs", json={"name": "test", "cidr": "10.0.0.0/16"})
    assert response.status_code == 201
```

### gRPC Tests

```python
import grpc
from api.grpc_api_server import NetworkService
from api import cloud_networking_control_plane_simulator_pb2

def test_list_vpcs(grpc_stub):
    request = cloud_networking_control_plane_simulator_pb2.ListVPCsRequest(limit=10)
    response = grpc_stub.ListVPCs(request)
    assert response.total &gt;= 0
```

### Integration Tests

Integration tests verify that resources created via one API are visible via the other:

```python
def test_polyglot_flow(grpc_service):
    # Create via REST
    resp = client.post("/vpcs", json={"name": "test", "cidr": "10.0.0.0/16"})
    vpc_id = resp.json()["id"]
    
    # Verify via gRPC
    list_resp = grpc_service.ListVPCs(request, context)
    assert any(v.id == vpc_id for v in list_resp.vpcs)
```

## CI/CD Integration

The Makefile provides targets for CI/CD pipelines:

```makefile
# Full validation pipeline
make all        # lint + test + validate

# Individual steps
make lint       # Basic Python syntax check
make lint-extreme  # mypy + flake8 + black
make test       # Run pytest
make test-cov   # Run pytest with coverage
make security-scan  # Run bandit
```

## Troubleshooting

### "Database is locked" errors

SQLite has limited concurrency. For tests, ensure:
- Each test uses isolated database sessions
- Tests don't run in parallel against the same DB file

### Import errors in tests

Ensure `sys.path` includes the necessary directories:
```python
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'api'))
```

### gRPC stub import issues

The gRPC generated files need the `api/` directory in path:
```python
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'api'))
from api import cloud_networking_control_plane_simulator_pb2
```
</div>
<div id="rendered-content-TESTING-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for TESTING.md
                const markdownContentTESTING-md = document.getElementById('markdown-content-TESTING-md').textContent;
                const renderedContentTESTING-md = marked.parse(markdownContentTESTING-md);
                document.getElementById('rendered-content-TESTING-md').innerHTML = renderedContentTESTING-md;
            </script>
</div><div id="content-api-examples" style="display: none;">
<h3> API Usage Examples</h3>
<p>Comprehensive API examples and use cases from docs/API_EXAMPLES.md</p>
<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<div class="markdown-content">
<div id="markdown-content-API_EXAMPLES-md" style="display: none;"># VPC API Examples

This document provides comprehensive API examples for managing VPC resources using the Cloud Networking Control Plane Simulator REST API. These examples use `curl` and mirror the scenarios created in the demo script.

## Base URL

```bash
API_URL="http://localhost:8000"
```

## VPC Management

### Create a VPC

Create a basic VPC with a single CIDR block:

```bash
curl -X POST "${API_URL}/vpcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Production VPC",
    "cidr": "10.0.0.0/16",
    "region": "us-east-1"
  }'
```

Create a VPC with secondary CIDR blocks:

```bash
curl -X POST "${API_URL}/vpcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Kubernetes Cluster VPC",
    "cidr": "10.1.0.0/16",
    "region": "us-east-1",
    "secondary_cidrs": ["100.64.0.0/16"]
  }'
```

### List All VPCs

```bash
curl -X GET "${API_URL}/vpcs"
```

### Get VPC Details

```bash
VPC_ID="vpc-abc123"
curl -X GET "${API_URL}/vpcs/${VPC_ID}"
```

### Delete a VPC

```bash
VPC_ID="vpc-abc123"
curl -X DELETE "${API_URL}/vpcs/${VPC_ID}"
```

## Subnet Management

### Create a Subnet

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Public Subnet",
    "cidr": "10.0.1.0/24",
    "data_center": "CDC-1"
  }'
```

### List Subnets in a VPC

```bash
VPC_ID="vpc-abc123"
curl -X GET "${API_URL}/vpcs/${VPC_ID}/subnets"
```

## Route Management

### Create an Internet Gateway Route

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "0.0.0.0/0",
    "next_hop": "igw-auto",
    "next_hop_type": "internet_gateway"
  }'
```

### Create a VPN Gateway Route

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "192.168.0.0/16",
    "next_hop": "dc-onprem-001",
    "next_hop_type": "vpn_gateway"
  }'
```

### Create a Cloud Routing Hub Route

```bash
VPC_ID="vpc-abc123"
HUB_ID="hub-xyz789"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "10.0.0.0/8",
    "next_hop": "'${HUB_ID}'",
    "next_hop_type": "cloud_routing_hub"
  }'
```

### Create an Instance Route (NAT)

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "0.0.0.0/0",
    "next_hop": "10.49.96.3",
    "next_hop_type": "instance"
  }'
```

## Internet Gateway

### Attach Internet Gateway to VPC

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/vpcs/${VPC_ID}/internet-gateways"
```

## Cloud Routing Hub Management

### Create a Cloud Routing Hub

```bash
curl -X POST "${API_URL}/hubs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Global Transit Hub",
    "region": "global"
  }'
```

### Add Routes to a Hub

```bash
HUB_ID="hub-xyz789"
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/hubs/${HUB_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "10.1.0.0/16",
    "next_hop": "'${VPC_ID}'",
    "next_hop_type": "cloud_routing_hub"
  }'
```

### Delete a Hub

```bash
HUB_ID="hub-xyz789"
curl -X DELETE "${API_URL}/hubs/${HUB_ID}"
```

## Standalone Data Center Management

### Create a Standalone Data Center

```bash
curl -X POST "${API_URL}/standalone-dcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "On-Premise Data Center",
    "cidr": "192.168.0.0/16",
    "region": "on-prem"
  }'
```

### Create a Subnet in a Standalone DC

```bash
DC_ID="dc-onprem-001"
curl -X POST "${API_URL}/standalone-dcs/${DC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Corporate Network",
    "cidr": "192.168.1.0/24",
    "data_center": "ODC-1"
  }'
```

### Add Routes to a Standalone DC

```bash
DC_ID="dc-onprem-001"
HUB_ID="hub-xyz789"
curl -X POST "${API_URL}/standalone-dcs/${DC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "10.0.0.0/8",
    "next_hop": "'${HUB_ID}'",
    "next_hop_type": "vpn_gateway"
  }'
```

## WireGuard Gateway Management

### Create a WireGuard Gateway

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/wireguard-gateways" \
  -H "Content-Type: application/json" \
  -d '{
    "vpc_id": "'${VPC_ID}'",
    "endpoint": "192.0.2.1:51820",
    "public_key": "US_WEST_PUB_KEY",
    "allowed_ips": "10.10.0.1/32"
  }'
```

## Headscale Node Management

### Create a Headscale Node

```bash
VPC_ID="vpc-abc123"
curl -X POST "${API_URL}/headscale-nodes" \
  -H "Content-Type: application/json" \
  -d '{
    "vpc_id": "'${VPC_ID}'",
    "node_key": "mkey:west-node-01",
    "tailnet": "demo-mesh"
  }'
```

## Scenario Management

### Create a Scenario

```bash
curl -X POST "${API_URL}/scenarios" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Multi-tier Web Application",
    "description": "A three-tier architecture with web, app, and database layers",
    "resource_order": [
      {"type": "vpc", "label": "Production VPC"}
    ]
  }'
```

### List All Scenarios

```bash
curl -X GET "${API_URL}/scenarios"
```

## Complete Example: NAT Router Setup

This example creates a complete NAT router scenario similar to Scenario 28:

```bash
# 1. Create the VPC
VPC_RESPONSE=$(curl -s -X POST "${API_URL}/vpcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "NAT Router VPC",
    "cidr": "10.49.96.0/20",
    "region": "us-east-1",
    "scenario": "NAT Router Demo"
  }')

VPC_ID=$(echo $VPC_RESPONSE | jq -r '.id')

# 2. Create subnets for each host
curl -X POST "${API_URL}/vpcs/${VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Host 1 (NAT Router/DNS)",
    "cidr": "10.49.96.3/32",
    "data_center": "CDC-1"
  }'

curl -X POST "${API_URL}/vpcs/${VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Host 2 (FTP Server)",
    "cidr": "10.49.96.4/32",
    "data_center": "CDC-1"
  }'

curl -X POST "${API_URL}/vpcs/${VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Host 3 (Web Server)",
    "cidr": "10.49.96.5/32",
    "data_center": "CDC-1"
  }'

curl -X POST "${API_URL}/vpcs/${VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Host 4 (Windows Server)",
    "cidr": "10.49.96.6/32",
    "data_center": "CDC-1"
  }'

# 3. Configure NAT routing
curl -X POST "${API_URL}/vpcs/${VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "0.0.0.0/0",
    "next_hop": "10.49.96.3",
    "next_hop_type": "instance"
  }'

echo "NAT Router VPC created with ID: ${VPC_ID}"
```

## Complete Example: Managed IPsec VPN

This example creates a managed IPsec VPN scenario similar to Scenario 30:

```bash
# 1. Create the Cloud VPC
CLOUD_VPC=$(curl -s -X POST "${API_URL}/vpcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Cloud VPC",
    "cidr": "203.0.113.0/24",
    "region": "us-east-1",
    "scenario": "Managed IPsec"
  }')

CLOUD_VPC_ID=$(echo $CLOUD_VPC | jq -r '.id')

# 2. Create the On-Premises DC
ONPREM_DC=$(curl -s -X POST "${API_URL}/standalone-dcs" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "On-Premises Network",
    "cidr": "192.168.1.0/24",
    "region": "on-prem",
    "scenario": "Managed IPsec"
  }')

ONPREM_DC_ID=$(echo $ONPREM_DC | jq -r '.id')

# 3. Create Cloud VPC subnets
curl -X POST "${API_URL}/vpcs/${CLOUD_VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "VPC VPN Gateway",
    "cidr": "203.0.113.2/32",
    "data_center": "CDC-1"
  }'

curl -X POST "${API_URL}/vpcs/${CLOUD_VPC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "App Server (Debian)",
    "cidr": "203.0.113.3/32",
    "data_center": "CDC-1"
  }'

# 4. Create On-Prem DC subnets
curl -X POST "${API_URL}/standalone-dcs/${ONPREM_DC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "On-Prem VPN Gateway",
    "cidr": "192.168.1.1/32",
    "data_center": "ODC-1"
  }'

curl -X POST "${API_URL}/standalone-dcs/${ONPREM_DC_ID}/subnets" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Windows Client",
    "cidr": "192.168.1.2/32",
    "data_center": "ODC-1"
  }'

# 5. Configure IPsec tunnel routes
curl -X POST "${API_URL}/vpcs/${CLOUD_VPC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "192.168.1.0/24",
    "next_hop": "'${ONPREM_DC_ID}'",
    "next_hop_type": "vpn_gateway"
  }'

curl -X POST "${API_URL}/standalone-dcs/${ONPREM_DC_ID}/routes" \
  -H "Content-Type: application/json" \
  -d '{
    "destination": "203.0.113.0/24",
    "next_hop": "'${CLOUD_VPC_ID}'",
    "next_hop_type": "vpn_gateway"
  }'

echo "Managed IPsec VPN created"
echo "Cloud VPC ID: ${CLOUD_VPC_ID}"
echo "On-Prem DC ID: ${ONPREM_DC_ID}"
```

## Viewing the Network Topology

### Get Complete Network View

```bash
curl -X GET "${API_URL}/vpc"
```

This returns a comprehensive view including all nodes (VPCs, hubs, standalone DCs) and edges (routes, peerings, VPN connections).

## Notes

- All IDs returned by the API should be used in subsequent requests
- The API supports idempotent operations where applicable
- Use `jq` for JSON parsing in shell scripts (as shown in examples)
- Replace placeholder values like `vpc-abc123` with actual IDs from your API responses
</div>
<div id="rendered-content-API_EXAMPLES-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for API_EXAMPLES.md
                const markdownContentAPI_EXAMPLES-md = document.getElementById('markdown-content-API_EXAMPLES-md').textContent;
                const renderedContentAPI_EXAMPLES-md = marked.parse(markdownContentAPI_EXAMPLES-md);
                document.getElementById('rendered-content-API_EXAMPLES-md').innerHTML = renderedContentAPI_EXAMPLES-md;
            </script>
</div><div id="content-ideas" style="display: none;">
<h3> Project Ideas and Future Development</h3>
<p>Ideas for future features and improvements from docs/IDEAS.md</p>
<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<div class="markdown-content">
<div id="markdown-content-IDEAS-md" style="display: none;"># IDEAS.md

# Cloud Networking Control Plane Simulator Ideas

This document outlines potential extension areas for the Cloud Networking Control Plane Simulator. The focus is on Control Plane correctness, clear system boundaries, and integration with external orchestration systems. All components are simulations or reference implementations, not production infrastructure.

## Current State

The system provides a functional baseline for intent-driven networking.

Implemented capabilities include:

* Python-based intent controller
* EVPN-VXLAN fabric using BGP Control Plane signaling
* Persistent source of truth backed by SQLite
* Host-level security groups enforced via nftables
* Basic observability and state inspection

The priority is correctness, transparency, and debuggability rather than performance.

## Control Plane Scaling and Integration

### Distributed Link Agent

A lightweight host-level agent may be implemented in Go to collect link state and apply intent locally. This shifts responsibility away from a centralized controller and helps limit the impact of host or process faults.

The focus is on failure isolation and clear ownership, not performance. The agent targets simulator-scale environments and emphasizes predictable behavior.

References:

* [Linux netlink and rtnetlink overview](https://www.kernel.org/doc/html/latest/userspace-api/netlink/intro.html)
* [pyroute2 Docs](https://docs.pyroute2.org/)

### Unified Service Interface

Internal services may converge on a gRPC interface defined by a single network.proto contract. The goal is strong schema enforcement, explicit contracts, and streaming semantics for state updates.

This does not imply automatic latency improvements over REST. Serialization overhead, flow control, and backpressure still apply.

References:

* [gRPC core concepts and tradeoffs](https://grpc.io/docs/what-is-grpc/core-concepts/)

### IPv6-Based Fabric Underlay

The simulated fabric underlay may use IPv6 link-local addressing with BGP unnumbered sessions. This mirrors common data center patterns and simplifies address management.

The simulator models Control Plane adjacency and route distribution only. Hardware forwarding, MTU edge cases, or NIC-specific optimizations are not included.

References:

* [RFC 5549, IPv6 support for IPv4 routing](https://datatracker.ietf.org/doc/html/rfc5549)
* [RFC 4271, Border Gateway Protocol version 4](https://datatracker.ietf.org/doc/html/rfc4271)
* [RFC 7432, BGP MPLS-Based Ethernet VPN](https://datatracker.ietf.org/doc/html/rfc7432)
* [FRR Documentation](https://docs.frrouting.org/)
* [FRR EVPN Docs](https://docs.frrouting.org/en/latest/bgp.html#evpn)

### Northbound Consumption

The system exposes a stable API boundary for external consumption. Reference clients may demonstrate integration patterns.

Broad language support is treated as a documentation concern rather than a networking feature. The emphasis is on contract clarity.

References:

* [OpenAPI Specification](https://spec.openapis.org/)
* [FastAPI Docs](https://fastapi.tiangolo.com/)

## Dataplane and Orchestration Extensions

### Kernel-Level Packet Handling

Selective packet handling may be simulated using eBPF or XDP programs to show how intent maps to kernel hooks. These are educational and illustrative.

Line-rate forwarding, NIC offload, or production-grade packet processing are not included.

References:

* [XDP architecture and constraints](https://www.kernel.org/doc/html/latest/networking/xdp.html)
* [AF_XDP zero-copy limitations](https://www.kernel.org/doc/html/latest/networking/af_xdp.html)

### Kubernetes Integration

A reference Kubernetes CNI and controller may demonstrate how cluster lifecycle events drive network intent. Focus is on reconciliation, state propagation, and failure handling.

Feature parity with existing CNIs or cloud controllers is not the goal.

References:

* [CNI specification](https://github.com/containernetworking/cni)
* [Kubernetes controller patterns](https://kubernetes.io/docs/concepts/architecture/controller/)

### Inter-VPC Connectivity

Transit and peering may be simulated to demonstrate route distribution and policy enforcement between isolated networks, including selective route leaking and shared services.

All behavior is Control Plane level; security guarantees and performance are out of scope.

### Specialized Networking

The Control Plane may include placeholders for topology awareness and specialized links, limited to metadata and scheduling hints.

Lossless Ethernet, RDMA congestion control, and NIC-specific tuning are not modeled.

References:

* [IEEE 802.1Q and RoCEv2 background](https://standards.ieee.org/ieee/802.1Q/7024/)

## Testing and Scale Exploration

Larger topologies may be simulated using container-based network emulation to observe convergence and failure scenarios. Experiments are qualitative, intended for learning and validating Control Plane logic.

Results are not suitable for capacity planning or performance benchmarking.

References:

* [containerlab documentation](https://containerlab.dev/)

## Summary

This document captures constrained extension ideas for the Cloud Networking Control Plane Simulator. The emphasis is on correctness, clear system boundaries, and realistic Control Plane behavior. Advanced features are framed as simulations or reference implementations, not production claims. The goal is learning and experimentation rather than deployment.
</div>
<div id="rendered-content-IDEAS-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for IDEAS.md
                const markdownContentIDEAS-md = document.getElementById('markdown-content-IDEAS-md').textContent;
                const renderedContentIDEAS-md = marked.parse(markdownContentIDEAS-md);
                document.getElementById('rendered-content-IDEAS-md').innerHTML = renderedContentIDEAS-md;
            </script>
</div><div id="content-implementation" style="display: none;">
<h3> Networking Implementation Details</h3>
<p>Deep dive into networking implementation from docs/NETWORKING_IMPLEMENTATION.md</p>
<style>
            .markdown-content {
                font-family: 'Segoe UI', Arial, sans-serif;
                line-height: 1.6;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4 {
                color: #232f3e;
                margin: 20px 0 10px 0;
            }
            .markdown-content pre {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content code {
                background: #f8f9fa;
                padding: 2px 4px;
                border-radius: 3px;
                font-size: 0.9em;
            }
            .markdown-content pre code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content .codehilite {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 16px;
                overflow-x: auto;
                margin: 15px 0;
            }
            .markdown-content .codehilite pre {
                background: transparent;
                border: none;
                padding: 0;
                margin: 0;
            }
            .markdown-content .codehilite code {
                background: transparent;
                padding: 0;
                font-family: 'Courier New', Consolas, monospace;
                font-size: 0.85em;
                line-height: 1.4;
            }
            .markdown-content blockquote {
                border-left: 4px solid #00897b;
                padding-left: 16px;
                margin: 15px 0;
                color: #666;
            }
            .markdown-content table {
                border-collapse: collapse;
                width: 100%;
                margin: 15px 0;
            }
            .markdown-content th, .markdown-content td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            .markdown-content th {
                background: #f5f5f5;
                font-weight: bold;
            }
            </style>
<div class="markdown-content">
<div id="markdown-content-NETWORKING_IMPLEMENTATION-md" style="display: none;"># Networking Implementation Details

This document clarifies the implementation status of core networking features within the simulator, distinguishing between protocol-level implementation and logical simulator.

## Overview

The Cloud Networking Control Plane Simulator focuses on **Control Plane correctness** and **Intent reconciliation**. To maintain a lightweight and educational environment, certain data plane features are logically modeled when native kernel support is absent, while others are fully implemented in the Linux kernel on-the-fly.

## Implementation Status

| Feature | Control Plane Status | Data Plane / Enforcement |
| :--- | :--- | :--- |
| **EVPN-VXLAN** | **Implemented (FRR)** | **Implemented (Linux Kernel)** |
| **VRFs** | **Simulated** | **Enforced via `iptables` (Logical Fallback)** |
| **VTEPs** | **Implemented (FRR)** | **VXLAN interfaces bound to loopback** |

---

### EVPN-VXLAN &amp; VTEPs

*   **Implementation**: Leaf and spine switches run **FRRouting (FRR)** for control plane signaling. The **Reconciliation Engine** performs actual kernel-level configuration using `ip link` to create and manage VXLAN interfaces (e.g., `vxlan1000`).
*   **VTEP Configuration**: Leaf switches act as VTEPs. The reconciler ensures the loopback and VXLAN interfaces are correctly configured and peered via BGP EVPN, with VXLAN ID (VNI) mapping explicitly controlled by the reconciler logic.
*   **Persistence**: The reconciler uses detailed link discovery (`ip -d link`) to verify VNI and device status. All reconciliation operations are idempotent, ensuring stable and predictable state maintenance.

### VPC Isolation (VRFs)

*   **Implementation**: The reconciler attempts to create native Linux VRF devices. However, some environments (like Docker Desktop on macOS using Apple Silicon, such as M-series) lacks the `vrf` kernel module.
*   **Enforcement Fallback**: The simulator automatically falls back to **`iptables`** isolation on the leaf switches when native VRFs are not supported. This provides the required logical VPC isolation (preventing cross-VPC traffic) while maintaining stable control plane behavior.
*   **Unified Discovery**: The reconciler handles "Unified Discovery" by treating both native VRF devices and `iptables` rules equally during state reconciliation to determine if a VPC's isolation is active ("available").

#### Technical Rationale for Fallback
Native VRF support in Linux requires a kernel compiled with `CONFIG_NET_VRF=y`. In this simulator environment:
1.  **Elevated Permissions**: Although the switch containers run in `privileged: true` mode with `NET_ADMIN` capabilities, these only grant permission to *use* existing kernel features; they cannot provide features the kernel doesn't have.
2.  **Host Kernel Constraints**: Containers share the host kernel. On macOS (Docker Desktop on macOS using Apple Silicon, such as M-series), this is a lightweight Linux utility VM.
3.  **Apple Silicon Constraints**: The ARM64 Linux VM used by Docker Desktop on macOS using Apple Silicon, such as M-series on Apple Silicon has a distinct feature set compared to Intel-based environments. Native VRF support remains restricted or uncompiled in the standard Docker utility VM kernel.
4.  **Specific Error**: The error `RTNETLINK answers: Not supported` explicitly confirms that the `vrf` device type is unregistered in the running kernel's driver table.
5.  **Automatic Recovery**: The Reconciliation Engine detects this "Not supported" response and automatically switches to **Logical Isolation** using `iptables`. This ensures VPC boundaries are still enforced despite architecture-specific network limitations.

### Intent-Driven Orchestration

The Reconciliation Engine implements a periodic, "Closed Loop" orchestration cycle triggered by both timers and event changes:
1. **Fetch**: Queries the SQLite database for desired network intent.
2. **Discover**: Inspects leaf switches using `ip link` and `iptables-save` to determine actual state.
3. **Diff**: Computes the difference between intended and actual resource states.
4. **Action**: Executes system commands (`ip link add`, `iptables -A`, etc.) to converge the state.

## Further Reading

*   [Architecture Overview](ARCHITECTURE.md)
*   [Control Plane Design](IDEAS.md)
*   [FRRouting Documentation](https://docs.frrouting.org/)
</div>
<div id="rendered-content-NETWORKING_IMPLEMENTATION-md"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
<script>
                // Client-side markdown rendering for NETWORKING_IMPLEMENTATION.md
                const markdownContentNETWORKING_IMPLEMENTATION-md = document.getElementById('markdown-content-NETWORKING_IMPLEMENTATION-md').textContent;
                const renderedContentNETWORKING_IMPLEMENTATION-md = marked.parse(markdownContentNETWORKING_IMPLEMENTATION-md);
                document.getElementById('rendered-content-NETWORKING_IMPLEMENTATION-md').innerHTML = renderedContentNETWORKING_IMPLEMENTATION-md;
            </script>
</div>
</div>
</div>
</body>
</html>